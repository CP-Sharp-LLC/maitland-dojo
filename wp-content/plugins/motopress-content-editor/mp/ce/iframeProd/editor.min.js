parent.MP.Editor.oneIfr("ParentEditorReady",function(){try{(function(c){MP.BootstrapSelect=can.Construct({setSelected:function(a){a.prop("selected",!0);a.closest("select").next(".bootstrap-select").find(".filter-option").text(a.text())},setDisabled:function(a,b){"undefined"==typeof b&&(b=!0);var d=a.closest("select"),c=a.prop("index"),d=d.next(".bootstrap-select").find('ul[data-select-id="'+d.prop("id")+'"] > li[rel="'+c+'"] > a');b?d.attr("data-disabled",""):d.removeAttr("data-disabled")},appendOption:function(a,
b){var d=c("<li />",{rel:b.prop("index")}),e=c("<a />",{tabindex:"-1",href:"#",text:b.text()});"undefined"!=typeof b.attr("data-disabled")&&e.attr("data-disabled","");e.appendTo(d);a.next(".bootstrap-select").find('ul[data-select-id="'+a.prop("id")+'"]').append(d)},removeOption:function(a){var b=a.closest("select");if(1<b.find("option").length){var d=a.prop("index"),d=b.next(".bootstrap-select").find('ul[data-select-id="'+b.prop("id")+'"] > li[rel="'+d+'"]');d.nextAll("li").each(function(){c(this).attr("rel",
parseInt(c(this).attr("rel"))-1)});d.remove();a.parent().is("optgroup")&&!a.siblings("option").length?(a.parent("optgroup").remove(),1==b.children("optgroup").length&&(a=b.find("optgroup:first option:last").prop("index"),b.next(".bootstrap-select").find('ul[data-select-id="'+b.prop("id")+'"] > li[rel="'+a+'"]').removeClass("optgroup-div"))):a.remove();setSelected(b.find("option:first"))}},updateOptionText:function(a,b){var d=a.closest("select"),c=a.prop("index"),d=d.next(".bootstrap-select").find('ul[data-select-id="'+
d.prop("id")+'"] > li[rel="'+c+'"] > a');a.text(b);d.text(b)}},{})})(jQuery),function(c){CE.Utils=can.Construct({body:c("body"),addSceneAction:function(a){this.body.addClass("motopress-"+a+"-action")},isSceneAction:function(a){return this.body.hasClass("motopress-"+a+"-action")},removeSceneAction:function(a){this.body.removeClass("motopress-"+a+"-action")},triggerWindowEvent:function(a){c(window).trigger(a);CE.Utils.fixFlexslider()},fixFlexslider:function(){c(".motopress-flexslider").each(function(){c(this).data("flexslider")&&
c(this).data("flexslider").resize()})},addSceneState:function(a){this.body.addClass("motopress-"+a+"-state")},removeSceneState:function(a){this.body.removeClass("motopress-"+a+"-state")},isSceneState:function(a){return this.body.hasClass("motopress-"+a+"-state")}},{})}(jQuery),function(c){CE.WPMore=can.Construct({_instance:null,getInstance:function(){null===this._instance&&(this._instance=new CE.WPMore);return this._instance}},{$body:c("body"),$contentWrapper:parent.CE.Iframe.myThis.sceneContent,
contentSectionExists:parent.CE.Iframe.myThis.contentSectionExists,$moreTag:c('<section class="mpce-wp-more-tag" />'),$style:c(),pointClass:".mpce-wp-more-point",pointClassName:"mpce-wp-more-point",tagClass:".mpce-wp-more-tag",tagClassName:"mpce-wp-more-tag",pointPosClassNamePrefix:"mpce-wp-more-point-",pointPosClassPrefix:".mpce-wp-more-point-",selectedState:"wp-more-selected",init:function(){this.$contentWrapper=parent.CE.Iframe.myThis.sceneContent;this.contentSectionExists=parent.CE.Iframe.myThis.contentSectionExists;
this.initState();this.initStyle();this.initEvents()},initState:function(){this.contentSectionExists&&this.$contentWrapper.find(this.tagClass).length&&(this.$moreTag=this.$contentWrapper.find(this.tagClass),CE.Utils.addSceneState(this.selectedState),this.fixTagDOMPosition());this.$moreTag.attr("title",localStorage.getItem("CEMoreHandlerTitle"))},initEvents:function(){this.$contentWrapper.on("click",">"+this.pointClass+", >.motopress-handle-middle-in>"+this.pointClass+"",this.proxy("onPointClick")).on("click",
">"+this.tagClass,this.proxy("onTagClick"));parent.MP.Editor.oneIfr("EditorLoad",this.proxy("updateStyle"));parent.MP.Editor.onIfr("LeftBarShow LeftBarHide",this.proxy("updateStyle"));parent.MP.Editor.onIfr("Resize",this.proxy("updateStyle"))},initStyle:function(){this.$style=c('<style type="text/css" id="mpce-wp-more-style" />');this.$body.append(this.$style)},updateStyle:function(){var a="";if(CE.LeftBar.myThis.isVisible()&&this.contentSectionExists){var b=this.$contentWrapper.offset().left-CE.LeftBar.myThis.getSpace();
0>b&&(b=Math.abs(b),a='.motopress-edit-more-action [class^="mpce-wp-more"]{left:'+b+"px !important;}")}this.$style.text(a)},onPointClick:function(a,b){b=c(a.target);switch(this.getPositionType(b)){case "first":this.$moreTag.prependTo(this.$contentWrapper);break;case "last":this.$contentWrapper.find(">.motopress-row:last").after(this.$moreTag);break;default:b.parent().before(this.$moreTag)}CE.Utils.addSceneState(this.selectedState)},onTagClick:function(){CE.Utils.removeSceneState(this.selectedState);
this.$moreTag.detach()},fixTagDOMPosition:function(){var a=this.$moreTag.closest(".motopress-content-wrapper>.motopress-row");a.length&&a.after(this.$moreTag)},getPointTemplate:function(a){return c("<div />",{"class":this.pointClassName+" "+this.getPointClassByType(a),title:localStorage.getItem("CEWPMorePointTitle")})},pointAppendTo:function(a,b){a.length&&!this.isPointExists(b)&&a.append(this.getPointTemplate(b))},pointPrependTo:function(a,b){a.length&&!this.isPointExists(b)&&a.prepend(this.getPointTemplate(b))},
isPointExists:function(a){return!!("undefined"!==typeof a&&a&&this.contentSectionExists&&this.$contentWrapper.find(this.pointPosClassPrefix+a).length)},getPointClassByType:function(a){return"undefined"!==typeof a&&a?this.pointPosClassNamePrefix+a:""},getPositionType:function(a){return a.hasClass(this.getPointClassByType("first"))?"first":a.hasClass(this.getPointClassByType("last"))?"last":"middle"}})}(jQuery),function(c){CE.Grid=can.Control.extend({myThis:null},{columnWidthPiece:null,columnMarginPiece:null,
splitterWidthPiece:null,splitterMarginPiece:null,column:null,padding:null,columnCount:parent.CE.Iframe.myThis.gridObj.row.col,columnWidthStatus:null,colWidthByNumber:[],rowEl:c("<div />",{"class":parent.CE.Iframe.myThis.gridObj.row["class"]}),columnEl:c("<div />",{}),setup:function(a){var b=null;a.append(this.rowEl);for(a=1;a<=this.columnCount;a++)b=this.columnEl.clone().addClass(parent.CE.Iframe.myThis.gridObj.span["class"]+a).appendTo(this.rowEl),this.colWidthByNumber[a]=parseFloat(b.width());this.columnEl.clone().addClass(parent.CE.Iframe.myThis.gridObj.span["class"]+
1).appendTo(this.rowEl)},init:function(a){CE.Grid.myThis=this;this.column=a.find("."+parent.CE.Iframe.myThis.gridObj.span.minclass+":last");this.setSize();parent.MP.Editor.onIfr("Resize",this.proxy("setSize"))},setSize:function(){var a=this.column.width();this.padding=parseFloat(this.column.css("padding-left"));this.columnWidthPiece=parseFloat(this.column.width());this.columnMarginPiece=parseFloat(this.column.css("margin-left"));this.splitterWidthPiece=this.columnMarginPiece/100*66.66666;this.splitterMarginPiece=
this.columnMarginPiece/100*83.33333;this.columnWidthStatus&&(CE.Resizer.myThis.updateSplittableOptions(null,null,null,"init"),CE.Resizer.myThis.updateSplitterHeight(null,"init"));this.columnWidthStatus=a}})}(jQuery),function(c){can.Construct("CE.LeftBar",{myThis:null},{width:56,leftBar:c("<div />",{"class":"motopress-default mpce-leftbar-hidden",id:"motopress-content-editor-leftbar",tabIndex:-1}),leftBarOverlap:c("<div />",{"class":"motopress-leftbar-overlap"}),widgetsWrapper:c('<div id="mpce-leftbar-widgets-wrapper" />'),
customWrapper:c('<div id="mpce-leftbar-custom-wrapper" />'),group:c("<div />",{"class":"motopress-leftbar-group motopress-default"}),groupInner:c("<div />",{"class":"motopress-leftbar-group-inner motopress-default"}),groupIcon:c("<div />",{"class":"motopress-leftbar-group-icon"}),groupActive:c("<div />",{"class":"motopress-leftbar-group-active motopress-default"}),object:c("<section />",{"class":"motopress-ce-object motopress-default-drag"}),objectInner:c("<div />",{"class":"motopress-ce-object-inner motopress-default"}),
objectDot:c("<div />",{"class":"motopress-ce-object-dot motopress-default"}),objectIcon:c("<div />",{"class":"motopress-ce-object-icon"}),objectName:c("<span />",{"class":"motopress-ce-object-name motopress-default motopress-no-color-text"}),library:null,visibility:!0,bodyEl:null,active:!1,setup:function(){this.groupIcon.append(this.groupActive).appendTo(this.groupInner);this.groupInner.append(this.groupPopover).appendTo(this.group);this.objectInner.append(this.objectDot,this.objectIcon,this.objectName).appendTo(this.object);
this.bodyEl=c("body");this.leftBar.append(this.widgetsWrapper,this.customWrapper);this.bodyEl.prepend(this.leftBar).append(this.leftBarOverlap)},init:function(){CE.LeftBar.myThis=this;this.leftBar.hasClass("mpce-leftbar-hidden")||(this.setActive(),this.setVisible(),parent.CE.Navbar.myThis.setWidgetBtnActive());this.initLibrary();this.initCustom();this.hoverActive();new CE.DragDrop;var a=c("#motopress-templates");a.length&&new CE.Template(a);this.addMetaInputs();parent.MP.Preloader.myThis.load(CE.LeftBar.shortName)},
initCustom:function(){var a=this,b,d,e={};b='<div class="mpce-leftbar-custom-group-1"><div class="motopress-leftbar-group motopress-default mpce-leftbar-more-btn" title="'+localStorage.getItem("CELeftBarWPMoreTitle")+'"><div class="motopress-leftbar-group-inner motopress-default"><div class="motopress-leftbar-group-icon mpce-leftbar-more-icon"><div class="motopress-leftbar-group-active motopress-default"></div></div></div></div>';parent.motopressCE.settings.wp.white_label_active||(b+='<div class="motopress-leftbar-group motopress-default mpce-leftbar-addons-btn" title="'+
localStorage.getItem("CELeftBarAddonsTitle")+'"><div class="motopress-leftbar-group-inner motopress-default"><div class="motopress-leftbar-group-icon mpce-leftbar-addons-icon"><a href="'+parent.motopressCE.settings.wp.home_addons_url+'" target="_blank" class="motopress-leftbar-group-active motopress-default"></a></div></div></div>');d=c(b+"</div>");c.each(["more","addons"],function(a,b){e[b]=d.find(".mpce-leftbar-"+b+"-btn")});d.find(".motopress-leftbar-group").on("mouseover",function(b){a.customGrpOnMouseover(b,
this)}).on("mouseout",function(b){a.customGrpOnMouseout(b,this)});e.more.find(".motopress-leftbar-group-active").on("mousedown",function(b){a.customActiveGrpOnMousedown(b,this)});d.appendTo(this.customWrapper)},addMetaInputs:function(){c("form#post #motopress-ce-edited-post",parent.document).length||c("form#post",parent.document).prepend(c("<input>",{type:"hidden",id:"motopress-ce-edited-post",name:"motopress-ce-edited-post",value:parent.motopressCE.postID}))},initLibrary:function(){var a=parent.motopressCE.settings.library;
CE.LeftBar.myThis.library=c.extend(!0,{},a.groups);this.initLibraryStyles();c.isPlainObject(a.globalPredefinedClasses)&&!c.isEmptyObject(a.globalPredefinedClasses)&&(CE.Style.globalPredefinedClasses=a.globalPredefinedClasses);c.isArray(a.tinyMCEStyleFormats)&&!c.isEmptyObject(a.tinyMCEStyleFormats)&&(CE.InlineEditor.styleFormats=a.tinyMCEStyleFormats);c.isPlainObject(a.templates)&&!c.isEmptyObject(a.templates)&&(CE.Template.templates=a.templates);CE.LeftBar.myThis.createGroup()},initLibraryStyles:function(){var a;
c.each(parent.motopressCE.settings.library.groups,function(b,d){d.hasOwnProperty("objects")&&c.each(d.objects,function(d,f){CE.LeftBar.myThis.library[b].objects[d].styles=c.extend(!0,{},CE.Style.props,CE.LeftBar.myThis.library[b].objects[d].styles);CE.Shortcode.isGrid(b)?(CE.LeftBar.myThis.library[b].objects[d].styles.margin.sides.splice(2),CE.LeftBar.myThis.library[b].objects[d].styles.margin["default"].splice(2)):CE.LeftBar.myThis.library[b].objects[d].styles.margin.regExp=new RegExp("^"+CE.LeftBar.myThis.library[b].objects[d].styles.margin.classPrefix+
"(?:|("+CE.LeftBar.myThis.library[b].objects[d].styles.margin.sides.join("|")+")-)("+CE.LeftBar.myThis.library[b].objects[d].styles.margin.values.slice(1).join("|")+")$","i");f.styles.hasOwnProperty("mp_custom_style")&&f.styles.mp_custom_style.hasOwnProperty("limitation")&&(a=f.styles.mp_custom_style.limitation,c.each(a,function(a,c){CE.LeftBar.myThis.library[b].objects[d].styles.mp_custom_style.parameters.hasOwnProperty(c)&&delete CE.LeftBar.myThis.library[b].objects[d].styles.mp_custom_style.parameters[c]}))})})},
createGroup:function(){if(null!==this.library&&!c.isEmptyObject(this.library)){var a=this,b,d,e;for(e in this.library)this.library[e].show&&(b=this.group.clone(),d=b.find(".motopress-leftbar-group-icon"),d.css("background-image","url("+this.library[e].icon+")"),b.clickover({html:!0,animation:!1,width:this.getPopupWidth(this.library[e]),title:localStorage.getItem("addBlockTip"),content:this.createObject(this.library[e].id,this.library[e].objects),onShown:function(){a.popoverOnShown(this)},onHidden:function(){a.popoverOnHidden(this)}}),
b.find(".motopress-leftbar-group-active").on("mousedown",this.proxy("activeGrpOnMousedown")),b.appendTo(this.widgetsWrapper))}},popoverOnShown:function(a){a.$tip.find(".arrow").removeClass("arrow").addClass("motopress-ce-arrow");var b=a.$element.is(":first-child")?5:0,b=parseInt(a.$tip.css("top"))+parseInt(a.$tip.css("height"))/2-23+b;a.$tip.css("top",b);a=a.$tip.find(".popover-title");a.addClass("motopress-default motopress-default-text");a.next(".popover-content").length&&(b=a.next(),a.insertAfter(b),
b.addClass("motopress-ce-object-container"));CE.DragDrop.myThis.makeDraggableNewBlock()},popoverOnHidden:function(a){a.$element.find(".motopress-leftbar-group-active").removeClass("active")},activeGrpOnMousedown:function(a){a.preventDefault();a.stopPropagation()},activeGrpOnMouseover:function(){c(this).addClass("active")},customGrpOnMouseover:function(a,b){this.hideActiveWidgetsGroup()},customGrpOnMouseout:function(a,b){c(b).find(".motopress-leftbar-group-active").removeClass("active")},customActiveGrpOnMousedown:function(a,
b){c(b).hasClass("selected")?(c(b).removeClass("selected"),CE.Utils.removeSceneAction("edit-more")):(c(b).addClass("selected"),CE.Utils.addSceneAction("edit-more"))},getPopupWidth:function(a){return 6>Object.keys(a.objects).length?"205px":"620px"},createObject:function(a,b){if(!c.isEmptyObject(b)){var d=c("<div />"),e,f,g;for(g in b)b[g].show&&(e=this.object.clone(),this.setAttrs(e,a,b[g]),f=e.find(".motopress-ce-object-icon"),f.css("background-image","url("+b[g].icon+")"),f=e.find(".motopress-ce-object-name"),
f.text(b[g].name),d.append(e));return d}},setAttrs:function(a,b,d){a.attr({"data-motopress-close-type":d.closeType,"data-motopress-shortcode":d.id,"data-motopress-group":b,"data-motopress-resize":d.resize});var e=d.parameters,f;c.isEmptyObject(e)||(f={},c.each(e,function(a){f[a]={}}),a.attr("data-motopress-parameters",JSON.stringify(f)));b=this.getStyleAttrs(b,d.id);c.extend(!0,b,d.styles,b);if(!c.isEmptyObject(b)){var g={};c.each(b,function(a){g[a]={}});a.attr("data-motopress-styles",JSON.stringify(g))}},
hoverActive:function(){c(".motopress-leftbar-group .motopress-leftbar-group-active").mouseover(this.activeGrpOnMouseover)},disable:function(){this.leftBarOverlap.show()},enable:function(){this.leftBarOverlap.hide()},setActive:function(){this.active=!0},setInactive:function(){this.active=!1},isActive:function(){return this.active},setVisible:function(){this.visibility=!0},setInvisible:function(){this.visibility=!1},isVisible:function(){return this.visibility},hide:function(a){if(("undefined"===typeof a?
0:a)||this.isActive())this.setInvisible(),this.hideActiveWidgetsGroup(),this.leftBar.addClass("mpce-leftbar-hidden"),parent.MP.Editor.triggerIfr("LeftBarHide")},show:function(a){if(("undefined"===typeof a?0:a)||this.isActive())this.setVisible(),this.leftBar.removeClass("mpce-leftbar-hidden"),parent.MP.Editor.triggerIfr("LeftBarShow")},hideActiveWidgetsGroup:function(){this.leftBar.find('.motopress-leftbar-group[data-clickover-open="1"]').trigger("mousedown")},getSpace:function(){return this.isVisible()?
this.width:0},getWidth:function(){return this.width},getStyleAttrs:function(a,b){return c.extend(!0,{},this.library[a].objects[b].styles)},getPrivateStyleAttrs:function(a,b){return this.getStyleAttrs(a,b).mp_custom_style.parameters},getParametersAttrs:function(a,b){return c.extend(!0,{},this.library[a].objects[b].parameters)},getShortcodeLabel:function(a,b){return this.library[a].objects[b].name}})}(jQuery),function(c){CE.ShortcodeStyle=can.Construct({generateStateCSS:function(a){var b=[];c.each(a,
function(a,c){if(""!==c)switch(a){case "padding-top":case "padding-bottom":case "padding-left":case "padding-right":case "margin-top":case "margin-bottom":case "margin-left":case "margin-right":case "border-top-width":case "border-bottom-width":case "border-left-width":case "border-right-width":case "border-top-left-radius":case "border-top-right-radius":case "border-bottom-left-radius":case "border-bottom-right-radius":isNaN(c)||b.push(CE.ShortcodeStyle.generateStyleRule(a,c+"px !important;"));break;
case "background-position-x":case "background-position-y":isNaN(c)||b.push(CE.ShortcodeStyle.generateStyleRule(a,c+"% !important;"));break;case "background-gradient":if(""!==c){var f=CE.CtrlGradient.parseGradientStr(c);!f||""===f["initial-color"]&&""===f["final-color"]||(c=f.angle+"deg,"+(""!==f["initial-color"]?f["initial-color"]:"transparent")+","+(""!==f["final-color"]?f["final-color"]:"transparent"),f=[],f.push("-moz-linear-gradient("+c+") !important;"),f.push("-webkit-linear-gradient("+c+") !important;"),
f.push("linear-gradient("+c+") !important;"),b.push(CE.ShortcodeStyle.generateStyleRule("background-image",f)))}break;case "background-image-type":"none"===c&&b.push(CE.ShortcodeStyle.generateStyleRule("background-image","none !important;"));break;case "background-image":b.push(CE.ShortcodeStyle.generateStyleRule(a,"url("+c+") !important;"));break;case "background-color":case "border-color":case "color":b.push(CE.ShortcodeStyle.generateStyleRule(a,c+" !important;"));break;case "background-position":"custom"!==
c&&b.push(CE.ShortcodeStyle.generateStyleRule(a,c+" !important;"));break;case "border-radius":b.push(CE.ShortcodeStyle.generateStyleRule("-webkit-"+a,c+" !important;"));b.push(CE.ShortcodeStyle.generateStyleRule("-moz-"+a,c+" !important;"));b.push(CE.ShortcodeStyle.generateStyleRule(a,c+" !important;"));break;default:b.push(CE.ShortcodeStyle.generateStyleRule(a,c+" !important;"))}});return b},generateCSS:function(a,b,d){void 0===typeof d&&(d=!1);null===a&&(a="%className%");var e="";b.hasOwnProperty("up")&&
c.each(CE.ShortcodeStyle.generateStateCSS(b.up),function(b,c){e+="."+a+c;d&&(e+="."+a+"."+CE.ShortcodeStyle.previewStateClassPrefix+"up"+c)});b.hasOwnProperty("hover")&&c.each(CE.ShortcodeStyle.generateStateCSS(b.hover),function(b,c){e=d?e+("."+a+"."+CE.ShortcodeStyle.previewStateClassPrefix+"hover"+c):e+("."+a+":hover"+c)});b.hasOwnProperty("tablet")&&c.each(CE.ShortcodeStyle.generateStateCSS(b.tablet),function(b,c){e=d?e+("."+a+"."+CE.ShortcodeStyle.previewStateClassPrefix+"tablet"+c):e+("@media (max-width: 768px) { ."+
a+c+"}")});b.hasOwnProperty("mobile")&&c.each(CE.ShortcodeStyle.generateStateCSS(b.mobile),function(b,c){e=d?e+("."+a+"."+CE.ShortcodeStyle.previewStateClassPrefix+"mobile"+c):e+("@media (max-width: 320px) { ."+a+c+"}")});return e},generateStyleRule:function(a,b){var d=":not(."+parent.motopressCE.styleEditor["const"].prefixRuleDisable+a+"){";c.isArray(b)||(b=[b]);c.each(b,function(){d+=a+":"+this});return d+="}"},previewStateClassPrefix:"motopress-ce-preview-state-"},{settings:null,css:null,emulateCSS:null,
className:null,updateMetaField:function(){},init:function(a,b,d){this.className=a;this.settings="undefined"!==typeof b?b:{};"undefined"!==typeof d?(this.css=d,this.emulateCSS=CE.ShortcodeStyle.generateCSS(this.className,this.settings,!0)):this.regenerateCSS();this.detectStyleTag();this.updateStyleTag()},getClassName:function(){return this.className},getCSS:function(){return this.css},getEmulateCSS:function(){return this.emulateCSS},getSettings:function(){return c.extend({},this.settings)},getStateSettings:function(a){return this.settings.hasOwnProperty(a)?
c.extend({},this.settings[a]):{}},isEmpty:function(){var a=!0;c.each(this.settings,function(b,d){c.each(d,function(b,d){""!==d&&(a=!1)})});return a},regenerateCSS:function(){this.css=CE.ShortcodeStyle.generateCSS(this.className,this.settings,!1);this.emulateCSS=CE.ShortcodeStyle.generateCSS(this.className,this.settings,!0)},update:function(a){this.settings=a;this.regenerateCSS();this.updateStyleTag();this.updateMetaField()},updateState:function(a,b){this.settings[a]=b;this.regenerateCSS();this.updateStyleTag();
this.updateMetaField()},"delete":function(){this.styleTag.remove();this.updateMetaField()},updateStyleTag:function(){var a=CE.StyleEditor.myThis.isEmulateCSSMode()?this.getEmulateCSS():this.getCSS();this.styleTag.text(a)},detectStyleTag:function(){var a=this.stylesWrapper.children("#"+this.className);a.length||(a=this.generateStyleTag());this.styleTag=a},generateStyleTag:function(){var a=c("<style />",{id:this.getClassName(),text:this.getCSS()});this.stylesWrapper.append(a);return a}})}(jQuery),function(c){CE.ShortcodeStyle("CE.ShortcodePrivateStyle",
{stylesWrapper:c("#motopress-ce-private-styles-wrapper"),addRenderedStyleTags:function(a){a.filter(function(a,d){return 0===CE.ShortcodePrivateStyle.stylesWrapper.children("#"+c(d).attr("id")).length});CE.ShortcodePrivateStyle.stylesWrapper.append(a)}},{styleTag:null,stylesWrapper:null,init:function(a,b,d){this.stylesWrapper=CE.ShortcodePrivateStyle.stylesWrapper;this._super(a,b,d)},updateMetaField:function(){CE.StyleEditor.myThis.udpatePrivateStylesMeta()},clear:function(){this.update({});CE.StyleEditor.myThis.udpatePrivateStylesMeta()}})}(jQuery),
function(c){CE.ShortcodeStyle("CE.ShortcodePresetStyle",{stylesWrapper:c("#motopress-ce-preset-styles-wrapper")},{styleTag:null,label:"",stylesWrapper:null,init:function(a,b,d,c){this.stylesWrapper=CE.ShortcodePresetStyle.stylesWrapper;this._super(a,b,d);this.setLabel(c)},getLabel:function(){return this.label},setLabel:function(a){this.label=a},updateLabel:function(a){this.label=a;CE.StyleEditor.myThis.updatePresetStylesMeta()},updateMetaField:function(){CE.StyleEditor.myThis.updatePresetStylesMeta()}})}(jQuery),
function(c){CE.StyleEditor=can.Construct({myThis:null},{presets:{},presetsMetaField:null,presetsLastIdMetaField:null,privateStyles:{},presetStyles:{},presetsLastId:null,presetDefaultLabel:null,privateMetaField:null,prefixPresetClass:null,prefixPrivateClass:null,privateStylesWrapper:null,presetStylesWrapper:null,presetSaveModal:null,emulateCSSMode:!0,init:function(){CE.StyleEditor.myThis=this;this.presetSaveModal=parent.CE.PresetSaveModal.myThis;this.initPrivateStyles();this.initPresetStyles();this.initEvents()},
initPresetStyles:function(){var a=this;this.prefixPresetClass=parent.motopressCE.styleEditor["const"].prefixPresetClass;this.presetsLastIdMetaField=parent.CE.Navbar.myThis.presetsLastIdMetaField;this.presetsMetaField=parent.CE.Navbar.myThis.presetsMetaField;this.presetsLastId=parent.motopressCE.styleEditor.presets_last_id;this.presetDefaultLabel=parent.motopressCE.styleEditor["const"].presetDefaultLabel;c.each(parent.motopressCE.styleEditor.presets,function(b,d){a.presetStyles[b]=new CE.ShortcodePresetStyle(b,
d.settings,d.css,d.label)})},initEvents:function(){parent.MP.Editor.onIfr("AfterUpdate",this.proxy("clearPresetsField"))},getPresetsLastId:function(){return this.presetsLastId},incPresetsLastId:function(){this.presetsLastId++;return this.presetsLastId},initPrivateStyles:function(){var a=this;this.prefixPrivateClass=parent.motopressCE.styleEditor["const"].prefixPrivateClass;this.privateMetaField=parent.CE.Navbar.myThis.privatesMetaField;c.each(this.getPrivateStylesMeta(),function(b,d){a.privateStyles[b]=
new CE.ShortcodePrivateStyle(b,d.settings)})},udpatePrivateStylesMeta:function(){this.privateMetaField.val(this.getPrivateStylesString());parent.CE.Save.changeContent()},getPrivateStylesMeta:function(){return c.parseJSON(this.privateMetaField.val())},getPrivateStylesString:function(){var a={};c.each(this.privateStyles,function(b,d){d.isEmpty()||(a[b]={settings:d.getSettings(),css:d.getCSS()})});return JSON.stringify(a)},getPrivateStyleInstance:function(a){a=this.retrievePrivateClass(a);if(""!==a&&
this.privateStyles.hasOwnProperty(a))return this.privateStyles[a];a=this.generatePrivateClass();return this.createPrivateStyle(a)},getPresetStyleInstance:function(a){a=this.retrievePresetClass(a);return this.isExistsPreset(a)?this.presetStyles[a]:null},createPrivateStyle:function(a,b){this.privateStyles[a]=new CE.ShortcodePrivateStyle(a,b);return this.privateStyles[a]},retrievePrivateClass:function(a){a=(new RegExp("(?:^|\\s)+("+this.prefixPrivateClass+"[\\d]+-[\\S]+)(?:$|\\s)+")).exec(a);return null!==
a&&2===a.length?a[1]:""},generatePrivateClass:function(){var a=parent.MP.Utils.uniqid(this.prefixPrivateClass+parent.motopressCE.postID+"-");return this.privateStyles.hasOwnProperty(a)?this.generatePrivateClass():a},getPresetsString:function(){var a={};c.each(this.presetStyles,function(b,d){a[b]={settings:d.getSettings(),css:d.getCSS(),label:d.getLabel()}});return JSON.stringify(a)},getPresetsList:function(a){var b={};c.each(this.presetStyles,function(a,c){b[c.getClassName()]=c.getLabel()});a&&(b=
c.extend({"":localStorage.getItem("CENone")},b));return b},getPresetsListSelect2:function(){var a=[];c.each(this.presetStyles,function(b,d){a.push({id:d.getClassName(),text:d.getLabel()})});return a},generatePresetClassName:function(){return this.prefixPresetClass+this.incPresetsLastId()},createPreset:function(a,b){var d=this.generatePresetClassName();""===a&&(a=this.presetDefaultLabel+this.getPresetsLastId());this.presetStyles[d]=new CE.ShortcodePresetStyle(d,b,void 0,a);this.updatePresetStylesMeta();
return this.presetStyles[d]},deletePreset:function(a){this.isExistsPreset(a)&&(this.presetStyles[a]["delete"](),delete this.presetStyles[a],this.updatePresetStylesMeta());return!0},updatePresetStylesMeta:function(){parent.motopressCE.styleEditor.presets=this.presetStyles;this.presetsLastIdMetaField.val(this.getPresetsLastId());this.presetsMetaField.val(this.getPresetsString());parent.CE.Save.changeContent()},clearPresetsField:function(){this.presetsLastIdMetaField.val("");this.presetsMetaField.val("")},
isExistsPreset:function(a){return this.presetStyles.hasOwnProperty(a)},retrievePresetClass:function(a){a=(new RegExp("(?:^|\\s)+("+this.prefixPresetClass+"[\\d]+)(?:$|\\s)+")).exec(a);return null!==a&&2===a.length?a[1]:""},changePrivateClassToDuplicated:function(a){if(""!==a){var b=CE.StyleEditor.myThis.retrievePrivateClass(a);if(""!==b){var d=CE.StyleEditor.myThis.duplicatePrivateStyle(b);a=a.replace(b,d.getClassName())}}return a},duplicatePrivateStyle:function(a){var b=this.generatePrivateClass();
a=this.privateStyles.hasOwnProperty(a)?this.createPrivateStyle(b,this.privateStyles[a].getSettings()):this.createPrivateStyle(b);this.udpatePrivateStylesMeta();return a},setEmulateCSSMode:function(){this.emulateCSSMode=!0;c.each(this.presetStyles,function(){this.updateStyleTag()});c.each(this.privateStyles,function(){this.updateStyleTag()})},unsetEmulateCSSMode:function(){this.emulateCSSMode=!1;c.each(this.presetStyles,function(){this.updateStyleTag()});c.each(this.privateStyles,function(){this.updateStyleTag()})},
isEmulateCSSMode:function(){return this.emulateCSSMode}})}(jQuery),function(c){CE.ImageLibrary=can.Construct({myThis:null},{frame:null,propertyImage:null,init:function(){CE.ImageLibrary.myThis=this;this.frame=parent.wp.media({id:"motopress-image-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",router:"browse",menu:"default",searchable:!0,filterable:!1,sortable:!1,title:localStorage.getItem("CEImageLibraryText"),button:{text:localStorage.getItem("CEImageLibraryText")},
library:{type:"image"},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setImage"));this.frame.on("close",this.proxy("onClose"))},onOpen:function(){this.frame.reset();this.propertyImage=CE.Dialog.myThis.element.find('[data-motopress-open-img-lib="1"]');var a=this.propertyImage.control();null!==a.id&&(a=parent.wp.media.attachment(a.id),a.fetch(),this.frame.state().get("selection").add(a))},setImage:function(){var a=this.frame.state().get("selection").models[0].attributes,
b="full";a.sizes.hasOwnProperty("medium")?b="medium":a.sizes.hasOwnProperty("thumbnail")&&(b="thumbnail");var b=a.sizes[b].url,d=this.propertyImage.control();d.set({id:a.id,src:b,full:a.sizes.full.url});d.showTools();d.element.trigger("change");this.propertyImage.removeAttr("data-motopress-open-img-lib")},onClose:function(){c("."+CE.Dialog.myThis.dialogClass).focus();var a=c(parent.document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");
clearTimeout(b)},0)}})}(jQuery),function(c){CE.Link=can.Construct({myThis:null,wpLink:null,submitCallback:null,closeCallback:null,inputs:{}},{init:function(){CE.Link.myThis=this;CE.Link.wpLink=parent.wpLink;CE.Link.inputs.submit=c("#wp-link-submit",parent.document);CE.Link.inputs.cancel=c("#wp-link-cancel",parent.document);parent.MP.Utils.version_compare(parent.motopressCE.settings.wp.wordpress_version,"4.2",">=")?(CE.Link.inputs.url=c("#wp-link-url",parent.document),CE.Link.inputs.title=c("#wp-link-text",
parent.document),CE.Link.inputs.openInNewTab=c("#wp-link-target",parent.document)):(CE.Link.inputs.url=c("#url-field",parent.document),CE.Link.inputs.title=c("#link-title-field",parent.document),CE.Link.inputs.openInNewTab=c("#link-target-checkbox",parent.document))},open:function(a,b,d,e){var f={url:!0,title:!0,target:!0};"undefined"!==typeof b&&c.extend(f,b);if("undefined"!=typeof CE.Link.wpLink){CE.Link.submitCallback=d;CE.Link.inputs.submit.off("mousedown.motopress-wplink-submit").on("mousedown.motopress-wplink-submit",
this.wpSubmitButtonHandler);CE.Link.inputs.cancel.off("click.motopress-wplink-cancel").on("click.motopress-wplink-cancel",e);parent.wpActiveEditor=parent.tinyMCE.activeEditor.id;var g=null;CE.Link.wpLink.setDefaultValues=function(){var b=null,d=null;c.isPlainObject(a)?(g=a.href,b="_blank"===a.target?!0:!1,d=a.textarea):(g=a.val(),d=a);if(""===g||"#"===g)g="http://";CE.Link.inputs.url.val(g);CE.Link.inputs.openInNewTab.prop("checked",b);CE.Link.wpLink.textarea=d};CE.Link.wpLink.open();g||(g=c.isPlainObject(a)?
a.href:a.val(),CE.Link.inputs.url.val(g));"undefined"===typeof CE.Link.inputs.close&&(CE.Link.inputs.close=c(".ui-dialog-titlebar-close",parent.document));CE.Link.inputs.close.off("mousedown.motopress-wplink-close").on("mousedown.motopress-wplink-close",e);f.url||CE.Link.inputs.url.closest("div").hide();f.title||CE.Link.inputs.title.closest("div").hide();f.target||CE.Link.inputs.openInNewTab.closest("div").hide();parent.CE.Iframe.myThis.wpLinkCloseCallback(this.onDialogClose)}},wpCancelButtonHandler:function(a){CE.Link.wpLink.close();
return!1},wpSubmitButtonHandler:function(a){a=CE.Link.wpLink.getAttrs();if(a.href&&"http://"!=a.href)return CE.Link.submitCallback&&CE.Link.submitCallback(a),CE.Link.wpLink.close(),!1},onDialogClose:function(){CE.Link.inputs.submit.off("mousedown.motopress-wplink-submit");CE.Link.inputs.cancel.off("click.motopress-wplink-cancel");CE.Link.inputs.close.off("mousedown.motopress-wplink-close");CE.Link.inputs.url.closest("div").show();CE.Link.inputs.title.closest("div").show();CE.Link.inputs.openInNewTab.closest("div").show()}})}(jQuery),
function(c){CE.WPGallery=can.Construct({myThis:null},{frame:null,ctrl:null,init:function(){CE.WPGallery.myThis=this;var a=parent.wp.media,b=a.model.Attachment;a.controller.CEGallery=a.controller.FeaturedImage.extend({defaults:parent._.defaults({id:"motopress-media-library-gallery",title:localStorage.getItem("CEWpGalleryText"),toolbar:"main-insert",filterable:"uploaded",library:a.query({type:"image"}),multiple:"add",editable:!0,priority:60,syncSelection:!1},a.controller.Library.prototype.defaults),
updateSelection:function(){var a=this.get("selection"),c=CE.WPGallery.myThis.ctrl.get(),f;""!==c&&-1!==c&&(f=parent._.map(c.split(/,/),function(a){return b.get(a)}));a.reset(f)}});a.view.MediaFrame.CEGallery=a.view.MediaFrame.Post.extend({createStates:function(){this.states.add([new a.controller.CEGallery])},bindHandlers:function(){a.view.MediaFrame.Select.prototype.bindHandlers.apply(this,arguments);this.on("toolbar:create:main-insert",this.createToolbar,this);parent._.each({content:{embed:"embedContent",
"edit-selection":"editSelectionContent"},toolbar:{"main-insert":"mainInsertToolbar"}},function(a,b){parent._.each(a,function(a,d){this.on(b+":render:"+d,this[a],this)},this)},this)},mainInsertToolbar:function(a){var b=this;this.selectionStatusToolbar(a);a.set("insert",{style:"primary",priority:80,text:localStorage.getItem("CEWpGalleryText"),requires:{selection:!0},click:function(){var a=b.state(),d=a.get("selection");b.close();a.trigger("insert",d).reset()}})}});this.frame=new a.view.MediaFrame.CEGallery(parent._.defaults({},
{state:"motopress-media-library-gallery",title:localStorage.getItem("CEWpGalleryText"),library:{type:"image"},multiple:!0}));this.frame.on("open",this.proxy("onOpen"));this.frame.on("close",this.proxy("onClose"));this.frame.on("insert",this.proxy("setImage"))},open:function(a){this.ctrl=a;this.frame.open()},onOpen:function(){var a=this.frame;a.reset();var b=this.ctrl.getArray();if(null!==b){var d=null;b.forEach(function(b){d=parent.wp.media.attachment(b);d.fetch();a.state().get("selection").add(d)})}},
onClose:function(){c("."+CE.Dialog.myThis.dialogClass).focus();var a=c(parent.document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},0)},setImage:function(){var a=[],b=this.frame.state().get("selection").models;c.each(b,function(b,c){a.push(c.attributes.id)});this.ctrl.set(a);this.ctrl.element.trigger("change")}})}(jQuery),function(c){CE.Dialog=can.Construct({myThis:null},{dialogClass:"motopress-dialog",
element:c("<div />",{id:"motopress-dialog"}),shortcode:null,oldShortcode:null,dialog:null,minimizeRestoreBtn:c("<button />",{"class":"ui-dialog-titlebar-minimize"}),state:{minimized:"minimized",restored:"restored"},tabs:c("<div />",{id:"motopress-dialog-tabs"}),settingsTitle:c("<li />"),styleTitle:c("<li />"),settingsTab:c("<div />",{id:"motopress-dialog-settings-tab"}),styleTab:c("<div />",{id:"motopress-dialog-style-tab"}),styleEditorContainer:c("<div />",{id:"motopress-style-editor-container",
"class":"motopress-hide"}),mode:"tabs",setup:function(){var a=c("<ul />");c("<a />",{href:"#"+this.settingsTab.attr("id"),"class":"motopress-text-no-color-text",text:localStorage.getItem("CESettings")}).append(c("<i />",{"class":"motopress-settings-icon"})).appendTo(this.settingsTitle);c("<a />",{href:"#"+this.styleTab.attr("id"),"class":"motopress-text-no-color-text",text:localStorage.getItem("CEStyle")}).append(c("<i />",{"class":"motopress-style-icon"})).appendTo(this.styleTitle);a.append(this.settingsTitle,
this.styleTitle);this.tabs.append(a,this.settingsTab,this.styleTab).appendTo(this.element);this.styleEditorContainer.appendTo(this.element);this.element.appendTo("body")},setMode:function(a){switch(a){case "tabs":this.styleEditorContainer.addClass("motopress-hide");this.tabs.removeClass("motopress-hide");break;case "style-editor":this.tabs.addClass("motopress-hide"),this.styleEditorContainer.removeClass("motopress-hide")}this.mode=a;this.updateTitle()},updateTitle:function(){var a=this.shortcode.control();
switch(this.getMode()){case "tabs":this.setTitle(a.shortcodeLabel);break;case "style-editor":var b=this.styleEditorContainer.children().control();this.setTitle(a.shortcodeLabel+" - "+b.getTitle())}},getMode:function(){return this.mode},init:function(){CE.Dialog.myThis=this;var a=null,b=!1,d=0,e=parent.MP.Utils.version_compare(c.fn.jquery,"1.9.0","<"),f=sessionStorage.getItem("motopressDialogLeft"),g=sessionStorage.getItem("motopressDialogTop"),f=null!==f&&null!==g?[parseInt(f),parseInt(g)]:{my:"right-20 top+20",
at:"right top",of:window},g=sessionStorage.getItem("motopressDialogWidth"),l=sessionStorage.getItem("motopressDialogHeight");null===g&&(g=300);null===l&&(l=500);c.ui.dialog.prototype._focusTabbable=function(){};this.element.dialog({autoOpen:!1,closeOnEscape:!0,closeText:"",dialogClass:this.dialogClass,draggable:!0,modal:!1,position:f,resizable:!0,minWidth:280,width:g,minHeight:280,height:l,maxHeight:c(window).height(),create:function(){CE.Dialog.myThis.dialog=CE.Dialog.myThis.element.dialog("widget");
a=CE.Dialog.myThis.dialog;a.on("resizestart",function(a,f){b=c(a.originalEvent.target).hasClass("ui-resizable-n");d=c(document).scrollTop();e&&(b||c(this).css("top",parseInt(c(this).css("top"))-d))});a.on("resize",function(a,f){e&&b&&c(this).css("top",parseInt(c(this).css("top"))-d)});a.on("resizestop",function(a,b){CE.Dialog.myThis.savePosition(b);CE.Dialog.myThis.saveSize(b)});c(this).prev(".ui-dialog-titlebar").find(".ui-dialog-titlebar-close").before(CE.Dialog.myThis.minimizeRestoreBtn);var f=
a.draggable("option","cancel")+", .ui-dialog-titlebar-minimize, .ui-dialog-titlebar-restore";a.draggable("option","cancel",f);CE.Dialog.myThis.minimizeRestoreBtn.on("click",function(){c(this).hasClass("ui-dialog-titlebar-minimize")?CE.Dialog.myThis.minimize():CE.Dialog.myThis.restore()})},dragStart:function(a,b){CE.LeftBar.myThis.disable()},dragStop:function(a,b){CE.Dialog.myThis.savePosition(b);CE.LeftBar.myThis.enable()},close:function(){CE.Dialog.myThis.close()},beforeClose:function(a,b){},open:function(){var b=
c("."+CE.Selectable.myThis.selectedClass);b.length&&CE.Selectable.focusWithoutScroll(b.prev());var b=parseInt(sessionStorage.getItem("motopressDialogLeft")),d=parseInt(sessionStorage.getItem("motopressDialogTop")),e=a.width(),f=a.height(),g=c(window).width(),l=c(window).height();f>l&&(f=l,a.height(f));0>d?a.css("top",0):f<l&&d+f>l?a.css("top",l-f):d+f>l?a.css("top",l-f):a.css("top",d);0>b?a.css("left",0):e<g&&b+e>g?a.css("left",g-e):a.css("left",b)},resizeStart:function(){CE.LeftBar.myThis.disable()},
resizeStop:function(){CE.LeftBar.myThis.enable()}});c(parent.window).on("resize.CE.Dialog",this.proxy("onResize"));parent.MP.Utils.fixTabsBaseTagConflict(this.tabs,document,location);this.tabs.tabs({activate:function(a,b){CE.Dialog.myThis.shortcode.attr("data-motopress-dialog-tab",b.newTab.index())}})},_destroy:function(){c(parent.window).off("resize.CE.Dialog")},onResize:function(){this.element.dialog("option","maxHeight",c(window).height())},open:function(a){this.oldShortcode=this.shortcode;a.hasClass("motopress-clmn-select-handle")?
this.shortcode=a.closest(".motopress-clmn"):a.hasClass("motopress-row-select-handle")?this.shortcode=a.closest(".motopress-row"):this.shortcode=a.closest(".motopress-clmn").find(".motopress-block-content").first().children("[data-motopress-shortcode]");var b=!1;"undefined"!==typeof this.shortcode&&this.shortcode&&this.shortcode.length&&"undefined"!==typeof this.oldShortcode&&this.oldShortcode&&this.oldShortcode.length&&this.shortcode[0]===this.oldShortcode[0]&&(b=!0);var d=this.shortcode.control(CE.Controls);
if(null!==CE.LeftBar.myThis.library&&"undefined"!==typeof d.group&&"undefined"!==typeof d.shortcodeName&&CE.LeftBar.myThis.library[d.group].objects.hasOwnProperty(d.shortcodeName)){a=c.isEmptyObject(CE.LeftBar.myThis.library[d.group].objects[d.shortcodeName].parameters);var e=this.isGrid?"gridProps":"props";a&&c.isEmptyObject(CE.Style[e])||(this.setTitle(d.shortcodeLabel),e=!1,this.shortcode.hasClass("motopress-new-object")&&(e=!0,this.shortcode.removeClass("motopress-new-object")),b||d.display(e),
sessionStorage.getItem("motopressDialogState")===this.state.minimized?this.minimize():this.restore(),b=a?this.styleTitle.index():this.settingsTitle.index(),d=this.shortcode.attr("data-motopress-dialog-tab"),"undefined"!==typeof d&&(b=d),a?this.tabs.tabs("disable",this.settingsTitle.index()):!1!==this.tabs.tabs("option","disabled")&&this.tabs.tabs("enable",this.settingsTitle.index()),this.tabs.tabs("option","active",b),this.element.dialog("open"),this.element.find(".motopress-controls").trigger("dialogOpen"))}},
close:function(){"style-editor"===this.getMode()&&this.styleEditorContainer.children().control().confirm();this.setTitle();var a=c("."+CE.Selectable.myThis.selectedClass);a.length&&CE.Selectable.focusWithoutScroll(a.prev())},setTitle:function(a){a="undefined"!==typeof a?a:"";"string"===typeof a&&(this.element.dialog("option","title",a),this.element.dialog("widget").find(".ui-dialog-title").attr("title",a))},savePosition:function(a){sessionStorage.setItem("motopressDialogLeft",this.dialog.css("left"));
sessionStorage.setItem("motopressDialogTop",this.dialog.css("top"))},saveSize:function(a){sessionStorage.setItem("motopressDialogWidth",a.size.width);sessionStorage.setItem("motopressDialogHeight",a.size.height)},minimize:function(){this.minimizeRestoreBtn.removeClass("ui-dialog-titlebar-minimize").addClass("ui-dialog-titlebar-restore");sessionStorage.setItem("motopressDialogState",this.state.minimized);this.element.nextAll().add(this.element).addClass("motopress-hide");this.dialog.removeClass("motopress-dialog-"+
this.state.restored).addClass("motopress-dialog-"+this.state.minimized)},restore:function(){this.minimizeRestoreBtn.removeClass("ui-dialog-titlebar-restore").addClass("ui-dialog-titlebar-minimize");sessionStorage.setItem("motopressDialogState",this.state.restored);this.element.nextAll().add(this.element).removeClass("motopress-hide");this.dialog.removeClass("motopress-dialog-"+this.state.minimized).addClass("motopress-dialog-"+this.state.restored)}})}(jQuery),function(c){CE.WPMedia=can.Construct({myThis:null},
{frame:null,propertyMedia:null,init:function(){CE.WPMedia.myThis=this;this.frame=parent.wp.media({id:"motopress-media-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",router:"browse",menu:"default",searchable:!0,filterable:!1,sortable:!1,title:localStorage.getItem("CEMediaLibraryText"),button:{text:localStorage.getItem("CEMediaLibraryText")},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setMedia"));
this.frame.on("close",this.proxy("onClose"))},onOpen:function(){var a;this.propertyMedia=CE.Dialog.myThis.element.find("[data-motopress-open-media-lib=1]");this.propertyMediaID=this.propertyMedia.find(".motopress-property-media-id");this.propertyMediaSrc=this.propertyMedia.find(".motopress-property-media");a=this.propertyMediaID.val();a=null!==a?parent.wp.media.attachment(a):parent.wp.media.attachment();a.fetch();this.frame.state().get("selection").add(a)},setMedia:function(){var a=this.frame.state().get("selection").models[0].attributes,
b=this.propertyMedia.control(),d=a.url;this.propertyMediaID.val(a.id);this.propertyMediaSrc.val(d);b.element.removeAttr("data-motopress-open-media-lib");b.element.trigger("change")},onClose:function(){c("."+CE.Dialog.myThis.dialogClass).focus();this.propertyMedia.removeAttr("data-motopress-open-media-lib");var a=c(parent.document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},0)}});CE.WPAudio=can.Construct({myThis:null},
{frame:null,propertyAudio:null,propertyAudioTitle:null,init:function(){CE.WPAudio.myThis=this;this.frame=parent.wp.media({id:"motopress-audio-library",multiple:!1,describe:!1,toolbar:"select",sidebar:"settings",content:"upload",router:"browse",menu:"default",searchable:!0,filterable:!1,sortable:!1,title:"Set audio file",button:{text:"Set audio file"},library:{type:"audio"},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setAudio"));
this.frame.on("close",this.proxy("onClose"))},onOpen:function(){var a;this.propertyAudio=CE.Dialog.myThis.element.find(".motopress-property-audio-id");this.propertyAudioTitle=CE.Dialog.myThis.element.find(".motopress-property-audio-title");a=this.propertyAudio.val();a=null!==a?parent.wp.media.attachment(a):parent.wp.media.attachment();a.fetch();this.frame.state().get("selection").add(a)},setAudio:function(){var a=this.frame.state().get("selection").models[0].attributes;this.propertyAudio.val(a.id);
this.propertyAudioTitle.val(a.title);this.propertyAudio.trigger("change")},onClose:function(){c("."+CE.Dialog.myThis.dialogClass).focus();var a=c(parent.document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},0)}});CE.WPVideo=can.Construct({myThis:null},{frame:null,propertyVideo:null,init:function(){CE.WPVideo.myThis=this;this.frame=parent.wp.media({id:"motopress-video-library",multiple:!1,describe:!1,
toolbar:"select",sidebar:"settings",content:"upload",router:"browse",menu:"default",searchable:!0,filterable:!1,sortable:!1,title:localStorage.getItem("CEVideoLibraryText"),button:{text:localStorage.getItem("CEVideoLibraryText")},library:{type:"video"},contentUserSetting:!0,syncSelection:!0});this.frame.on("open",this.proxy("onOpen"));this.frame.on("select",this.proxy("setVideo"));this.frame.on("close",this.proxy("onClose"))},onOpen:function(){this.propertyVideo=CE.Dialog.myThis.element.find("[data-motopress-open-video-lib=1]")},
setVideo:function(){var a=this.frame.state().get("selection").models[0].attributes.url,b=this.propertyVideo.control();b.set(a);b.element.removeAttr("data-motopress-open-video-lib");b.element.trigger("change")},onClose:function(){c("."+CE.Dialog.myThis.dialogClass).focus();this.propertyVideo.removeAttr("data-motopress-open-video-lib");var a=c(parent.document).find("html, body");a.addClass("motopress-ce-jumping-fix");var b=setTimeout(function(){a.removeClass("motopress-ce-jumping-fix");clearTimeout(b)},
0)}})}(jQuery),function(c){CE.Style=can.Construct({gridProps:null,props:{mp_custom_style:{type:"style_editor",label:localStorage.getItem("CECustomStyle"),description:localStorage.getItem("CECustomStyleDesc"),parameters:{"background-color":{type:"color-picker",label:localStorage.getItem("CEBgColor"),"default":""},color:{type:"color-picker",label:"Text Color","default":""},"background-image-type":{type:"radio-buttons",label:"Background Type","default":"image",list:{image:"Image",gradient:"Gradient",
none:"None"}},"background-image":{type:"image-src",label:localStorage.getItem("CEBgImage"),"default":"",dependency:{parameter:"background-image-type",value:"image"}},"background-repeat":{type:"select",label:localStorage.getItem("CEBgImageRepeat"),"default":"",list:{"":localStorage.getItem("CEDefault"),repeat:localStorage.getItem("CERepeat"),"repeat-x":localStorage.getItem("CERepeatX"),"repeat-y":localStorage.getItem("CERepeatY"),"no-repeat":localStorage.getItem("CENoRepeat")},dependency:{parameter:"background-image",
except:""}},"background-size":{type:"select",label:localStorage.getItem("CEBgImageSize"),"default":"",list:{"":localStorage.getItem("CEDefault"),cover:localStorage.getItem("CECover"),contain:localStorage.getItem("CEContain"),auto:localStorage.getItem("CEAuto")},dependency:{parameter:"background-image",except:""}},"background-position":{type:"select",label:localStorage.getItem("CEBgImagePosition"),"default":"",list:{"":localStorage.getItem("CEDefault"),"center center":localStorage.getItem("CECenter")+
" "+localStorage.getItem("CEMiddle"),"center top":localStorage.getItem("CECenter")+" "+localStorage.getItem("CETop"),"center bottom":localStorage.getItem("CECenter")+" "+localStorage.getItem("CEBottom"),"left top":localStorage.getItem("CELeft")+" "+localStorage.getItem("CETop"),"left center":localStorage.getItem("CELeft")+" "+localStorage.getItem("CEMiddle"),"left bottom":localStorage.getItem("CELeft")+" "+localStorage.getItem("CEBottom"),"right top":localStorage.getItem("CERight")+" "+localStorage.getItem("CETop"),
"right center":localStorage.getItem("CERight")+" "+localStorage.getItem("CECenter"),"right bottom":localStorage.getItem("CERight")+" "+localStorage.getItem("CEBottom"),custom:localStorage.getItem("CECustom")},dependency:{parameter:"background-image",except:""}},"background-position-x":{type:"spinner",label:localStorage.getItem("CEBgImagePositionX"),min:0,max:100,step:1,"default":"50",dependency:{parameter:"background-position",value:"custom"}},"background-position-y":{type:"spinner",label:localStorage.getItem("CEBgImagePositionY"),
min:0,max:100,step:1,"default":"50",dependency:{parameter:"background-position",value:"custom"}},"background-attachment":{type:"select",label:localStorage.getItem("CEBgImageAttachment"),"default":"",list:{"":localStorage.getItem("CEDefault"),fixed:localStorage.getItem("CEFixed"),scroll:localStorage.getItem("CEScroll")},dependency:{parameter:"background-image",except:""}},"background-gradient":{type:"gradient-picker",label:"","default":"",dependency:{parameter:"background-image-type",value:"gradient",
needDependenceValue:!0}},"padding-top":{type:"text",label:localStorage.getItem("CEPaddingTop"),"default":""},"padding-bottom":{type:"text",label:localStorage.getItem("CEPaddingBottom"),"default":""},"padding-left":{type:"text",label:localStorage.getItem("CEPaddingLeft"),"default":""},"padding-right":{type:"text",label:localStorage.getItem("CEPaddingRight"),"default":""},"margin-top":{type:"text",label:localStorage.getItem("CEMarginTop"),"default":""},"margin-bottom":{type:"text",label:localStorage.getItem("CEMarginBottom"),
"default":""},"margin-left":{type:"text",label:localStorage.getItem("CEMarginLeft"),"default":""},"margin-right":{type:"text",label:localStorage.getItem("CEMarginRight"),"default":""},"border-style":{type:"select",label:localStorage.getItem("CEBorderStyle"),"default":"",list:{"":localStorage.getItem("CEDefault"),none:localStorage.getItem("CENone"),solid:localStorage.getItem("CESolid"),dotted:localStorage.getItem("CEDotted"),dashed:localStorage.getItem("CEDashed"),"double":localStorage.getItem("CEDouble"),
grouve:localStorage.getItem("CEGrouve"),ridge:localStorage.getItem("CERidge"),inset:localStorage.getItem("CEInset"),outset:localStorage.getItem("CEOutset")}},"border-top-width":{type:"text",label:localStorage.getItem("CEBorderWidthTop"),"default":"",dependency:{parameter:"border-style",except:"none"}},"border-bottom-width":{type:"text",label:localStorage.getItem("CEBorderWidthBottom"),"default":"",dependency:{parameter:"border-style",except:"none"}},"border-left-width":{type:"text",label:localStorage.getItem("CEBorderWidthLeft"),
"default":"",dependency:{parameter:"border-style",except:"none"}},"border-right-width":{type:"text",label:localStorage.getItem("CEBorderWidthRight"),"default":"",dependency:{parameter:"border-style",except:"none"}},"border-color":{type:"color-picker",label:localStorage.getItem("CEBorderColor"),"default":"",dependency:{parameter:"border-style",except:"none"}},"border-top-left-radius":{type:"text",label:localStorage.getItem("CEBorderRadiusTopLeft"),"default":""},"border-top-right-radius":{type:"text",
label:localStorage.getItem("CEBorderRadiusTopRight"),"default":""},"border-bottom-left-radius":{type:"text",label:localStorage.getItem("CEBorderRadiusBottomLeft"),"default":""},"border-bottom-right-radius":{type:"text",label:localStorage.getItem("CEBorderRadiusBottomRight"),"default":""}}},mp_style_classes:{type:"select2",label:localStorage.getItem("CEStyleClassesLabel"),description:localStorage.getItem("CEStyleClassesLabelDesc")},margin:{type:"margin",label:localStorage.getItem("CEMarginLabel"),
sides:["top","bottom","left","right"],values:["none",0,10,15,20,25,50,100],"default":["none","none","none","none"],classPrefix:"motopress-margin-",regExp:""}},getStyleEditorProps:function(){return c.extend({},CE.Style.props.mp_custom_style.parameters)},globalPredefinedClasses:{}},{})}(jQuery),function(c){CE.Ctrl=can.Control.extend({bodyEl:c("body"),processValue:function(a,b,d){(a="undefined"!==typeof d&&d&&"undefined"===typeof a?b:a)||(a="");return String(a)}},{name:null,dependency:!1,disabled:!1,
hided:!1,isPermanentHided:!1,customized:!1,shortcode:null,shortcodeName:null,shortcodeCtrl:null,formCtrl:null,init:function(a,b){this.customized=!1;this.name=b.name;this.dependency=b.dependency;this.disabled=b.disabled;this.isPermanentHided=b.hasOwnProperty("isPermanentHided")&&b.isPermanentHided;this.formCtrl=b.formCtrl;b.hasOwnProperty("innerForm")&&(this.innerForm=b.innerForm);this.shortcode=b.shortcode;this.shortcodeName=CE.Shortcode.getShortcodeName(this.shortcode);this.shortcodeGroup=CE.Shortcode.getShortcodeGroup(this.shortcode);
this.shortcodeCtrl=b.shortcode.control()},afterInit:function(){this.isPermanentHided&&this.hide()},get:function(){},set:function(){},hide:function(){this.element.closest("[data-motopress-parameter]").addClass("motopress-hide");this.hided=!0},show:function(){this.isPermanentHided||(this.element.closest("[data-motopress-parameter]").removeClass("motopress-hide"),this.hided=!1)},isHided:function(){return this.hided},change:function(a,b,d){b.stopPropagation();"undefined"===typeof d&&(d=!0);this.hideDependencedControls();
d&&this.formCtrl.changeProperty(this)}," customize":function(a,b){if(this.customized)return!1;this.customized=!0},hideDependencedControls:function(){var a=this,b;a.formCtrl.form.find('> [data-motopress-parameter] > .motopress-controls:not(".select2-container"), > [data-motopress-parameter] > :not(".motopress-property-legend, .motopress-property-label, .motopress-property-description, hr") > .motopress-controls').each(function(){b=c(this).control();b.dependency&&a.name===b.dependency.parameter&&(b.isShouldBeHiddenByDependency()?
b.hide():b.show(),b.hideDependencedControls())})},isShouldBeHiddenByDependency:function(){var a=!1;if(this.hasOwnProperty("dependency")&&this.dependency.hasOwnProperty("parameter")){var b=this.formCtrl.getCtrlByName(this.dependency.parameter),d=this.dependency.hasOwnProperty("value")?c.isArray(this.dependency.value)?-1!==c.inArray(b.get(),this.dependency.value):b.get()==this.dependency.value:!0,e=this.dependency.hasOwnProperty("except")?c.isArray(this.dependency.except)?-1!==c.inArray(b.get(),this.dependency.except):
b.get()==this.dependency.except:!1;!d||e?a=!0:b.dependency&&(a=b.isShouldBeHiddenByDependency())}return a}});CE.Ctrl("CE.CtrlInput",{},{get:function(){return this.element.val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.element.val(a)}});CE.Ctrl("CE.CtrlSpinner",{listensTo:["customize"]},{spinning:!1,min:null,max:null,step:1,init:function(a,b){this._super(a,b);b.hasOwnProperty("min")&&(this.min=b.min);b.hasOwnProperty("max")&&(this.max=b.max);b.hasOwnProperty("step")&&(this.step=b.step)},
" customize":function(a,b){if(this.customized)return!1;this.customized=!0;var d=this;a.spinner({disabled:this.disabled,min:this.min,max:this.max,step:this.step,stop:function(b,c){d.spinning&&(a.trigger("change",d.oldValue),d.spinning=!1,d.oldValue=null)},spin:function(a,b){d.spinning||(d.spinning=!0,d.oldValue=d.get())}})},change:function(a,b,d){var c=this.get();null!==c&&d!==c&&c>=this.min&&c<=this.max&&0===(c/this.step).toFixed(12)%1&&CE.Ctrl.prototype.change.apply(this,[a,b])},get:function(){return this.element.spinner("value")},
set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);"undefined"!==typeof this.element.data("uiSpinner")?this.element.spinner("value",a):this.element.val(a)}});CE.Ctrl("CE.CtrlDateTimePicker",{listensTo:["customize"]},{returnMode:null,displayMode:null,input:null,button:null,changeTimeout:null,init:function(a,b){this._super(a,b);this.returnMode=b.returnMode;this.displayMode=b.displayMode;this.input=a.find(".motopress-property-datetime-picker-input");this.wrapper=a.find(".motopress-property-datetime-picker-wrapper")},
set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.input.val(a)},get:function(){return this.input.val()}," customize":function(a,b){this._super(a,b);var d=this;this.wrapper.datetimepicker({format:this.returnMode,debug:!1,icons:{time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down",previous:"fa fa-chevron-left",next:"fa fa-chevron-right",today:"glyphicon glyphicon-screenshot",clear:"fa fa-trash-o"}}).on("dp.change",function(a){clearTimeout(d.changeTimeout);
d.changeTimeout=setTimeout(function(){d.element.trigger("change")},500)})}});CE.Ctrl("CE.CtrlLink",{},{get:function(){return c(".motopress-property-link-input",this.element).val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);c(".motopress-property-link-input",this.element).val(a)},".motopress-property-button-default click":function(a){var b=c(".motopress-property-link-input",this.element);CE.Link.myThis.open(b,{title:!1,target:!1},function(a){b.val!=a.href&&(b.val(a.href),b.trigger("change"))},
CE.Link.myThis.wpCancelButtonHandler);return!1}});CE.Ctrl("CE.CtrlTextarea",{},{get:function(){return this.element.val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.element.val(a)}});CE.Ctrl("CE.CtrlTextarea64",{},{get:function(){return parent.MP.Utils.base64_encode(this.element.val())},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.element.val(parent.MP.Utils.base64_decode(a))}});CE.Ctrl("CE.CtrlTextareaTable",{},{get:function(){return parent.MP.Utils.nl2br(this.element.val())},
set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);a=a.replace(/^<p>/,"").replace(/<\/p>$/,"");a=parent.MP.Utils.br2nl(a);this.element.val(a)}});CE.Ctrl("CE.CtrlTextareaTinymce",{},{textarea:null,currentShortcode:null,init:function(a,b){this._super(a,b);this.textarea=a.children(".motopress-property-textarea");this.currentShortcode=b.currentShortcode},get:function(){return this.textarea.val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.textarea.val(a)},".motopress-property-button-default click":function(a,
b){var d=parent.CE.CodeModal.myThis.editor;parent.CE.CodeModal.currentShortcode=this.currentShortcode;parent.CE.CodeModal.currentTextareaTinymce=this.element;var c=this.get();c.length&&(null!==d&&d.setContent(c,{format:"html"}),parent.CE.CodeModal.myThis.content.val(c));parent.CE.CodeModal.myThis.saveHandler=this.saveHandler;parent.CE.CodeModal.myThis.element.data("modal").closeDialog=!1;parent.CE.CodeModal.myThis.element.mpmodal("show")},saveHandler:function(a){a=parent.CE.CodeModal.myThis;a.switchVisual();
var b=parent.CE.CodeModal.currentTextareaTinymce.control(),d=a.editor.getContent({format:"html"});d.length&&(b.set(d),parent.CE.CodeModal.currentTextareaTinymce.trigger("change"));a.element.mpmodal("hide")}});CE.Ctrl("CE.CtrlAudio",{},{init:function(a,b){this._super(a,b);c(".motopress-property-audio-title",this.element).val(b.audioTitle).attr("disabled","disabled")},get:function(){return c(".motopress-property-audio-id",this.element).val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);c(".motopress-property-audio-id",
this.element).val(a)},".motopress-property-button-default click":function(a){CE.WPAudio.myThis.frame.open(this)}});CE.Ctrl("CE.CtrlMediaVideo",{},{init:function(a,b){this._super(a,b)},get:function(){return c(".motopress-property-video-url",this.element).val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);c(".motopress-property-video-url",this.element).val(a)},".motopress-property-button-default click":function(a){this.element.attr("data-motopress-open-video-lib",1);CE.WPVideo.myThis.frame.open(this)}});
CE.Ctrl("CE.CtrlMedia",{listensTo:["dialogOpen"]},{init:function(a,b){this._super(a,b);if("id"==b.returnMode){var d=parent.CE.Iframe.myThis.wpAttachmentDetails,e;for(e in d)b.value==e&&(c(".motopress-property-media-id",this.element).val(e),c(".motopress-property-media",this.element).val(d[e]).attr("disabled","disabled"))}else c(".motopress-property-media",this.element).val(b.value)},get:function(){return"id"==this.options.returnMode?c(".motopress-property-media-id",this.element).val():c(".motopress-property-media",
this.element).val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);"id"==this.options.returnMode?c(".motopress-property-media-id",this.element).val(a):c(".motopress-property-media",this.element).val(a)},".motopress-property-button-default click":function(a){this.element.attr("data-motopress-open-media-lib",1);CE.WPMedia.myThis.frame.open(this)}});CE.Ctrl("CE.CtrlImageGeneral",{listensTo:["dialogOpen"]},{autoOpen:!1,init:function(a,b){this._super(a,b);b.isNew&&"true"===b.autoOpen&&(this.autoOpen=
!0)}});CE.CtrlImageGeneral("CE.CtrlImage",{thumbnail:parent.MP.Settings.pluginDirUrl+"images/ce/imageThumbnail.png"+parent.motopress.pluginVersionParam},{returnMode:"id",pseudoRender:!1,value:null,init:function(a,b){this._super(a,b);this.pseudoRender=b.pseudoRender;b.hasOwnProperty("returnMode")&&(this.returnMode=b.returnMode)}," dialogOpen":function(a){this.autoOpen&&(a.find(".motopress-thumbnail-crop").trigger("click"),this.autoOpen=!1)},get:function(){return null!==this.value?this.value:""},set:function(a,
b,d){if(c.isPlainObject(a)&&a.hasOwnProperty("id")&&a.hasOwnProperty("src")&&a.hasOwnProperty("full"))this.value="id"===this.returnMode?a.id:a.full,this.setThumbnail(a.src,b,d),this.pseudoRender&&(this.setFullSrc(a.full),this.shortcode.css("background-image","url('"+a.full+"')"));else{if(null===this.value&&"id"===this.returnMode&&c.isNumeric(a)){this.showPreloader();this.value=a;var e=this;c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"text",data:{action:"motopress_ce_get_attachment_thumbnail",
nonce:parent.motopressCE.nonces.motopress_ce_get_attachment_thumbnail,postID:parent.motopressCE.postID,id:e.value},success:function(a){a=c.parseJSON(a);e.setThumbnail(a.medium,b,d);e.setFullSrc(a.full);e.hidePreloader()},error:function(a){a=c.parseJSON(a.responseText);a.debug?console.log(a.message):(parent.MP.Flash.setFlash(a.message,"error"),parent.MP.Flash.showMessage());e.setThumbnail(CE.CtrlImage.thumbnail,b,d);e.hidePreloader()}})}"src"===this.returnMode&&"string"===typeof a&&(""===a?this.removeValue():
(this.value=a,this.setThumbnail(this.value,b,d),this.setFullSrc(this.value),this.showTools()))}},setThumbnail:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.element.find(".motopress-thumbnail").attr("src",a)},setFullSrc:function(a){this.element.find(".motopress-thumbnail").attr("data-full-src",a)},".motopress-thumbnail-crop click":function(a,b){a.hasClass(CE.Shortcode.preloaderClass)||(this.element.attr("data-motopress-open-img-lib",1),CE.ImageLibrary.myThis.frame.open())},".motopress-icon-trash click":function(){this.removeValue();
this.element.trigger("change")},removeValue:function(){this.value=null;this.element.find(".motopress-thumbnail").attr("src",CE.CtrlImage.thumbnail);this.hideTools();this.pseudoRender&&(this.shortcode.css("background-image",""),this.element.find(".motopress-thumbnail").removeAttr("data-full-src"))},showTools:function(){this.element.children(".motopress-image-tools").show()},hideTools:function(){this.element.children(".motopress-image-tools").hide()},showPreloader:function(){this.element.children(".motopress-thumbnail-crop").addClass(CE.Shortcode.preloaderClass).children(".motopress-thumbnail").css("visibility",
"hidden");this.hideTools()},hidePreloader:function(){var a=this.element.children(".motopress-thumbnail-crop"),b=a.children(".motopress-thumbnail");a.removeClass(CE.Shortcode.preloaderClass);b.css("visibility","visible");b.attr("src")!==CE.CtrlImage.thumbnail&&this.showTools()}});CE.CtrlImageGeneral("CE.CtrlImageSlider",{},{ids:null,init:function(a,b){this._super(a,b)}," dialogOpen":function(a){this.autoOpen&&(a.trigger("click"),this.autoOpen=!1)},get:function(){return null!==this.ids?this.ids:""},
set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);b=typeof a;if("object"===b){b="";d=a.length;for(var e=0;e<d;e++)b=e<d-1?b+(a[e]+","):b+a[e];this.ids=b}else if("number"===b||"string"===b)this.ids=c.trim(a)},getArray:function(){var a=[];if(this.ids)for(var a=this.ids.split(","),b,d=0;d<a.length;d++)(b=parseInt(a[d],10))?a[d]=b:delete a[d];return a},click:function(a){a.hasClass(CE.Shortcode.preloaderClass)||CE.WPGallery.myThis.open(this)}});CE.Ctrl("CE.CtrlVideo",{},{init:function(a,b){this._super(a,
b);this.element.on("paste",function(){var b=setTimeout(function(){a.blur();clearTimeout(b)},0)})},get:function(){return this.element.val()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);this.element.val(a)}});CE.Ctrl("CE.CtrlCheckbox",{},{get:function(){return this.element.is(":checked").toString()},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);"true"===a?this.element.attr("checked","checked"):this.element.removeAttr("checked")}});CE.CtrlCheckbox("CE.CtrlGroupCheckbox",{},{change:function(a,
b){a.is(":checked")&&a.closest(".motopress-property-group-accordion-item").siblings().find('.motopress-property-group-accordion-item-content > [data-motopress-parameter="'+this.name+'"] > .motopress-controls').each(function(){var a=c(this).control();"true"===a.get()&&(a.set("false"),CE.Ctrl.prototype.change.apply(a,[c(this),b]))});CE.Ctrl.prototype.change.apply(this,[a,b])}});CE.Ctrl("CE.CtrlSelect",{listensTo:["customize"],init:function(){CE.Ctrl.bodyEl.on("click",".motopress-property-select:not(.open) > .dropdown-toggle",
function(){var a=c(this).next(),b=a.find("ul > li").length;a.find("li:eq("+(6<=b?5:b-1)+") > a").focus();a.find("ul > li > a.motopress-dropdown-selected").focus()})},setSelected:function(a){var b=a.find("option"),b=b.index(b.filter(":selected"));a=a.next().find(".dropdown-menu > ul > li");a.children("a.motopress-dropdown-selected").removeClass("motopress-dropdown-selected");a.filter('[rel="'+b+'"]').children("a").addClass("motopress-dropdown-selected")}},{get:function(){return this.element.val()},
set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.find('[value="'+a+'"]').attr("selected","selected")},change:function(a,b){this._super(a,b);CE.CtrlSelect.setSelected(a)},refresh:function(){this.element.selectpicker("refresh");this.clearSelectpicker();CE.CtrlSelect.setSelected(this.element)},clearSelectpicker:function(){var a=this.element.next();a.removeClass("ce_ctrl_select motopress-controls");a=a.children(".dropdown-toggle");a.html(a.html().replace(/&nbsp;/g,""))}," customize":function(a){"undefined"!==
typeof a.data("selectpicker")&&(a.next().remove(),c.removeData(a[0],"selectpicker"));a.selectpicker({size:6});this.clearSelectpicker();CE.CtrlSelect.setSelected(a)},updateOptions:function(a,b){var c=CE.CtrlTemplates.generateOptions(a,b);this.element.html(c);this.refresh()}});CE.Ctrl("CE.CtrlSelectMultiple",{listensTo:["customize"]},{init:function(a,b){this._super(a,b)},get:function(){var a="";this.element.select2("data").forEach(function(b,c){a+=""!==a?","+b.id:b.id});return a},set:function(a,b,d){var e=
this;a=CE.Ctrl.processValue(a,b,d);a=a.split(",");this.element.find("option").removeAttr("selected");c.each(a,function(a,b){e.element.find('option[value="'+b+'"]').attr("selected","selected")})}," customize":function(a,b){a.select2({separator:",",closeOnSelect:!1,containerCssClass:"motopress-select2",dropdownCssClass:"motopress-select2-dropdown motopress-multiple-select-control-dropdown",adaptContainerCssClass:function(a){if("motopress-controls"!==a)return a}})}});CE.Ctrl("CE.CtrlSelect2",{listensTo:["customize"]},
{isPreview:!1,previewClass:null,unsetClasses:[],data:null,select2DropdownClass:"motopress-property-select2-custom-class",uniqueDropdownClass:null,init:function(a,b){this._super(a,b);this.options.style=CE.LeftBar.myThis.library[this.options.formCtrl.shortcodeGroup].objects[this.options.formCtrl.shortcodeName].styles.mp_style_classes;this.uniqueDropdownClass=parent.MP.Utils.uniqid("motopress-select2-dropdown-")},get:function(){var a=this,b=this.element.select2("data"),d="";this.isPreview&&(b=b.filter(function(b){return-1===
c.inArray(b.id,a.unsetClasses)}));b.forEach(function(a,b){a.hasOwnProperty("locked")||!0===a.locked||(d+=""!==d?" "+a.id:a.id)});this.isPreview&&(d+=""!==d?" "+this.previewClass:this.previewClass);return d},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);c.isEmptyObject(this.options.style.basic)||(b=this.getBasicClassesString(),a=a?b+" "+a:b);this.options.value=a;this.element.val(a)}," customize":function(a,b){if(this.customized)return!1;this.customized=!0;var d=this;this.data=this.getClassesList();
a.select2({multiple:!0,separator:" ",closeOnSelect:!1,createSearchChoice:function(a,b){if(/^[-_A-Za-z0-9]+$/.test(a)&&0===c(b).filter(function(){return this.hasOwnProperty("id")?0===this.text.toUpperCase().localeCompare(a.toUpperCase())||0===this.id.toUpperCase().localeCompare(a.toUpperCase()):0!==c(this.children).filter(function(){return 0===this.text.toUpperCase().localeCompare(a.toUpperCase())||0===this.id.toUpperCase().localeCompare(a.toUpperCase())}).length}).length)return{id:a.toLowerCase(),
text:a,custom:!0}},initSelection:function(a,b){b(d.valueToData(d.options.value.split(" ")))},query:function(a){d.options.value=d.element.val();var b={},g;b.results=[];c.each(d.data,function(l,h){h.hasOwnProperty("children")?(g={text:h.text,children:[]},g.children=c.makeArray(h.children.filter(function(b){return(0<=b.id.toUpperCase().indexOf(a.term.toUpperCase())||0<=b.text.toUpperCase().indexOf(a.term.toUpperCase()))&&c.inArray(b.id,-1===d.options.value.split(" "))})),g.children.length&&b.results.push(g)):
(0<=h.id.toUpperCase().indexOf(a.term.toUpperCase())||0<=h.text.toUpperCase().indexOf(a.term.toUpperCase()))&&-1===c.inArray(h.id,d.options.value.split(" "))&&b.results.push(h)});a.callback(b)},formatNoMatches:function(){return localStorage.getItem("CEStyleClassesFormatNoMatches")},formatResult:function(a,b){if(a.hasOwnProperty("children"))return a.text;a.hasOwnProperty("disabled")&&a.disabled&&b.attr("title",localStorage.getItem("CELiteTooltipText"));return'<i class="select2-preview-icon"'+(a.hasOwnProperty("external")&&
"undefined"!==typeof a.external?' data-external="'+a.external+'"':"")+' data-value="'+a.id+'"></i>'+a.text},containerCssClass:"motopress-select2",dropdownCssClass:"motopress-select2-dropdown select2-control-dropdown "+d.select2DropdownClass+" "+d.uniqueDropdownClass});a.on("select2-highlight",function(a){d.unsetClasses=d.getUnsetClasses(a.val)});c("."+d.uniqueDropdownClass).on("mouseover",".select2-preview-icon",function(){var a=c(this).attr("data-external");"undefined"!==typeof a&&0===c('[href="'+
a+'"]').length&&(a=c("<link />",{rel:"stylesheet",type:"text/css",href:a}),c("head").append(a));a=c(this).attr("data-value");d.unsetClasses=d.getUnsetClasses(a);d.isPreview=!0;d.setPreviewClass(a);CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOver",{objElement:d.shortcode,objName:d.shortcodeName})});c("."+d.uniqueDropdownClass).on("mouseleave",".select2-preview-icon",function(){d.isPreview=!1;d.unsetClasses=[];d.setPreviewClass();CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOut",{objElement:d.shortcode,
objName:d.shortcodeName})});a.on("select2-blur",function(a){d.isPreview=!1;d.unsetClasses=[];d.setPreviewClass()});a.on("select2-close",function(a){d.isPreview=!1;d.unsetClasses=[];d.setPreviewClass()});a.on("select2-selecting",function(a){d.isPreview=!1;if(a.object.hasOwnProperty("external")&&0===c('[href="'+a.object.external+'"]').length){var b=c("<link />",{rel:"stylesheet",type:"text/css",href:a.object.external});c("head").append(b)}b=c(d.element).select2("val");b=d.excludeGroupValues(b);a.object.hasOwnProperty("custom")&&
!0===a.object.custom&&d.data.push({id:a.object.id,text:a.object.text,custom:a.object.custom});d.element.select2("data",d.valueToData(b))});a.on("select2-loaded",function(a,b){c("."+d.uniqueDropdownClass+">.select2-results>li.select2-result.select2-selected").each(function(){var a=c(this);a.find(".select2-disabled:not(.select2-selected)").length&&a.removeClass("select2-selected")})})},valueToData:function(a){var b=this,d=[];c.each(a,function(a,f){c.each(b.data,function(a){b.data[a].hasOwnProperty("children")?
c.each(b.data[a].children,function(c){b.data[a].children[c].id===f&&d.push(b.data[a].children[c])}):b.data[a].id===f&&d.push(b.data[a])})});return d},excludeGroupValues:function(a){var b=this;return a=a.filter(function(a){return-1===c.inArray(a,b.unsetClasses)})},setPreviewClass:function(a){this.previewClass=a;this.options.formCtrl.changeProperty(this)},getUnsetClasses:function(a){var b=[];c.each(this.data,function(d,e){var f=!1;if(e.hasOwnProperty("children")&&(void 0===e.allowMultiple||!1===e.allowMultiple)){c.each(e.children,
function(c,d){d.id===a?f=!0:b.push(d.id)});if(f)return!1;b=[]}});return b},getClassesList:function(){var a=this.getPredefinedClasses(),b=""!==this.options.value?this.options.value.split(" "):[],d=this.getGlobalPredefinedClasses(),e=this.getBasicClasses().concat(d,a);b.forEach(function(a,b){0===c(e).filter(function(){var b=!1;return b=this.hasOwnProperty("children")?0!==c(this.children).filter(function(){return this.hasOwnProperty("id")?0===this.id.localeCompare(a):!1}).length:this.hasOwnProperty("id")?
0===this.id.localeCompare(a):!1}).length&&e.push({id:a,text:a})});return e},getBasicClasses:function(){var a=[];c.isEmptyObject(this.options.style.basic)||(this.options.style.basic.hasOwnProperty("class")?a.push({id:this.options.style.basic["class"],text:this.options.style.basic.label,locked:!0}):c.each(this.options.style.basic,function(b,c){a.push({id:c["class"],text:c.label,locked:!0})}));return a},getBasicClassesString:function(){var a=this.getBasicClasses(),b=[];c.each(a,function(a,c){b.push(c.id)});
return b.join(" ")},getPredefinedClasses:function(){var a=[];if(!c.isEmptyObject(this.options.style.predefined)){var b=this.options.style.predefined,d;for(d in b)if(b[d].hasOwnProperty("values")){var e=[],f;for(f in b[d].values)e.push({id:b[d].values[f]["class"],text:b[d].values[f].label,disabled:b[d].values[f].hasOwnProperty("disabled")&&b[d].values[f].disabled,external:b[d].values[f].external});a.push({text:b[d].label,children:e,allowMultiple:b[d].allowMultiple})}else a.push({id:b[d]["class"],text:b[d].label,
disabled:b[d].hasOwnProperty("disabled")&&b[d].disabled,external:b[d].external})}return a},getGlobalPredefinedClasses:function(){var a=[];c.each(CE.Style.globalPredefinedClasses,function(b,d){if(d.hasOwnProperty("values")){var e=[];c.each(d.values,function(a,b){e.push({id:b["class"],text:b.label,disabled:b.hasOwnProperty("disabled")&&b.disabled})});a.push({text:d.label,children:e,allowMultiple:d.allowMultiple})}else a.push({id:d["class"],text:d.label,disabled:d.hasOwnProperty("disabled")&&d.disabled})});
return a}});CE.Ctrl("CE.CtrlStyleEditor",{listensTo:["customize"]},{privateStyleObj:null,previewState:null,select2DropdownClass:"motopress-property-select2-style-editor",isPreview:!1,previewClass:null,unsetClasses:[],uniqueDropdownClass:null,init:function(a,b){this._super(a,b);this.uniqueDropdownClass=parent.MP.Utils.uniqid("motopress-select2-dropdown-")},get:function(){var a=this,b=this.element.select2("data"),d="";this.privateStyleObj.isEmpty()||(d+=this.privateStyleObj.getClassName());this.isPreview&&
(b=b.filter(function(b){return-1===c.inArray(b.id,a.unsetClasses)}));b.forEach(function(a,b){a.hasOwnProperty("locked")||!0===a.locked||CE.StyleEditor.myThis.isExistsPreset(a.id)&&(d+=""!==d?" "+a.id:a.id)});this.isPreview&&(d+=""!==d?" "+this.previewClass:this.previewClass);return d},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);b="";this.privateStyleObj||(this.privateStyleObj=CE.StyleEditor.myThis.getPrivateStyleInstance(a));b+=this.privateStyleObj.getClassName();a=CE.StyleEditor.myThis.retrievePresetClass(a);
CE.StyleEditor.myThis.isExistsPreset(a)&&(b+=" "+a);this.element.val(b)},selectPreset:function(a){a=CE.StyleEditor.myThis.getPresetStyleInstance(a);this.element.select2("data",[this.getPrivateBtn(),{id:a.getClassName(),text:a.getLabel()}]);this.privateStyleFormCtrl.setPresetStyleObj(a)}," customize":function(){if(this.customized)return!1;this.customized=!0;this.privateStyleForm=c("<div />",{"class":"motopress-style-editor-forms motopress-style-editor-private-forms"});this.presetStyleForm=c("<div />",
{"class":"motopress-style-editor-forms motopress-style-editor-preset-forms"});this.privateStyleFormCtrl=new CE.PrivateStyleControlsForm(this.privateStyleForm,{formsMainCtrl:this.formCtrl.formsMainCtrl,styleEditorCtrl:this,editedStyleObj:this.privateStyleObj});this.presetStyleFormCtrl=new CE.PresetStyleControlsForm(this.presetStyleForm,{formsMainCtrl:this.formCtrl.formsMainCtrl,styleEditorCtrl:this});this.customizeSelect()},refresh:function(){var a=this.element.select2("data");c(a).filter(function(a,
c){if(c.hasOwnProperty("locked")&&c.locked)return!0;if(CE.StyleEditor.myThis.isExistsPreset(c.id)){var e=CE.StyleEditor.myThis.getPresetStyleInstance(c.id);c.text=e.getLabel();return!0}return!1});this.element.select2("data",a);this.element.trigger("change")},setPreviewClass:function(a){this.previewClass=a;this.formCtrl.changeProperty(this)},getPrivateBtn:function(){return{id:this.privateStyleObj.getClassName(),text:"Edit Element Style",locked:!0}},customizeSelect:function(){var a=this;a.data=CE.StyleEditor.myThis.getPresetsList(!0);
this.element.select2({multiple:!0,separator:" ",closeOnSelect:!0,initSelection:function(b,c){c(a.valueToData(a.element.val().split(" ")))},query:function(a){var d={results:[]};c.each(CE.StyleEditor.myThis.getPresetsListSelect2(),function(c,f){0<=f.text.toUpperCase().indexOf(a.term.toUpperCase())&&d.results.push(f)});a.callback(d)},formatNoMatches:function(){return localStorage.getItem("CEStylePresetsFormatNoMatches")},formatResult:function(a,c){return'<i class="select2-preview-icon" data-value="'+
a.id+'"></i>'+a.text},containerCssClass:"motopress-select2",dropdownCssClass:"motopress-select2-dropdown select2-control-dropdown "+a.select2DropdownClass+" "+this.uniqueDropdownClass});this.element.select2("container").on("click",".select2-search-choice",function(b){b=c(this).data("select2Data");b.hasOwnProperty("locked")&&b.locked?(a.privateStyleFormCtrl.setPresetStyleObj(a.getSelectedPresetInstance()),a.privateStyleFormCtrl.display(!0)):(b=a.getSelectedPresetInstance(),null!==b&&(a.presetStyleFormCtrl.setEditedStyleObj(b),
a.presetStyleFormCtrl.display(!0)))});this.element.on("select2-highlight",function(b){a.unsetClasses=a.getUnsetClasses(b.val)});c("."+a.uniqueDropdownClass).on("mouseover",".select2-preview-icon",function(){var b=c(this).attr("data-value");a.setPreview(b);CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOver",{objElement:a.shortcode,objName:a.shortcodeName})});c("."+a.uniqueDropdownClass).on("mouseleave",".select2-preview-icon",function(){a.isPreview=!1;a.unsetClasses=[];a.setPreviewClass();CE.Ctrl.bodyEl.trigger("MPCEObjectStylePreviewOut",
{objElement:a.shortcode,objName:a.shortcodeName})});this.element.on("select2-blur select2-close",function(b){a.isPreview=!1;a.unsetClasses=[];a.setPreviewClass()});this.element.on("select2-selecting",function(b){a.isPreview=!1;b=a.element.select2("val");b=a.excludeValues(b);a.element.select2("data",a.valueToData(b))})},setPreview:function(a){this.unsetClasses=this.getUnsetClasses(a);this.isPreview=!0;this.setPreviewClass(a)},unsetPreview:function(){this.isPreview=!1;this.unsetClasses=[];this.setPreviewClass()},
valueToData:function(a){var b=this,d=[];c.each(a,function(a,c){if(CE.StyleEditor.myThis.isExistsPreset(c)){var g=CE.StyleEditor.myThis.getPresetStyleInstance(c);d.push({id:g.getClassName(),text:g.getLabel()})}else CE.StyleEditor.myThis.retrievePrivateClass(c)&&d.push(b.getPrivateBtn())});return d},getUnsetClasses:function(a){var b=CE.StyleEditor.myThis.getPresetsList();delete b[a];return c.map(b,function(a,b){return b})},excludeValues:function(a){var b=this;return a=a.filter(function(a){return-1===
c.inArray(a,b.unsetClasses)})},getSelectedPreset:function(){var a=this.get();return CE.StyleEditor.myThis.retrievePresetClass(a)},getSelectedPresetInstance:function(){var a=this.getSelectedPreset();return CE.StyleEditor.myThis.getPresetStyleInstance(a)},setStatePreview:function(a){this.unsetStatePreview();var b=[];switch(a){case "up":b.push("up");break;case "hover":b.push("up");b.push("hover");break;case "tablet":b.push("up");b.push("tablet");break;case "mobile":b.push("up"),b.push("tablet"),b.push("mobile")}a=
b.map(function(a){return CE.ShortcodeStyle.previewStateClassPrefix+a}).join(" ");b=this.formCtrl.getTargetElement(this);null!==b&&b.addClass(a)},unsetStatePreview:function(){var a=["up","hover","mobile","tablet"].map(function(a){return CE.ShortcodeStyle.previewStateClassPrefix+a}).join(" "),b=this.formCtrl.getTargetElement(this);null!==b&&b.removeClass(a)}});CE.Ctrl("CE.CtrlComplex",{listensTo:["customize"]},{innerForm:null,innerFormCtrl:null,parameters:{},init:function(a,b){this._super(a,b);this.innerForm=
this.element.children(".motopress-property-inner-form");this.innerFormCtrl=new CE.ControlsSubForm(this.innerForm,{formsMainCtrl:this.formCtrl.formsMainCtrl,parentPropertyCtrl:this});this.innerFormCtrl.display(!0)},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.innerFormCtrl.set(this.convertValueToFormData(a))},get:function(){var a=this.innerFormCtrl.get();return this.convertFormDataToValue(a)},convertValueToFormData:function(){return{}},convertFormDataToValue:function(){return""},getParameters:function(){return this.parameters}});
CE.CtrlComplex("CE.CtrlGradient",{valueSeparator:" , ",parseGradientStr:function(a){var b=!1;""!==a&&(a=a.split(CE.CtrlGradient.valueSeparator),3===a.length&&(b={angle:String(parseInt(a[0])),"initial-color":a[1],"final-color":a[2]}));return b}},{parameters:{angle:{type:"spinner",label:"Gradient Angle",min:0,max:360,step:1,"default":"0"},"final-color":{type:"color-picker",label:"Gradient Initial Color","default":""},"initial-color":{type:"color-picker",label:"Gradient Final Color","default":""}},convertValueToFormData:function(a){(a=
CE.CtrlGradient.parseGradientStr(a))||(a={angle:this.parameters.angle["default"],"initial-color":this.parameters["initial-color"]["default"],"final-color":this.parameters["final-color"]["default"]});return a},convertFormDataToValue:function(a){a.hasOwnProperty("angle")&&!isNaN(parseInt(a.angle))?a.angle=String(parseInt(a.angle)):a.angle="0";a.hasOwnProperty("initial-color")&&""!==a["initial-color"]||(a["initial-color"]="");a.hasOwnProperty("final-color")&&""!==a["final-color"]||(a["final-color"]=
"");return a.angle+CE.CtrlGradient.valueSeparator+a["initial-color"]+CE.CtrlGradient.valueSeparator+a["final-color"]}});CE.Ctrl("CE.CtrlEditorButton",{},{dragHandle:null,init:function(a,b){this._super(a,b);this.dragHandle=b.shortcode.closest(".motopress-clmn").find(".motopress-helper").first().children(".motopress-drag-handle")},click:function(){this.dragHandle.click()}});CE.Ctrl("CE.CtrlColorPicker",{listensTo:["customize","dialogOpen"],paletteAddBtn:c("<span />",{"class":"palette-add"})},{lastTimerId:null,
input:null,init:function(a,b){this._super(a,b);this.input=a.children(".motopress-property-input")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);void 0!==this.input.data("spectrum.id")?this.input.spectrum("set",a):this.input.val(a)},get:function(){return this.input.val()},paletteAdd:function(){var a=this.get();if(""!==a){var b=parent.MP.Settings.palettes;b.pop();b.unshift(a);c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"json",data:{action:"motopress_ce_colorpicker_update_palettes",
nonce:parent.motopressCE.nonces.motopress_ce_colorpicker_update_palettes,postID:parent.motopressCE.postID,palettes:b},success:function(a){parent.MP.Settings.palettes=a.data.palettes;c(".motopress-property-color-picker>.motopress-property-input").each(function(){c(this).spectrum("option","palette",parent.MP.Settings.palettes)})},error:function(a){a=c.parseJSON(a.responseText);a.debug?console.log(a.message):(parent.MP.Flash.setFlash(a.message,"error"),parent.MP.Flash.showMessage())}})}},"move.spectrum":function(a,
b,c){var e=this;null===c&&(c="");clearTimeout(this.lastTimerId);this.lastTimerId=setTimeout(function(){e.input.val(c);e.element.trigger("change")},500)}," customize":function(a,b){if(this.customized)return!1;this.customized=!0;this.input.spectrum({allowEmpty:!0,showAlpha:!0,showInput:!0,showInitial:!0,showPalette:!0,showSelectionPalette:!1,showButtons:!1,appendTo:this.element,palette:parent.MP.Settings.palettes,preferredFormat:"rgb",containerClassName:"motopress-property-colorpicker mpce-spectrum-theme",
replacerClassName:"mpce-spectrum-theme"});this.replacer=this.element.find(".sp-replacer");this.container=this.element.find(".sp-container");this.initPaletteAddBtn()},initPaletteAddBtn:function(){var a=this,b=CE.CtrlColorPicker.paletteAddBtn.clone();b.on("click",function(){a.paletteAdd()});this.container.prepend(b)}});CE.Ctrl("CE.CtrlSlider",{},{slider:null,span:null,init:function(a,b){var c=this;this._super(a,b);this.slider=a.children(".motopress-property-slider");this.span=a.children(".motopress-property-slider-value");
this.slider.slider({range:"min",min:parseInt(b.min),max:parseInt(b.max),step:parseInt(b.step),value:parseInt(b.value),slide:function(a,b){c.span.html(b.value)},change:function(b,c){"undefined"!==typeof b.handleObj&&a.trigger("change")},disabled:"true"==b.disabled})},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.span.text(a);this.slider.slider("value",a)},get:function(){return this.slider.slider("option","value")}});CE.Ctrl("CE.CtrlRadioButtons",{},{init:function(a,b){this._super(a,b);this.element.buttonset()},
set:function(a,b,c){a="undefined"!==typeof a?a:b;this.element.find(':radio[value="'+a+'"]').attr("checked",!0);this.element.find(':radio[value="'+a+'"]').button("refresh")},get:function(){return this.element.find(":radio:checked").val()}});CE.Ctrl("CE.CtrlGroup",{listensTo:["render"]},{currentSpan:null,group:null,label:null,accordion:null,button:null,oldItemIndex:null,childFormCtrls:null,init:function(a,b){this._super(a,b);this.currentSpan=b.currentSpan;this.shortcodeCtrl=b.shortcode.control();this.label=
b.label;this.rules=b.rules;this.events=b.events;this.hasRules=!!(this.rules&&this.rules.hasOwnProperty("rootSelector")&&this.rules.rootSelector);this.hasActiveRules=!!(this.hasRules&&this.rules.hasOwnProperty("activeSelector")&&this.rules.hasOwnProperty("activeClass")&&this.rules.activeClass);this.hasEvents=!(!this.events||!this.events.hasOwnProperty("onActive")&&!this.events.hasOwnProperty("onInactive"));this.childFormCtrls=[];this.accordion=a.children(".motopress-property-group-accordion");this.button=
a.find("> .motopress-property-button-wrapper > .motopress-property-button-default")},addChildFormCtrl:function(a){this.childFormCtrls.push(a)},reassignShortcodes:function(){var a,b=this;c.each(this.childFormCtrls,function(c,e){a=b.formCtrl.shortcode.find("[data-motopress-shortcode]:eq("+c+")");e.setShortcode(a)})}," render":function(a,b,d){this.updateLabel();var e=this;b=this.shortcode.attr("data-motopress-active-item");b=d&&"undefined"!==typeof b?parseInt(b):!1;this.accordion.accordion({active:b,
header:"> div > h3",heightStyle:"content",collapsible:!0,create:function(a,b){var c=e.accordion.accordion("option","active");!1!==c&&e.accordion.find(".motopress-property-group-accordion-item:eq("+c+") .motopress-controls").trigger("customize")},beforeActivate:function(a,b){a.hasOwnProperty("originalEvent")&&a.originalEvent.hasOwnProperty("target")&&c(a.originalEvent.target).hasClass("motopress-property-group-accordion-item-remove")&&a.preventDefault()},activate:function(a,b){var c=-1,d=-1;"undefined"!==
typeof b.oldHeader[0]&&(c=b.oldHeader.parent(".motopress-property-group-accordion-item").index());"undefined"!==typeof b.newHeader[0]&&(d=b.newHeader.parent(".motopress-property-group-accordion-item").index());var m=e.shortcodeCtrl.childName;0<=c&&(e.interact("deactivate",c),e.shortcode.removeAttr("data-motopress-active-item"));0<=d&&(e.interact("activate",d),e.shortcode.attr("data-motopress-active-item",d),b.newHeader.parent(".motopress-property-group-accordion-item").find(".motopress-controls").trigger("customize"));
if(m&&e.hasRules&&e.hasEvents){var k=e.shortcode.find(e.rules.rootSelector);if(k.length){var q;0<=c&&e.events.hasOwnProperty("onInactive")&&(c=k.eq(0).closest('[data-motopress-shortcode="'+m+'"]').length?k.closest('[data-motopress-shortcode="'+m+'"]').eq(c).find(e.rules.rootSelector):k.eq(c),q=e.hasActiveRules&&e.rules.activeSelector?c.find(e.rules.activeSelector):c,c.length&&(!e.hasActiveRules||e.hasActiveRules&&q.hasClass(e.rules.activeClass))&&(e.events.onInactive.selector?c.find(e.events.onInactive.selector).triggerHandler(e.events.onInactive.event):
c.triggerHandler(e.events.onInactive.event),e.hasActiveRules&&q.removeClass(e.rules.activeClass)));0<=d&&e.events.hasOwnProperty("onActive")&&(c=k.eq(0).closest('[data-motopress-shortcode="'+m+'"]').length?k.closest('[data-motopress-shortcode="'+m+'"]').eq(d).find(e.rules.rootSelector):k.eq(d),q=e.hasActiveRules&&e.rules.activeSelector?c.find(e.rules.activeSelector):c,c.length&&(!e.hasActiveRules||e.hasActiveRules&&!q.hasClass(e.rules.activeClass))&&(e.events.onActive.selector?c.find(e.events.onActive.selector).triggerHandler(e.events.onActive.event):
c.triggerHandler(e.events.onActive.event),e.hasActiveRules&&(e.rules.activeSelector?k.find(e.rules.activeSelector).removeClass(e.rules.activeClass):k.removeClass(e.rules.activeClass),q.addClass(e.rules.activeClass))))}}}}).sortable({axis:"y",handle:"h3 > .ui-accordion-header-icon",update:function(b,c){var d=c.item.closest(".motopress-property-group-accordion-item").index(),h=e.shortcode.children("div").find("[data-motopress-shortcode]");e.oldItemIndex<d?h.eq(e.oldItemIndex).insertAfter(h.eq(d)):h.eq(e.oldItemIndex).insertBefore(h.eq(d));
parent.MP.Utils.moveArrayElement(e.childFormCtrls,e.oldItemIndex,d);e.accordion.accordion("refresh");e.shortcode.attr("data-motopress-active-item",e.accordion.accordion("option","active"));a.trigger("change")},start:function(a,b){e.oldItemIndex=b.item.closest(".motopress-property-group-accordion-item").index()}});this.disabled&&(!d||d&&this.accordion.children(".motopress-property-group-accordion-item").length)&&this.button.attr("disabled",!0)},change:function(a,b,d){this.updateLabel();var e="";c.each(this.childFormCtrls,
function(a,b){if(d&&"true"===b.shortcode.attr("data-motopress-new")){var l="undefined"!==typeof b.shortcode.attr("data-motopress-parameters")?b.shortcode.attr("data-motopress-parameters"):null;b.setDefaultAttrs(l);c(this).removeAttr("data-motopress-new")}e=parent.CE.Save.getShortcode(e,b.shortcode)});this.shortcode.attr("data-motopress-content",e);CE.Ctrl.prototype.change.apply(this,[a,b])},"> .motopress-property-button-wrapper > .motopress-property-button-default click":function(a,b,d){b.stopPropagation();
if(!this.disabled||"undefined"!==typeof d){a=c("<div />",{"data-motopress-new":"true"});b=null;b=CE.LeftBar.myThis.library[this.shortcodeGroup].objects[this.shortcodeCtrl.childName];null!==b&&CE.LeftBar.myThis.setAttrs(a,this.shortcodeGroup,b);if("undefined"!==typeof d){b=c();for(var e=0;e<d;e++)b=b.add(a.clone());a=b}this.shortcodeCtrl.child.append(a);"undefined"===typeof d&&(d=this.shortcodeCtrl.child.find("[data-motopress-shortcode]").index(c(a).eq(-1)),this.shortcode.attr("data-motopress-active-item",
d));this.formCtrl.regenerateGroupControl(this.name);this.formCtrl.display(!0,this.name,!0)}},".motopress-property-group-accordion-item-remove click":function(a,b){b.stopPropagation();var c=a.closest(".motopress-property-group-accordion-item").index();this.shortcode.children("div").find("[data-motopress-shortcode]:eq("+c+")").remove();this.shortcode.removeAttr("data-motopress-active-item");this.formCtrl.regenerateGroupControl(this.name);this.formCtrl.display(!1,this.name,!0)},updateLabel:function(){if(this.label.hasOwnProperty("parameter")){var a=
this;this.accordion.find(".motopress-property-group-accordion-item-label-text").each(function(){var b=c(this).closest(".motopress-property-group-accordion-item").control().getCtrlByName(a.label.parameter);b&&c(this).text(b.get())})}},interact:function(a,b){if(!1!==b&&0<=b){var c=this.shortcode.find("[data-motopress-shortcode]").eq(b);c.length&&CE.Ctrl.bodyEl.trigger("MPCEObjectInteraction",{action:a,interacted:"child",objElement:this.shortcode,objName:this.shortcodeName,objData:this.shortcode.data("motopress-parameters"),
childObjElement:c,childObjName:this.shortcodeCtrl.childName,childObjData:c.data("motopress-parameters")})}}});CE.Ctrl("CE.CtrlMargin",{},{margin:null,init:function(a,b){this._super(a,b);this.margin=b.margin},get:function(){var a=[],b=this,d=!0;c.each(b.margin.sides,function(c,f){var g=b.element.find('[data-motopress-margin-side="'+f+'"] .'+b.margin.classPrefix+"value").text();a.push(g);g!==b.margin.values[0]&&(d=!1)});return d?"":a.join(",")},set:function(a,b,d){a=CE.Ctrl.processValue(a,b,d);if("string"===
typeof a){if(!a.length)return;a=a.split(",")}var e=this;c.each(a,function(a,b){var c=parseInt(b);isNaN(c)||(b=c);var d=e.element.find('[data-motopress-margin-side="'+e.margin.sides[a]+'"]'),c=d.find("."+e.margin.classPrefix+"icon"),m=d.find("."+e.margin.classPrefix+"value"),d=d.find("."+e.margin.classPrefix+"values");m.text(b);d.removeAttr("data-motopress-margin-disabled");d.filter('[data-motopress-margin-value="'+b+'"]').attr("data-motopress-margin-disabled","");b!==e.margin["default"][a]?(c.attr("data-motopress-margin-active",
""),m.attr("data-motopress-margin-active","")):(c.removeAttr("data-motopress-margin-active"),m.removeAttr("data-motopress-margin-active"))})},".motopress-margin-values click":function(a){if("undefined"===typeof a.attr("data-motopress-margin-disabled")){var b=a.closest("[data-motopress-margin-side]"),c=b.index(),e=b.find("."+this.margin.classPrefix+"icon"),f=b.find("."+this.margin.classPrefix+"value"),b=b.find("."+this.margin.classPrefix+"values"),g=a.text(),l=parseInt(g);isNaN(l)||(g=l);f.text(g);
b.removeAttr("data-motopress-margin-disabled");a.attr("data-motopress-margin-disabled","");g!==this.margin["default"][c]?(e.attr("data-motopress-margin-active",""),f.attr("data-motopress-margin-active","")):(e.removeAttr("data-motopress-margin-active"),f.removeAttr("data-motopress-margin-active"));this.element.trigger("change")}},getClasses:function(a){var b=[];if("undefined"!==typeof a&&a.length){"string"===typeof a&&(a=a.split(","));var d=[];c.each(a,function(a,b){-1===c.inArray(b,d)&&d.push(b)});
var e=1===d.length;if(4===a.length&&e&&d[0]!==this.margin.values[0])b.push(this.margin.classPrefix+d[0]);else{var f=this;c.each(a,function(a,c){c!==f.margin["default"][a]&&b.push(f.margin.classPrefix+f.margin.sides[a]+"-"+c)})}}return b.join(" ")}});CE.Ctrl("CE.CtrlIconPicker",{listensTo:["customize"]},{emptyIcon:!1,emptyIconValue:null,firstChanged:!0,oldValue:"",get:function(){return this.element.find("option:selected").attr("data-value")},set:function(a,b,c){a=CE.Ctrl.processValue(a,b,c);this.element.find('[data-value="'+
a+'"]').attr("selected","selected")},change:function(a,b){if(this.firstChange)return this.firstChange=!1,this.oldValue=this.get(),!1;if(this.oldValue!=this.get())this._super(a,b),CE.CtrlSelect.setSelected(a),this.oldValue=this.get();else return!1},init:function(a,b){this._super(a,b);this.firstChange=!0;this.oldValue=this.get();"undefined"!==typeof b.emptyValue&&(this.emptyIcon=!0,this.emptyIconValue="undefined"!==typeof b.emptyValue?b.emptyValue:"")}," customize":function(a){if(this.customized)return!1;
this.customized=!0;a.fontIconPicker({emptyIcon:this.emptyIcon,emptyIconValue:this.emptyIconValue,theme:"fip-mpce",iconsPerPage:1E3});var b=a.get(0).className;a.siblings(".icons-selector").addClass(b).removeClass("ce_ctrl_icon_picker motopress-controls")}})}(jQuery),function(c){CE.CtrlTemplates=can.Construct({createLegend:function(a){return"undefined"!==typeof a&&a.length?(a=c("<div />",{"class":"motopress-property-legend",html:a}),c.merge(a,c("<hr />"))):null},createLabel:function(a){return c("<label />",
{"class":"motopress-property-label",text:a})},createDescription:function(a){a=c("<div />",{"class":"motopress-property-description",html:a});return c.merge(a,c("<hr />"))},createInput:function(a,b,d,e){"undefined"===typeof b&&(b=null);"undefined"===typeof d&&(d="text");"undefined"===typeof e&&(e="input");var f={};if(a.hasOwnProperty("disabled")){var g="true"===a.disabled;g&&(f.disabled=g)}b=c("<input />",{"class":"motopress-property-"+e,type:d,name:b});this.setAttrs(b,a,f);return b},createLink:function(a,
b){var d=c("<div />",{"class":"motopress-property-link"}),e=this.createInput(a,b,void 0,"link-input"),f=this.createButton(a);d.append(e,f);this.setAttrs(d,a,{});return d},createMedia:function(a,b){"undefined"===typeof b&&(b=null);var d="",e={},f=c("<div />",{"class":"motopress-property-link"});switch(a.type){case "audio":this.createInput(a,b,"hidden","audio-id").appendTo(f);d="audio-title";break;case "media-video":d="video-url";break;case "media":this.createInput(a,b,"hidden","media-id").appendTo(f),
d="media"}var d=this.createInput(a,b,"text",d).appendTo(f),g=this.createButton(a,b).appendTo(f);this.setAttrs(d,a,e);this.setAttrs(g,a,e);return f},createTextarea:function(a){var b={rows:5,cols:10};if(a.hasOwnProperty("disabled")){var d="true"===a.disabled;d&&(b.disabled=d)}d=c("<textarea />",{"class":"motopress-property-textarea"});this.setAttrs(d,a,b);return d},createTextareaTinyMCE:function(a){var b=this.createTextarea(a);a=this.createButton(a);return c("<div />",{"class":"motopress-property-textarea-tinymce"}).append(b,
a)},createImage:function(a){var b=c("<div />",{"class":"motopress-property-image"}),d=c("<div />",{"class":"motopress-image-tools"});c("<div />",{"class":"motopress-default motopress-icon-trash motopress-icon-white"}).appendTo(d);a.hasOwnProperty("value")&&a.value||d.hide();var e=c("<div />",{"class":"motopress-thumbnail-crop"}),f=c("<img />",{src:CE.CtrlImage.thumbnail,"class":"motopress-thumbnail"}).appendTo(e);b.append(e,d);a.hasOwnProperty("disabled")&&"true"===a.disabled&&b.append(c("<div />",
{"class":"motopress-image-disabled"}));this.setAttrs(f,a,{});return b},createVideo:function(a,b){"undefined"===typeof b&&(b=null);var c=this.createInput(a,b,"text","video");this.setAttrs(c,a,{});return c},createCheckbox:function(a,b){"undefined"===typeof b&&(b=null);var c=this.createInput(a,b,"checkbox","checkbox-input motopress-property-input");this.setAttrs(c,a,{});return c},_createSelect:function(a,b,d){"undefined"===typeof b&&(b=null);var e=!1,f;switch(d){case "select":f="select";break;case "select-multiple":f=
"select-multiple",e=!0}d={};if(a.hasOwnProperty("disabled")){var g="true"===a.disabled;g&&(d.disabled=g)}b=c("<select />",{"class":"motopress-property-"+f+" motopress-bootstrap-dropdown motopress-dropdown-select",multiple:e?"multiple":!1,name:b});e=CE.CtrlTemplates.generateOptions(a.list);b.append(e);this.setAttrs(b,a,d);return b},generateOptions:function(a,b){var d=[],e;c.each(a,function(a,g){e={value:a,text:g};"undefined"!==typeof b&&b===a&&(e.selected="selected");d.push(c("<option />",e))});return d},
createSelect:function(a,b){return this._createSelect(a,b,"select")},createSelectMultiple:function(a,b){return this._createSelect(a,b,"select-multiple")},createColorSelect:function(a,b){"undefined"===typeof b&&(b=null);var d={};if(a.hasOwnProperty("disabled")){var e="true"===a.disabled;e&&(d.disabled=e)}var f=c("<select />",{"class":"motopress-property-select motopress-bootstrap-dropdown color-select motopress-dropdown-select",name:b}),g="undefined"===typeof a["class-prefix"]?"":a["class-prefix"];
c.each(a.list,function(a,b){var d="string"==typeof a?a.toLowerCase():"";f.append(c("<option />",{value:a,text:b}).attr("data-content",'<span class="color '+g+d+'"></span><span>'+b+"</span>"))});this.setAttrs(f,a,d);return f},createButton:function(a,b,d){"undefined"===typeof b&&(b=null);"undefined"!==typeof d&&d||(d="default");var e={};if(a.hasOwnProperty("disabled")){var f="true"===a.disabled;f&&(e.disabled=f)}f=a.hasOwnProperty("class")?" "+a["class"]:"";b=c("<button />",{"class":"motopress-property-button-"+
d+f,text:a.text,name:b});this.setAttrs(b,a,e);return b},createColorPicker:function(a,b){var d=this.createInput(a,b,"hidden"),d=c("<div />",{"class":"motopress-property-color-picker"}).append(d);this.setAttrs(d,a,{});return d},createSlider:function(a,b){var d=c("<div>",{"class":"motopress-property-slider"}),e=c("<span>",{type:"text","class":"motopress-property-slider-value",text:a["default"]}),f=c("<div>",{"class":"motopress-property-slider"});d.appendTo(f);e.appendTo(f);return f},createRadioButtons:function(a){var b=
this,d={};if(a.hasOwnProperty("disabled")){var e="true"===a.disabled;e&&(d.disabled=e)}var f=c("<div />",{"class":"motopress-property-radio-buttons"}),g=parent.MP.Utils.uniqid(),l=0;c.each(a.list,function(e,m){var k=c("<input />",{type:"radio",id:g+l,name:g,value:e});b.setAttrs(k,a,d);var q=c("<label />",{"for":g+l,text:m});f.append(k,q);l++});this.setAttrs(f,a,d);return f},createGroup:function(a){var b=c("<div />",{"class":"motopress-property-group"});c("<div />",{"class":"motopress-property-group-accordion"}).appendTo(b);
var d=c("<div />",{"class":"motopress-property-button-wrapper"}).appendTo(b),e=c.extend({},a);a.hasOwnProperty("disabled")&&"true"===a.disabled&&(delete e.disabled,c("<div />",{"class":"motopress-property-disabled"}).appendTo(d));this.createButton(e).appendTo(d);this.setAttrs(b,a,{});return b},createItem:function(a,b){var d=c("<span />",{"class":"motopress-property-group-accordion-item-label-text",text:a.label["default"]+" "+b}),e=c("<span />",{"class":"motopress-property-group-accordion-item-remove"}),
d=c("<h3 />",{"class":"motopress-property-group-accordion-item-label"}).append(d,e),e=c("<div />",{"class":"motopress-property-group-accordion-item-content"});return c("<div />",{"class":"motopress-property-group-accordion-item"}).append(d,e)},createMargin:function(a){var b=c("<table />",{"class":"motopress-property-margin"});c.each(a.sides,function(d,e){var f=c("<tr />",{"data-motopress-margin-side":e}).appendTo(b);c("<td />").append(c("<i />",{"class":a.classPrefix+"icon "+a.classPrefix+"icon-"+
e})).appendTo(f);c("<td />").append(c("<div />",{"class":a.classPrefix+"value",text:a["default"][d]})).appendTo(f);c.each(a.values,function(b,d){c("<td />").append(c("<div />",{"class":a.classPrefix+"values","data-motopress-margin-value":d,text:d})).appendTo(f)})});return b},createIconPicker:function(a,b){"undefined"===typeof b&&(b=null);var d={};if(a.hasOwnProperty("disabled")){var e="true"===a.disabled;e&&(d.disabled=e)}var e=c("<select />",{"class":"motopress-property-icon-picker",name:b}),f="";
for(b in a.list)var g=a.list[b],f=f+('<option value="'+g["class"]+'" data-value="'+b+'" >'+g.label+"</option>");e.get(0).innerHTML=f;this.setAttrs(e,a,d);return e},createDateTimePicker:function(a,b){var d=c("<div />",{"class":"motopress-property-datetime-picker"}),e=c("<div />",{"class":"form-group"}),f=c("<div />",{"class":"input-group date motopress-property-datetime-picker-wrapper "});a.readonly="readonly";var g=this.createInput(a,b,void 0,"datetime-picker-input form-control"),l=c("<span />",{"class":"input-group-addon motopress-property-datetime-picker-button"}),
h=c("<span />",{"class":"motopress-calendar-icon fa fa-calendar"}),l=l.append(h);e.append(f.append(g,l));d.append(e);this.setAttrs(d,a,{});return d},createStyleEditor:function(a,b){var d=c("<div />",{"class":"motopress-property-style-editor-wrapper"}),e=this.createInput({});d.append(e);this.setAttrs(d,a,{});return d},createComplexCtrl:function(a,b){var d=c("<div />",{"class":"motopress-property-complex"}),e=c("<div />",{"class":"motopress-property-inner-form"});d.append(e);this.setAttrs(d,a,{});return d},
setAttrs:function(a,b,d){"object"!==typeof b&&(b={});c.each(d,function(c,d){"undefined"!==typeof b[c]?a.attr(c,b[c]):null!==d&&a.attr(c,d)})}},{})}(jQuery),function(c){CE.Shortcode=can.Control.extend({listensTo:["render"],preloaderClass:"motopress-small-preload",isGrid:function(a){return a===CE.LeftBar.myThis.library.mp_grid.id},getChild:function(a){var b=a.children(".motopress-ce-child-detector");b.length||(b=a.children("div"));return b},getShortcodeName:function(a){return a.attr("data-motopress-shortcode")},
getShortcodeGroup:function(a){return a.attr("data-motopress-group")}},{group:null,isGrid:!1,shortcodeName:null,shortcodeLabel:null,shortcode:null,child:null,groupItemName:null,childName:null,activeParameter:"active",init:function(a,b){this.group=CE.Shortcode.getShortcodeGroup(a);this.isGrid=CE.Shortcode.isGrid(this.group);this.shortcodeName=CE.Shortcode.getShortcodeName(a);this.shortcodeLabel=CE.LeftBar.myThis.getShortcodeLabel(this.group,this.shortcodeName);this.childName=this.groupItemName=null;
this.activeParameter="active";this.shortcode=a;this.isGrid||(this.child=CE.Shortcode.getChild(this.shortcode))},setGroupItemName:function(a){this.groupItemName=a},setChildName:function(a){this.childName=a},setActiveParameter:function(a){this.activeParameter=a}})}(jQuery),function(c){CE.ControlsForm=can.Control.extend({},{form:null,init:function(a,b){this.beforeInit();this.formsMainCtrl=b.formsMainCtrl;this.detectForm();this.detectShortcode(b.hasOwnProperty("shortcode")?b.shortcode:!1);this.generate()},
beforeInit:function(){},detectForm:function(){this.form=this.element},detectShortcode:function(a){this.setShortcode(!1===a?this.formsMainCtrl.shortcode:a);this.shortcodeGroup=CE.Shortcode.getShortcodeGroup(this.shortcode);this.shortcodeName=CE.Shortcode.getShortcodeName(this.shortcode)},setShortcode:function(a){this.shortcode=a},generate:function(){var a=this.getAttrs(),b=this.getGeneralAttrs();b&&(a=this.generatePropertiesControls(b,a),this.form.append(a))},changeProperty:function(a){throw Error("Must be implemented by subclass!");
},getGeneralAttrs:function(){throw Error("Must be implemented by subclass!");},getAttrs:function(){throw Error("Must be implemented by subclass!");},save:function(){throw Error("Must be implemented by subclass!");},display:function(a){throw Error("Must be implemented by subclass!");},generatePropertiesControls:function(a,b){var d=this,e,f,g,l,h,m,k=[];c.each(a,function(a,n){e=parent.MP.Utils.uniqid();n.value=b.hasOwnProperty(a)&&b[a].hasOwnProperty("value")?b[a].value:n["default"];g=CE.CtrlTemplates.createLegend(n.legend);
l=CE.CtrlTemplates.createLabel(n.label);m=n.description;n.hasOwnProperty("additional_description")&&(m+=" "+n.additional_description);h=CE.CtrlTemplates.createDescription(m);var p=c("<div />",{"data-motopress-parameter":a,"data-motopress-disabled":n.disabled}),r={name:a,dependency:n.hasOwnProperty("dependency")?n.dependency:!1,disabled:"true"===n.disabled,isNew:d.formsMainCtrl.isNew,shortcode:d.formsMainCtrl.shortcode,formCtrl:d};switch(n.type){case "text":f=CE.CtrlTemplates.createInput(n,a);f.ce_ctrl_input(c.extend(r,
{}));p.append(g,l,f,h);break;case "text-hidden":f=CE.CtrlTemplates.createInput(n,a,"hidden");f.ce_ctrl_input(c.extend(r,{}));p.append(f);break;case "link":f=CE.CtrlTemplates.createLink(n,a);f.ce_ctrl_link(c.extend(r,{}));p.append(g,l,f,h);break;case "spinner":f=CE.CtrlTemplates.createInput(n,a,null,"spinner");f.ce_ctrl_spinner(c.extend(r,{min:n.min,max:n.max,step:n.step}));p.append(g,l,f,h);break;case "longtext":f=CE.CtrlTemplates.createTextarea(n);f.ce_ctrl_textarea(c.extend(r,{}));p.append(g,l,
f,h);break;case "longtext64":f=CE.CtrlTemplates.createTextarea(n);f.ce_ctrl_textarea64(c.extend(r,{}));p.append(g,l,f,h);break;case "longtext-table":f=CE.CtrlTemplates.createTextarea(n);f.ce_ctrl_textarea_table(c.extend(r,{}));p.append(g,l,f,h);break;case "longtext-tinymce":f=CE.CtrlTemplates.createTextareaTinyMCE(n);f.ce_ctrl_textarea_tinymce(c.extend(r,{currentShortcode:d.formsMainCtrl.element}));p.append(g,l,f,h);break;case "image":n.src=n.value;f=CE.CtrlTemplates.createImage(n);f.ce_ctrl_image(c.extend(r,
{autoOpen:n.autoOpen,pseudoRender:"parallax_image"!==a||"mp_row"!==d.shortcodeName&&"mp_row_inner"!==d.shortcodeName?!1:!0}));p.append(g,l,f,h);break;case "image-src":n.src=n.value;f=CE.CtrlTemplates.createImage(n);f.ce_ctrl_image(c.extend(r,{returnMode:"src",autoOpen:n.autoOpen,pseudoRender:"parallax_image"!==a||"mp_row"!==d.shortcodeName&&"mp_row_inner"!==d.shortcodeName?!1:!0}));p.append(g,l,f,h);break;case "audio":f=CE.CtrlTemplates.createMedia(n);var t=d.formsMainCtrl.child.attr("data-audio-title");
f.ce_ctrl_audio(c.extend(r,{audioTitle:t}));p.append(g,l,f,h);break;case "media":var t="undefined"===typeof n.returnMode||-1===c.inArray(n.returnMode,["id","url"])?"url":n.returnMode,u=n.value;f=CE.CtrlTemplates.createMedia(n);f.ce_ctrl_media(c.extend(r,{returnMode:t,value:u}));p.append(g,l,f,h);break;case "media-video":f=CE.CtrlTemplates.createMedia(n);f.ce_ctrl_media_video(c.extend(r,{}));p.append(g,l,f,h);break;case "multi-images":f=CE.CtrlTemplates.createButton(n,null,"default");f.ce_ctrl_image_slider(c.extend(r,
{autoOpen:n.autoOpen}));p.append(g,l,f,h);break;case "video":f=CE.CtrlTemplates.createVideo(n,a);f.ce_ctrl_video(c.extend(r,{}));p.append(g,l,f,h);break;case "checkbox":f=CE.CtrlTemplates.createCheckbox(n);f.ce_ctrl_checkbox(c.extend(r,{}));l.addClass("motopress-property-checkbox-label");p.append(g,f,l,h);break;case "group-checkbox":f=CE.CtrlTemplates.createCheckbox(n);f.ce_ctrl_group_checkbox(c.extend(r,{}));l.addClass("motopress-property-checkbox-label");p.append(g,f,l,h);break;case "select":f=
CE.CtrlTemplates.createSelect(n);f.ce_ctrl_select(c.extend(r,{}));p.append(g,l,f,h);break;case "select-multiple":f=CE.CtrlTemplates.createSelectMultiple(n);f.ce_ctrl_select_multiple(c.extend(r,{}));p.append(g,l,f,h);break;case "color-select":f=CE.CtrlTemplates.createColorSelect(n);f.ce_ctrl_select(c.extend(r,{}));p.append(g,l,f,h);break;case "editor-button":f=CE.CtrlTemplates.createButton(n,null,"default");f.ce_ctrl_editor_button(c.extend(r,{}));p.append(g,l,f,h);break;case "color-picker":f=CE.CtrlTemplates.createColorPicker(n,
a);f.ce_ctrl_color_picker(c.extend(r,{}));p.append(g,l,f,h);break;case "group":t=d.formsMainCtrl.shortcode.control();u=n.contains;t.setGroupItemName(a);t.setChildName(u);n.hasOwnProperty("activeParameter")&&n.activeParameter&&t.setActiveParameter(n.activeParameter);f=CE.CtrlTemplates.createGroup(n);var v=f.children(".motopress-property-group-accordion");f.ce_ctrl_group(c.extend(r,{currentSpan:d.formsMainCtrl.element,label:n.hasOwnProperty("items")?n.items.label:null,rules:n.hasOwnProperty("rules")?
n.rules:null,events:n.hasOwnProperty("events")?n.events:null}));d.formsMainCtrl.shortcode.attr("data-motopress-wrap-render","true");var s=f.control();d.formsMainCtrl.shortcode.find("[data-motopress-shortcode]").each(function(a,b){var e=CE.CtrlTemplates.createItem(n.items,a);s.addChildFormCtrl(new CE.SettingsControlsChildForm(e,{parentFormCtrl:d,formsMainCtrl:d.formsMainCtrl,shortcode:c(b),groupCtrl:s}));v.append(e)});p.attr("data-motopress-grouped","true");p.append(g,l,f,h);break;case "slider":f=
CE.CtrlTemplates.createSlider(n);f.ce_ctrl_slider(c.extend(r,{min:"undefined"===typeof n.min||isNaN(n.min)?0:n.min,max:"undefined"===typeof n.max||isNaN(n.max)?100:n.max,step:"undefined"===typeof n.step||isNaN(n.step)?1:n.step,value:n.value}));p.append(g,l,f,h);break;case "radio-buttons":f=CE.CtrlTemplates.createRadioButtons(n);f.ce_ctrl_radio_buttons(c.extend(r,{value:n.value}));p.append(g,l,f,h);break;case "icon-picker":f=CE.CtrlTemplates.createIconPicker(n);f.ce_ctrl_icon_picker(c.extend(r,{value:n.value}));
p.append(g,l,f,h);break;case "datetime-picker":t="undefined"===typeof n.returnMode?"YYYY-MM-DD H:m:s":n.returnMode;u="undefined"===typeof n.displayMode||-1===c.inArray(n.displayMode,["date","datetime"])?"datetime":n.displayMode;f=CE.CtrlTemplates.createDateTimePicker(n);f.ce_ctrl_date_time_picker(c.extend(r,{value:n.value,returnMode:t,displayMode:u}));p.append(g,l,f,h);break;case "margin":f=CE.CtrlTemplates.createMargin(n);f.ce_ctrl_margin(c.extend(r,{margin:n}));p.append(g,l,f,h);break;case "select2":f=
CE.CtrlTemplates.createInput(n,a);f.ce_ctrl_select2(c.extend(r,{}));p.append(g,l,f,h);break;case "style_editor":f=CE.CtrlTemplates.createInput(n,a);f.ce_ctrl_style_editor(c.extend(r,{}));p.append(g,l,f,h);break;case "gradient-picker":f=CE.CtrlTemplates.createComplexCtrl(n,a),f.ce_ctrl_gradient(c.extend(r,{})),p.append(g,l,f,h)}f.control().afterInit();k.push(p);if(n.hasOwnProperty("disabled")&&"true"===n.disabled){var x=null,x="group"===n.type?f.find("> .motopress-property-button-wrapper > .motopress-property-disabled"):
c("<div />",{"class":"motopress-property-disabled"}).appendTo(p);x.data("popover")||x.mppopover({placement:"top",trigger:"manual",container:p,content:localStorage.getItem("CELiteTooltipText")});x.on("click",function(){c(this).mppopover("show");var a=setTimeout(function(){x.mppopover("hide");clearTimeout(a)},2E3)})}f.addClass("motopress-controls");f.attr("id",e);l.attr("for",e)});return k},resolveDependencies:function(){var a=this,b,d;c.each(this.getGeneralAttrs(),function(c,f){b=a.getCtrlByName(c);
b.dependency&&(d=a.getCtrlByName(b.dependency.parameter),d.name===b.dependency.parameter&&(b.isShouldBeHiddenByDependency()?b.hide():b.show()))})},getParameterElByName:function(a){a=this.form.find('> [data-motopress-parameter="'+a+'"] > .motopress-controls, > [data-motopress-parameter="'+a+'"] > :not(".motopress-property-legend, .motopress-property-label, .motopress-property-description, hr") > .motopress-controls');return a.length?a:!1},getCtrlByName:function(a){return(a=this.getParameterElByName(a))?
a.control():!1}})}(jQuery),function(c){CE.ControlsForm("CE.SettingsControlsForm",{},{init:function(a,b){this._super(a,b)},getGeneralAttrs:function(){return CE.LeftBar.myThis.getParametersAttrs(this.shortcodeGroup,this.shortcodeName)},getAttrs:function(){var a=this.shortcode.attr("data-motopress-parameters");return a?c.parseJSON(a):!1},setAttrs:function(a){this.shortcode.attr("data-motopress-parameters",JSON.stringify(a))},setDefaultAttrs:function(a){if(null!==a){a=c.parseJSON(a);var b=this.getGeneralAttrs(),
d=this;c.each(a,function(a,c){"undefined"!==typeof c.value&&c.value||(b[a].hasOwnProperty("saveInContent")&&"true"===b[a].saveInContent?d.shortcode.attr("data-motopress-content",b[a]["default"]):c.value=b[a]["default"])});this.setAttrs(a);return JSON.stringify(a)}return a},regenerateGroupControl:function(a){var b=this.getAttrs();if(b){var c=this.getGeneralAttrs(void 0),e={};e[a]=c[a];b=this.generatePropertiesControls(e,b);this.form.append(b)}b=this.form.children('[data-motopress-parameter="'+a+'"]:first');
a=this.form.children('[data-motopress-parameter="'+a+'"]:last');b.replaceWith(a)},changeProperty:function(a){this.save(a)},save:function(a){if("undefined"!==typeof a&&"undefined"!==typeof a.name){var b=this.getAttrs();if(b){var c=this.getGeneralAttrs()[a.name],e=a.get();c.hasOwnProperty("saveInContent")&&"true"===c.saveInContent?this.shortcode.attr("data-motopress-content",e):b[a.name].value=void 0!==e&&"string"===typeof e?e.replace(new RegExp(/"/g),"'").replace(new RegExp(/[\[\]]/g),""):e;this.setAttrs(b);
this.formsMainCtrl.renderShortcode();if("mp_row"===this.shortcodeName||"mp_row_inner"===this.shortcodeName)switch(a.name){case "bg_media_type":this.setRowMediaBG(e);break;case "parallax_image":case "parallax_bg_size":this.setRowParallaxBGSize();break;case "bg_video_youtube":case "bg_video_youtube_cover":this.clearRowMediaBG(this.shortcode);this.renderYoutubeBG();break;case "bg_video_webm":case "bg_video_mp4":case "bg_video_ogg":case "bg_video_cover":this.clearRowMediaBG(this.shortcode);this.renderHTML5VideoBG();
break;case "stretch":(a=this.getStretchClassByValue(e))?this.setRowWidth(a):this.clearRowWidth();parent.MP.Editor.triggerIfr("Resize");break;case "width_content":a=this.getContentWidthClassByValue(e);this.setRowWidth(a);parent.MP.Editor.triggerIfr("Resize");break;case "full_height":"true"===e?this.shortcode.addClass("mp-row-fullheight"):this.shortcode.removeClass("mp-row-fullheight"),parent.MP.Editor.triggerIfr("Resize")}}}},getStretchClassByValue:function(a){var b="";switch(a){case "full":a=this.getCtrlByName("width_content").get();
b=this.getContentWidthClassByValue(a);break;case "fixed":b="mp-row-fixed-width"}return b},getContentWidthClassByValue:function(a){var b="";switch(a){default:b="mp-row-fullwidth";break;case "full":b="mp-row-fullwidth-content";break;case "fixed":b="mp-row-fixed-width-content"}return b},display:function(a,b,d){"undefined"===typeof b&&(CE.Dialog.myThis.settingsTab.children(".motopress-settings-forms").detach(),CE.Dialog.myThis.settingsTab.html(this.form));var e=this.getAttrs();if(e){var f=this,g=null,
l=null,h=this.getGeneralAttrs();if("undefined"!==typeof b){var m={};m[b]=h[b];h=m}var k=null,q=null;c.each(h,function(b,m){g=f.getParameterElByName(b);g.hasClass("motopress-property-group")&&(d&&g.trigger("change",a),g.find(".motopress-property-group-accordion-item").each(function(){c(this).control().display(a)}),g.trigger("render",a));q=g.control();m.hasOwnProperty("saveInContent")&&"true"===m.saveInContent?"undefined"!==typeof f.shortcode.attr("data-motopress-content")&&(l=f.shortcode.attr("data-motopress-content").replace(/\[\]/g,
"[")):l=e[q.name].value;k=h[q.name]["default"];q.set(l,k,a);g.trigger("customize")});this.resolveDependencies()}},renderYoutubeBG:function(){var a=this,b="undefined"!==typeof this.shortcode.attr("data-motopress-parameters")?this.shortcode.attr("data-motopress-parameters"):null,b=c.parseJSON(b);c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"text",data:{action:"motopress_ce_render_youtube_bg",nonce:parent.motopressCE.nonces.motopress_ce_render_youtube_bg,postID:parent.motopressCE.postID,
bg_video_youtube:b.bg_video_youtube.value,bg_video_youtube_cover:b.bg_video_youtube_cover.value,bg_video_youtube_repeat:b.bg_video_youtube_repeat.value,bg_video_youtube_mute:b.bg_video_youtube_mute.value},success:function(b){a.shortcode.addClass("mp-row-video").children(".motopress-row-helper").before(b);mpInitYouTubePlayers(a.shortcode.children(".mp-video-container").find(".mp-youtube-video"));mpFixBackgroundVideoSize(a.shortcode.children(".mp-video-container"))},error:function(a){console.log(a)}})},
renderHTML5VideoBG:function(){var a=this,b="undefined"!==typeof this.shortcode.attr("data-motopress-parameters")?this.shortcode.attr("data-motopress-parameters"):null,b=c.parseJSON(b);c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"text",data:{action:"motopress_ce_render_video_bg",nonce:parent.motopressCE.nonces.motopress_ce_render_video_bg,postID:parent.motopressCE.postID,bg_video_mp4:b.bg_video_mp4.value,bg_video_webm:b.bg_video_webm.value,bg_video_ogg:b.bg_video_ogg.value,bg_video_cover:b.bg_video_cover.value,
bg_video_mute:b.bg_video_mute.value,bg_video_repeat:b.bg_video_repeat.value},success:function(b){a.shortcode.addClass("mp-row-video").children(".motopress-row-helper").before(b);mpFixBackgroundVideoSize(a.shortcode.children(".mp-video-container"))},error:function(a){console.log(a)}})},setRowWidth:function(a){this.clearRowWidth();this.shortcode.addClass(a)},clearRowWidth:function(){this.shortcode.removeClass("mp-row-fullwidth mp-row-fullwidth-content mp-row-fixed-width mp-row-fixed-width-content");
this.shortcode.css({width:"","padding-left":"","margin-left":"","padding-right":"","margin-right":""})},setRowMediaBG:function(a){this.clearRowMediaBG(this.shortcode);switch(a){case "video":this.renderHTML5VideoBG();break;case "youtube":this.renderYoutubeBG();break;case "parallax":a=this.form.find('[data-motopress-parameter="parallax_image"] [data-full-src]').length?this.form.find('[data-motopress-parameter="parallax_image"] [data-full-src]').attr("data-full-src"):null,this.shortcode.addClass("motopress-row-parallax").attr("data-stellar-background-ratio",
.5),a&&this.shortcode.css("background-image","url('"+a+"')"),this.setRowParallaxBGSize(),c.stellar("refresh")}},clearRowMediaBG:function(a){a.children(".mp-video-container").remove();a.removeClass("mp-row-video motopress-row-parallax").css("background-image","").css("background-position","").css("background-size","");a.removeAttr("data-stellar-background-ratio").removeData("stellarBackgroundIsActive stellarBackgroundRatio stellarBackgroundStartingLeft stellarBackgroundStartingTop");c.stellar("refresh")},
setRowParallaxBGSize:function(){var a=this.getCtrlByName("parallax_bg_size").get();this.shortcode.css("background-size",void 0===a||"normal"===a?"":a)}})}(jQuery),function(c){CE.SettingsControlsForm("CE.SettingsControlsChildForm",{},{init:function(a,b){this._super(a,b);this.parentFormCtrl=b.parentFormCtrl;this.groupCtrl=b.groupCtrl},changeProperty:function(a){this.save(a);this.groupCtrl.element.trigger("change")},setDefaultAttrs:function(a){if(null!==a){a=c.parseJSON(a);var b=this.getGeneralAttrs(),
d=this;c.each(a,function(a,c){"undefined"!==typeof c.value&&c.value||("mp_tab"===d.shortcodeName&&"id"===a?c.value=parent.MP.Utils.uniqid():b[a].hasOwnProperty("saveInContent")&&"true"===b[a].saveInContent?d.shortcode.attr("data-motopress-content",b[a]["default"]):c.value=b[a]["default"])});this.setAttrs(a);return JSON.stringify(a)}return a},detectForm:function(){this.form=this.element.children(".motopress-property-group-accordion-item-content")},save:function(a){if("undefined"!==typeof a&&"undefined"!==
typeof a.name){var b=this.getAttrs();if(b){var c=this.getGeneralAttrs()[a.name],e=a.get();c.hasOwnProperty("saveInContent")&&"true"===c.saveInContent?this.shortcode.attr("data-motopress-content",e):b[a.name].value=void 0!==e&&"string"===typeof e?e.replace(new RegExp(/"/g),"'").replace(new RegExp(/[\[\]]/g),""):e;this.setAttrs(b)}}},display:function(a,b){var d=this.getAttrs();if(d){var e=this,f=null,g=this.getGeneralAttrs();if("undefined"!==typeof b){var l={};l[b]=g[b];g=l}var h=null,m=null;c.each(g,
function(b,c){m=e.getCtrlByName(b);c.hasOwnProperty("saveInContent")&&"true"===c.saveInContent?"undefined"!==typeof e.shortcode.attr("data-motopress-content")&&(f=e.shortcode.attr("data-motopress-content").replace(/\[\]/g,"[")):f=d[m.name].value;"id"===b&&"mp_accordion_item"===e.shortcodeName&&"undefined"===typeof f&&(f=e.shortcode.find(".motopress-accordion-item").attr("id"));h=g[m.name]["default"];m.set(f,h,a)});this.resolveDependencies()}}})}(jQuery),function(c){CE.ControlsForm("CE.StyleControlsForm",
{},{init:function(a,b){this._super(a,b)},changeProperty:function(a){this.save(a);c("body").trigger("MPCEObjectStyleChanged",{objElement:this.shortcode,objName:this.shortcodeName})},getGeneralAttrs:function(){return CE.LeftBar.myThis.getStyleAttrs(this.shortcodeGroup,this.shortcodeName)},getAttrs:function(){var a=this.shortcode.attr("data-motopress-styles");return a?(a=c.parseJSON(a),!this.formsMainCtrl.isGrid&&a.hasOwnProperty("margin")&&c.isEmptyObject(a.margin)&&(a=this.fixMarginValue(a)),a):!1},
fixMarginValue:function(a){if(this.formsMainCtrl.child.length){var b=this.getGeneralAttrs(),d=b.margin["default"].slice(),e=this.formsMainCtrl.child.prop("class").split(" ").filter(function(a){return b.margin.regExp.test(a)});e.length&&(c.each(e,function(a,e){var l=e.match(b.margin.regExp),h=l[1],m=parseInt(l[2]);"undefined"===typeof h?c.each(d,function(a,c){m!==b.margin["default"][a]&&(d[a]=m)}):(l=c.inArray(h,b.margin.sides),-1!==l&&(d[l]=m))}),a.margin.value=d.join(","),this.setAttrs(a),a=this.getAttrs())}return a},
setAttrs:function(a){this.shortcode.attr("data-motopress-styles",JSON.stringify(a))},setDefaultAttrs:function(a){a="undefined"===typeof a?this.getAttrs():c.parseJSON(a);var b=CE.LeftBar.myThis.getStyleAttrs(this.shortcodeGroup,this.shortcodeName);c.each(a,function(a,e){if("undefined"===typeof e.value||!e.value){var f=b[a]["default"];switch(b[a].type){case "margin":var g=!0;c.each(b[a]["default"],function(c,e){e!==b[a].values[0]&&(g=!1)});f=g?"":f.join(",");break;case "select2":var l=[];b.mp_style_classes.hasOwnProperty("default")&&
c.each(b.mp_style_classes["default"],function(a,b){l.push(b)});f=l.join(" ")}e.value=f}});this.setAttrs(a);return JSON.stringify(a)},display:function(a){CE.Dialog.myThis.styleTab.children(".motopress-style-forms").detach();CE.Dialog.myThis.styleTab.html(this.form);var b=this.getAttrs();if(b){var d=this,e=null,f=null,g=null,l=null,h=this.getGeneralAttrs();c.each(b,function(c,k){f=d.getParameterElByName(c);e=f.control();g=b[e.name].value;l=h[e.name]["default"];e.set(g,l,a);f.trigger("customize")});
this.resolveDependencies()}},save:function(a){var b=this.getAttrs();if(b)if("undefined"===typeof a&&this.formsMainCtrl.isGrid){var d=this;c.each(b,function(c){a=d.getCtrlByName(c);d._save(b,a,!1)})}else this._save(b,a),CE.Resizer.myThis.updateAllHandles(),c(window).trigger("resize")},getTargetElement:function(a){var b=null;this.formsMainCtrl.isGrid?b=this.shortcode:this.formsMainCtrl.child.length&&(b=this.formsMainCtrl.child);"mp_style_classes"!==a.name&&"mp_custom_style"!==a.name||!CE.LeftBar.myThis.library[this.shortcodeGroup].objects[this.shortcodeName].styles[a.name].hasOwnProperty("selector")||
(a=CE.LeftBar.myThis.library[this.shortcodeGroup].objects[this.shortcodeName].styles[a.name].selector,!1===a?b=null:a.length&&(b=b.find(a)));return b},_save:function(a,b,d){"undefined"===typeof d&&(d=!0);var e=a[b.name].value,f=d?b.get():e;d&&(a[b.name].value=f,this.setAttrs(a));a=this.getTargetElement(b);switch(b.name){case "margin":var g=b.getClasses(e);g.length&&(e=g);b=b.getClasses(f);b.length&&(f=b);break;case "mp_style_classes":if(!d&&!c.isEmptyObject(b.options.style.basic)){var l="";c.isArray(b.options.style.basic)?
c.each(b.options.style.basic,function(a,b){l+=b["class"]+" "}):l=b.options.style.basic["class"]+" ";f=l+f}}null!==a&&a.length&&(d&&a.removeClass(e),a.addClass(f))}})}(jQuery),function(c){CE.ControlsForm("CE.StyleEditorControlsForm",{},{emptyStyleValue:"",editedStyleObj:null,loadedAttrs:{},styleEditorCtrl:null,propertiesWrapper:null,statesWrapper:null,actionsWrapper:null,state:null,beforeInit:function(){this._super();this.generateStatesWrapper();this.generatePropertiesWrapper();this.generateActionsWrapper()},
init:function(a,b){this.styleEditorCtrl=b.styleEditorCtrl;this._super(a,b)},generateStatesWrapper:function(){var a=this;this.statesWrapper=c("<div />",{"class":"motopress-ce-style-editor-states-wrapper"});this.statesWrapper.append(c("<a />",{href:"#","data-state":"up",title:localStorage.getItem("CEDesktopStyle")}),c("<a />",{href:"#","data-state":"tablet",title:localStorage.getItem("CETabletStyle")}),c("<a />",{href:"#","data-state":"mobile",title:localStorage.getItem("CEMobileStyle")}),c("<a />",
{href:"#","data-state":"hover",title:localStorage.getItem("CEHoverStyle")}));this.statesWrapper.children("a").on("click",function(b){b.preventDefault();a.setState(c(this).attr("data-state"))});this.element.append(this.statesWrapper)},generatePropertiesWrapper:function(){this.propertiesWrapper=c("<div />",{"class":"motopress-ce-style-editor-properties-wrapper"});this.element.append(this.propertiesWrapper)},generateActionsWrapper:function(){var a=this;this.actionsWrapper=c("<div />",{"class":"motopress-ce-style-editor-actions-wrapper"});
var b=c("<button />",{"class":"motopress-ce-style-editor-apply-button btn",text:localStorage.getItem("CEApply")}).on("click",function(b){b.preventDefault();a.confirm()}),d=c("<ul />",{"class":"dropdown-menu"});c.each(this.generateActionButtons(),function(a,b){var g=c("<li />");"undefined"!==typeof b.data("mpce-parent-classes")&&g.addClass(b.data("mpce-parent-classes"));g.append(b).appendTo(d)});b=c("<div />",{"class":"btn-group motopress-bootstrap-dropdown motopress-dropdown-button dropup"}).append(b,
'<button class="dropdown-toggle btn" data-toggle="dropdown"><span class="caret"></span></button>',d);this.actionsWrapper.append(b);this.element.append(this.actionsWrapper);b.on("keydown",function(a){a.stopPropagation()})},generateActionButtons:function(){var a=this;return[c("<a />",{href:"#","class":"motopress-ce-style-editor-cancel-button",text:localStorage.getItem("CECancel")}).on("click",function(b){b.preventDefault();a.cancel()})]},generate:function(){var a=this.getGeneralAttrs(),a=this.generatePropertiesControls(a,
{});this.form.append(a)},detectForm:function(){this.form=this.propertiesWrapper},display:function(a){this.attachForm();this.highlightState("up");this.rememberSettings();a=this.getStateAttrs("up");this.fillForm(a,"customize");this.resolveDependencies();this.show()},attachForm:function(){CE.Dialog.myThis.styleEditorContainer.children().detach();CE.Dialog.myThis.styleEditorContainer.html(this.element)},getState:function(){return this.state},setState:function(a){this.highlightState(a);this.fillForm(this.getStateAttrs(a),
!1)},highlightState:function(a){this.statesWrapper.children("a").removeClass("motopress-ce-style-editor-state-active");this.statesWrapper.children('[data-state="'+a+'"]').addClass("motopress-ce-style-editor-state-active");this.state=a;this.styleEditorCtrl.setStatePreview(a)},setEditedStyleObj:function(a){this.editedStyleObj=a},rememberSettings:function(){this.loadedAttrs=this.editedStyleObj.getSettings()},getFormValues:function(){var a,b,d={},e=this,f=this.getGeneralAttrs();c.each(f,function(c,f){a=
e.getCtrlByName(c);a.isHided()||(b=a.get(),b=e.filterValue(c,b),b!==e.emptyStyleValue&&(d[c]=b))});d.hasOwnProperty("background-image-type")&&"none"!==d["background-image-type"]&&(d.hasOwnProperty("background-gradient")||d.hasOwnProperty("background-image")||delete d["background-image-type"]);return d},getEmptyValues:function(){var a=this.getGeneralAttrs(),b=this;return c.map(a,function(){return b.emptyStyleValue})},getCleanFormValues:function(a){var b=this.getFormValues();a=this.getInheritValues(a);
var d=parent.MP.Utils.getObjectChanges(a,b),e=this;c.each(d,function(a,c){e.preventLossDependencyValues(a,d,b)});return d},preventLossDependencyValues:function(a,b,c){a=this.getCtrlByName(a);a.dependency&&a.dependency.hasOwnProperty("needDependenceValue")&&a.dependency.needDependenceValue&&!b.hasOwnProperty(a.dependency.parameter)&&(b[a.dependency.parameter]=c[a.dependency.parameter],this.preventLossDependencyValues(a.dependency.parameter,b,c))},filterValue:function(a,b){switch(a){case "padding-top":case "padding-bottom":case "padding-left":case "padding-right":case "border-top-width":case "border-bottom-width":case "border-left-width":case "border-right-width":case "border-top-left-radius":case "border-top-right-radius":case "border-bottom-left-radius":case "border-bottom-right-radius":b=
b.replace(/[^0-9]/gi,"");break;case "margin-top":case "margin-bottom":case "margin-left":case "margin-right":b=b.replace(/[^0-9-]/gi,"");break;case "background-position-x":case "background-position-y":null===b&&(b="")}return b},fillForm:function(a,b){var d=this,e,f,g,l,h=this.getGeneralAttrs();c.each(h,function(c,k){e=d.getParameterElByName(c);f=e.control();l=h[f.name].hasOwnProperty("default")?h[f.name]["default"]:d.emptyStyleValue;g=a.hasOwnProperty(c)?a[c]:l;f.set(g,l,!1);b&&e.trigger(b)});this.resolveDependencies()},
changeProperty:function(a){this.save();this.styleEditorCtrl.element.trigger("change")},save:function(){var a=this.getState(),b=this.getCleanFormValues(a);this.editedStyleObj.updateState(a,b)},getTitle:function(){return""},show:function(){CE.Dialog.myThis.setMode("style-editor");this.propertiesWrapper.scrollTop(0)},hide:function(){CE.Dialog.myThis.setMode("tabs");this.styleEditorCtrl.unsetStatePreview()},cancel:function(){this.editedStyleObj.update(this.loadedAttrs);this.styleEditorCtrl.element.trigger("change");
this.hide()},confirm:function(){this.styleEditorCtrl.element.trigger("change");this.hide()}})}(jQuery),function(c){CE.StyleEditorControlsForm("CE.PrivateStyleControlsForm",{},{presetStyleObj:null,init:function(a,b){this._super(a,b);this.editedStyleObj=b.editedStyleObj},setPresetStyleObj:function(a){this.presetStyleObj=a},generateActionButtons:function(){var a=this,b=this._super(),d=[c("<a />",{href:"#","class":"motopress-ce-style-editor-save-button",text:localStorage.getItem("CESaveAs")}).on("click",
function(b){b.preventDefault();a.saveAsPreset()}),c("<a />",{href:"#","class":"motopress-ce-style-editor-clear-button",text:localStorage.getItem("CEClear")}).on("click",function(b){b.preventDefault();a.clear()})];return c.merge(d,b)},getGeneralAttrs:function(){return CE.LeftBar.myThis.getPrivateStyleAttrs(this.shortcodeGroup,this.shortcodeName)},getPrivateStateAttrs:function(a){return this.editedStyleObj.getStateSettings(a)},getPresetStateAttrs:function(a){return null!==this.presetStyleObj?this.presetStyleObj.getStateSettings(a):
{}},getStateAttrs:function(a){"undefined"===typeof a&&(a=this.getState());var b={};switch(a){case "up":c.extend(b,this.getPresetStateAttrs("up"),this.getPrivateStateAttrs("up"));break;case "hover":c.extend(b,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("hover"),this.getPrivateStateAttrs("up"),this.getPrivateStateAttrs("hover"));break;case "tablet":c.extend(b,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPrivateStateAttrs("up"),this.getPrivateStateAttrs("tablet"));
break;case "mobile":c.extend(b,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPresetStateAttrs("mobile"),this.getPrivateStateAttrs("up"),this.getPrivateStateAttrs("tablet"),this.getPrivateStateAttrs("mobile"))}return b},resetForm:function(){this.fillForm(this.getStateAttrs(),!1);this.styleEditorCtrl.element.trigger("change")},getInheritValues:function(a){var b={},d=this.getEmptyValues();switch(a){case "up":c.extend(b,d,this.getPresetStateAttrs("up"));break;case "hover":c.extend(b,
d,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("hover"),this.getPrivateStateAttrs("up"));break;case "tablet":c.extend(b,d,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPrivateStateAttrs("up"));break;case "mobile":c.extend(b,d,this.getPresetStateAttrs("up"),this.getPresetStateAttrs("tablet"),this.getPresetStateAttrs("mobile"),this.getPrivateStateAttrs("tablet"),this.getPrivateStateAttrs("up"))}return b},saveAsPreset:function(a,b){var d=this;c.when(CE.StyleEditor.myThis.presetSaveModal.showModal(this.editedStyleObj,
this.presetStyleObj)).then(function(a){d.styleEditorCtrl.selectPreset(a);d.clear();d.rememberSettings();d.styleEditorCtrl.refresh();CE.Dialog.myThis.updateTitle()})},clear:function(){this.editedStyleObj.clear();this.resetForm()},getTitle:function(){var a="Element Style";null!==this.presetStyleObj&&(a+=" (inherit from "+this.presetStyleObj.getLabel()+")");return a},show:function(){this._super()},hide:function(){this._super()}})}(jQuery),function(c){CE.StyleEditorControlsForm("CE.PresetStyleControlsForm",
{},{generateActionButtons:function(){var a=this,b=this._super(),d=[c("<a />",{href:"#","class":"motopress-ce-style-editor-rename-button",text:localStorage.getItem("CERename")}).on("click",function(b){b.preventDefault();a.renamePreset()}),c("<a />",{href:"#","class":"motopress-ce-style-editor-delete-button",text:localStorage.getItem("CEDelete")}).on("click",function(b){b.preventDefault();a.deletePreset()})];return c.merge(d,b)},getGeneralAttrs:function(){return CE.Style.getStyleEditorProps()},getAttrs:function(){return this.editedStyleObj.getSettings()},
getStateAttrs:function(a){var b={};switch(a){case "up":c.extend(b,this.editedStyleObj.getStateSettings("up"));break;case "hover":c.extend(b,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("hover"));break;case "tablet":c.extend(b,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("tablet"));break;case "mobile":c.extend(b,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("tablet"),this.editedStyleObj.getStateSettings("mobile"))}return b},
getInheritValues:function(a){var b={},d=this.getEmptyValues();switch(a){case "up":c.extend(b,d);break;case "hover":c.extend(b,d,this.editedStyleObj.getStateSettings("up"));break;case "tablet":c.extend(b,d,this.editedStyleObj.getStateSettings("up"));break;case "mobile":c.extend(b,d,this.editedStyleObj.getStateSettings("up"),this.editedStyleObj.getStateSettings("tablet"))}return b},renamePreset:function(a,b){var c=localStorage.getItem("CERenamePresetPrompt").replace("%presetLabel%",this.editedStyleObj.getLabel()),
c=prompt(c,this.editedStyleObj.getLabel());null!==c&&(c=c.trim(),""!==c?(this.editedStyleObj.updateLabel(c),CE.Dialog.myThis.updateTitle(),this.styleEditorCtrl.refresh()):(parent.MP.Flash.setFlash(localStorage.getItem("CERenamePresetEmptyError"),"error"),parent.MP.Flash.showMessage()))},deletePreset:function(a,b){var c=localStorage.getItem("CEDeletePresetConfirm").replace("%presetLabel%",this.editedStyleObj.getLabel());confirm(c)&&(CE.StyleEditor.myThis.deletePreset(this.editedStyleObj.getClassName()),
this.styleEditorCtrl.refresh(),this.hide())},getTitle:function(){return'Preset "'+this.editedStyleObj.getLabel()+'"'}})}(jQuery),function(c){CE.ControlsForm("CE.ControlsSubForm",{},{parentPropertyCtrl:null,init:function(a,b){this.parentPropertyCtrl=b.parentPropertyCtrl;this._super(a,b)},getGeneralAttrs:function(){return this.parentPropertyCtrl.getParameters()},getAttrs:function(){return{}},save:function(){this.parentPropertyCtrl.element.trigger("change")},display:function(a){var b=this;a=this.getGeneralAttrs();
var d;c.each(a,function(a,c){d=b.getParameterElByName(a);d.trigger("customize")})},changeProperty:function(a){this.save()},set:function(a){var b=this.getGeneralAttrs(),d,e,f=this;c.each(b,function(b,c){d=f.getCtrlByName(b);e=a.hasOwnProperty(b)?a[b]:"";d.set(e)});this.resolveDependencies()},get:function(){var a,b,d={},e=this,f=this.getGeneralAttrs();c.each(f,function(c,f){a=e.getCtrlByName(c);a.isHided()||(b=a.get(),d[c]=b)});return d}})}(jQuery),function(c){CE.Shortcode("CE.Controls",{},{settingsForms:null,
styleForms:null,settingsCtrl:null,stylesCtrl:null,isNew:!1,init:function(a,b){this._super(a,b);this.isNew=b.isNew;this.settingsForms=c("<div />",{"class":"motopress-settings-forms"});this.settingsCtrl=new CE.SettingsControlsForm(this.settingsForms,{formsMainCtrl:this});this.styleForms=c("<div />",{"class":"motopress-style-forms"});this.stylesCtrl=new CE.StyleControlsForm(this.styleForms,{formsMainCtrl:this})},render:function(a){if(!this.isGrid){if(a||"undefined"===typeof a)CE.Resizer.myThis.updateBottomInHandleMiddle(),
CE.Resizer.myThis.updateHandle(),CE.Resizer.myThis.updateHandleMiddle();CE.Resizer.myThis.updateSplitterHeight(this.element,"render");this.shortcode.find("a").attr("tabindex",-1)}},renderShortcode:function(a){if(!this.isGrid){switch(typeof a){case "undefined":a="updated";break;case "boolean":a=a?"created":"updated"}var b=this,d=this.element.closest(".motopress-clmn").find("."+CE.DragDrop.myThis.helper.attr("class")).first().children("."+CE.DragDrop.myThis.dragHandle.attr("class"));d.addClass(CE.Shortcode.preloaderClass);
var e=this.element.attr("data-motopress-close-type"),f="undefined"!==typeof this.element.attr("data-motopress-wrap-render")?this.element.attr("data-motopress-wrap-render"):null,g="undefined"!==typeof this.element.attr("data-motopress-parameters")?this.element.attr("data-motopress-parameters"):null,l="undefined"!==typeof this.element.attr("data-motopress-styles")?this.element.attr("data-motopress-styles"):null;"created"===a&&g&&(g=this.settingsCtrl.setDefaultAttrs(g));"created"===a&&l&&(l=this.stylesCtrl.setDefaultAttrs(l));
var h="undefined"!==typeof this.element.attr("data-motopress-content")?this.element.attr("data-motopress-content").replace(/\[\]/g,"["):null;"undefined"!==typeof this.element.attr("data-motopress-active-item")&&(g=c.parseJSON(g),g[this.activeParameter]={value:this.element.attr("data-motopress-active-item")},g=JSON.stringify(g));c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"html",data:{action:"motopress_ce_render_shortcode",nonce:parent.motopressCE.nonces.motopress_ce_render_shortcode,
postID:parent.motopressCE.postID,closeType:e,shortcode:b.shortcodeName,wrapRender:f,parameters:g,styles:l,content:h},success:function(e){var f=c(e).find(".motopress-ce-private-styles-updates-wrapper").andSelf().filter(".motopress-ce-private-styles-updates-wrapper").children("style");CE.ShortcodePrivateStyle.addRenderedStyleTags(f);e=c(e).find(".motopress-ce-rendered-content-wrapper").andSelf().filter(".motopress-ce-rendered-content-wrapper").children();f=b.element.closest(".motopress-clmn");if(!f.closest(".motopress-row").parent(".motopress-content-wrapper").length){var f=
f.closest(".motopress-row").nextAll(".motopress-handle-middle-in:last"),g=parseInt(f.css("min-height"));f.height(g)}c(".motopress-content-wrapper > .motopress-handle-middle-in:last").height("");b.element.html(e);b.child=CE.Shortcode.getChild(b.shortcode);e=b.shortcode.find("img");var h=e.length,l=0;if(h)e.on("load",function(){l++;l===h&&b.element.trigger("render")});e=CE.LeftBar.myThis.getParametersAttrs(b.group,b.shortcodeName);var r;b.groupItemName&&(r=b.settingsForms.find(".motopress-property-group").control(),
e=e[b.groupItemName],"created"===a&&(e.hasOwnProperty("items")&&e.items.hasOwnProperty("count")&&0<e.items.count&&b.settingsForms.find('> [data-motopress-parameter="'+b.groupItemName+'"] > .motopress-property-group > .motopress-property-button-wrapper > .motopress-property-button-default').trigger("click",e.items.count),r.dependency&&b.settingsForms.find('[data-motopress-parameter="'+r.dependency.parameter+'"] .motopress-controls').trigger("change",!1)),r.reassignShortcodes());"duplicated"===a||"created"===
a?c("body").trigger("MPCEObjectCreated",[b.element,b.shortcodeName]):c("body").trigger("MPCEObjectUpdated",[b.element,b.shortcodeName]);b.element.trigger("render");d.removeClass(CE.Shortcode.preloaderClass);parent.CE.Save.changeContent();b.groupItemName&&r.accordion.hasClass("ui-accordion")&&(e=r.accordion.accordion("option","active"),r.interact("activate",e))},error:function(a){a=c.parseJSON(a.responseText);a.debug?console.log(a.message):(parent.MP.Flash.setFlash(a.message,"error"),parent.MP.Flash.showMessage());
d.removeClass(CE.Shortcode.preloaderClass)}})}},display:function(a){this.settingsCtrl.display(a);this.stylesCtrl.display(a)}})}(jQuery),function(c){CE.Controls("CE.InlineEditor",{curElement:null,styleFormats:!1,init:function(){c(document).on("mousedown",".mce-tinymce.mce-panel",function(a){a.preventDefault()});c(document).on("keydown",'[data-motopress-shortcode="mp_text"], [data-motopress-shortcode="mp_heading"]',function(a){a.which===c.ui.keyCode.TAB?CE.Selectable.myThis.unselect():a.which===c.ui.keyCode.ESCAPE&&
(CE.InlineEditor.curElement&&CE.InlineEditor.curElement.control().close(!0,"show"),a=c(this).closest(".motopress-clmn").find("."+CE.DragDrop.myThis.helper.attr("class")).first().children("."+CE.DragDrop.myThis.dragHandle.attr("class")),CE.Selectable.focusWithoutScroll(a.prev()),CE.Dialog.myThis.element.dialog("isOpen")||CE.Dialog.myThis.open(a))});c(parent.document).on("mousedown",function(a){CE.InlineEditor.curElement&&!c(a.target).closest(".ui-dialog").length&&CE.InlineEditor.curElement.control().close(!0,
"show")})},isTinymce:function(a){var b=!1;c(a.target).hasClass("motopress-drag-handle")||(a=c(a.currentTarget.activeElement),a.length&&(a.closest("[data-motopress-shortcode]").length||a.closest(".mce-tinymce").length||a.closest(".mce-window").length||a.closest(".mce-popover").length)&&(b=!0));return b},destroyAll:function(){var a;parent.CE.Iframe.myThis.sceneContent.find('[data-motopress-shortcode="mp_text"], [data-motopress-shortcode="mp_heading"]').each(function(){a=c(this).control();a.destroyEditor()})},
reinitAll:function(){var a;parent.CE.Iframe.myThis.sceneContent.find('[data-motopress-shortcode="mp_text"], [data-motopress-shortcode="mp_heading"]').each(function(){a=c(this).control();a.initEditor()})}},{id:null,isOpen:!1,editor:null,helpers:null,blockContent:null,floatpanel:null,saved:!1,init:function(a,b){this._super(a,b);this.id=parent.MP.Utils.uniqid();this.blockContent=this.element.parent("."+CE.DragDrop.myThis.blockContent.attr("class"));var c=this.element.closest(".motopress-clmn").find("."+
CE.DragDrop.myThis.helper.attr("class")).first();this.helpers=c.add(c.children().not(".motopress-splitter, .motopress-clmn-select-handle"));this.resizers=this.blockContent.nextAll(".ui-resizable-handle");c.children("."+CE.DragDrop.myThis.dragHandle.attr("class")).on("click",this.proxy("onClick"))},destroy:function(){CE.InlineEditor.curElement=null;this.floatpanel&&this.floatpanel.remove();this._super()},initEditor:function(){var a=this,b=this.element.closest(".motopress-clmn").find("."+CE.DragDrop.myThis.helper.attr("class")).first().children("."+
CE.DragDrop.myThis.dragHandle.attr("class")),d=setTimeout(function(){var e="bold italic underline | ";c.isEmptyObject(CE.InlineEditor.styleFormats)||(e+="styleselect | ");tinyMCE.init({selector:"#"+a.id,inline:!0,plugins:"link hr textcolor",visual:!1,convert_urls:!1,menubar:!1,toolbar:e+"formatselect | fontsizeselect forecolor | alignleft aligncenter alignright alignjustify | numlist bullist outdent indent | link unlink hr removeformat",fontsize_formats:"8px 9px 10px 11px 12px 13px 14px 15px 16px 18px 24px 30px 36px 42px 48px 60px 72px 96px",
language:parent.MP.Settings.lang.tinymce,skin:"motopresscontenteditor",browser_spellcheck:parent.MP.Settings.spellcheck,style_formats_merge:!1,style_formats:CE.InlineEditor.styleFormats,setup:function(d){a.editor=d;d.on("loadContent",function(){a.autoOpen(b,1)});d.on("execCommand",function(b){switch(b.command){case "mceToggleEditor":if(!a.floatpanel&&(b=c("body").children(".mce-floatpanel:last"),b.length&&(a.floatpanel=b,50<b.height()))){var d=b.find('.mce-container-body.mce-flow-layout > [role="toolbar"]:first').outerHeight(!0)-
2;b.width(723).height(d);b.children(".mce-container-body.mce-abs-layout").width(723).height(d).children(".mce-container.mce-panel").width(723).height(d).children(".mce-container-body.mce-stack-layout").width(723).height(d)}a.floatpanel.offset().left+a.floatpanel.width()>c(window).width()&&(b=a.element.offset().left+a.element.width()-a.floatpanel.width(),a.floatpanel.css("left",b))}})},init_instance_callback:function(d){c.each(d.menuItems.formats.menu,function(a,b){"Blocks"===b.text&&c.each(b.menu,
function(a,c){"Div"===c.text&&delete b.menu[a]})});c(d.getBody()).on("blur",function(){a.save()});c(d.getBody()).on("focus",function(){a.saved=!1;if(b.hasClass(CE.Selectable.myThis.selectedClass))b.trigger("click");else var c=setTimeout(function(){CE.LeftBar.myThis.leftBar.focus();clearTimeout(c)},0)})}});clearTimeout(d)},0)},destroyEditor:function(){this.editor.destroy();this.editor=null}," render":function(){this.shortcode.children("div").attr("id",this.id);this.initEditor()},onClick:function(a){c(a.target).hasClass(CE.Selectable.myThis.selectedClass)&&
!this.isOpen&&(this.isOpen=!0,CE.InlineEditor.curElement=this.element,CE.Dialog.myThis.element.dialog("isOpen")&&CE.Dialog.myThis.element.dialog("close"),this.helpers.hide(),c(".motopress-content-wrapper > .motopress-handle-middle-in:last").height(""),this.resizers.hide(),this.blockContent.addClass("motopress-overflow-visible-important"),this.editor.execCommand("mceToggleEditor",!1),this.showHideFloatpanel("show"))},close:function(a,b){this.isOpen&&(this.isOpen=!1,this.save(),this.helpers.show(),
"undefined"!==typeof a&&("show"===b?this.resizers.show():"hide"===b&&this.resizers.hide()),this.showHideFloatpanel("hide"),this.blockContent.removeClass("motopress-overflow-visible-important"),CE.Resizer.myThis.updateHandle(),parent.CE.Save.changeContent())},save:function(){this.saved||(this.shortcode.attr("data-motopress-content",this.editor.getContent({format:"html"})),this.saved=!0,CE.Resizer.myThis.updateBottomInHandleMiddle(),CE.Resizer.myThis.updateSplitterHeight(this.element,"split"),CE.Resizer.myThis.updateHandleMiddle())},
autoOpen:function(a,b){if(3>=b)if(1<b&&a.hasClass(CE.Selectable.myThis.selectedClass))CE.Dialog.myThis.element.dialog("isOpen")&&CE.Dialog.myThis.element.dialog("close"),c(this.editor.getBody()).trigger("blur").trigger("focus"),a.trigger("click");else var d=this,e=setTimeout(function(){d.autoOpen(a,b+1);clearTimeout(e)},500)},showHideFloatpanel:function(a){this.floatpanel&&("show"===a?this.floatpanel.show():this.floatpanel.hide())}})}(jQuery),function(c){CE.Controls("CE.CodeEditor",{},{init:function(a,
b){this._super(a,b);var c=this.element.closest(".motopress-clmn").find("."+CE.DragDrop.myThis.helper.attr("class")).first().children("."+CE.DragDrop.myThis.dragHandle.attr("class"));this.autoOpen(c,1);c.on("click",this.proxy("onClick"))},destroy:function(){this._super()}," render":function(){this.shortcode.find(".row").removeClass("row").addClass(parent.CE.Iframe.myThis.gridObj.row["class"]);this.shortcode.find("a").attr("tabindex",-1);CE.Resizer.myThis.updateAllHandles()},autoOpen:function(a,b){if(3>=
b)if(1<b&&a.hasClass(CE.Selectable.myThis.selectedClass))a.trigger("click");else var c=this,e=setTimeout(function(){c.autoOpen(a,b+1);clearTimeout(e)},500)},onClick:function(a){if(c(a.target).hasClass(CE.Selectable.myThis.selectedClass)){a=parent.CE.CodeModal.myThis.editor;parent.CE.CodeModal.currentShortcode=this.element;var b=this.shortcode.attr("data-motopress-content");"undefined"!==typeof b&&(b=b.replace(RegExp("\\[\\]","ig"),"["),null!==a&&a.setContent(b,{format:"html"}),parent.CE.CodeModal.myThis.content.val(parent.switchEditors._wp_Nop(b)));
parent.CE.CodeModal.myThis.saveHandler=this.saveHandler;parent.CE.CodeModal.myThis.element.mpmodal("show")}},saveHandler:function(a){a=parent.CE.CodeModal.myThis;a.switchVisual();var b=parent.CE.CodeModal.currentShortcode.control(),c=null!==a.editor?a.editor.getContent({format:"html"}):parent.switchEditors._wp_Autop(a.content.val());c.length?b.shortcode.attr("data-motopress-content",c):b.shortcode.removeAttr("data-motopress-content");b.renderShortcode();a.element.mpmodal("hide")}})}(jQuery),function(c){CE.Tools=
can.Construct({myThis:null},{init:function(){CE.Tools.myThis=this},removeBlock:function(){CE.Utils.removeSceneAction("select");var a=c(".motopress-selected").closest(".motopress-clmn"),b=a.closest(".motopress-row");CE.Selectable.setScrollY(window.scrollY);CE.Dialog.myThis.element.dialog("isOpen")&&CE.Dialog.myThis.element.dialog("close");parent.CE.Navbar.myThis.hideObjectControlBtns();var d=a.siblings(".motopress-clmn"),e=parent.MP.Utils.getSpanClass(a.prop("class").split(" ")),e=CE.DragDrop.myThis.removeEmptyBlocks(a,
e),e=b.children(".motopress-clmn").index(a),e=CE.DragDrop.myThis.canBeMoved(b,null,e);if(a.hasClass("ce_inline_editor")){var f=a.control().child.attr("id");"undefined"!==typeof f&&(f=tinymce.get(f),"undefined"!==typeof f&&f.destroy())}a.remove();var f=CE.DragDrop.myThis.clearIfEmpty(b,"remove"),g=!1;f&&f.hasOwnProperty("row")&&(g=!0,b=f.row);CE.DragDrop.myThis.isEmptyScene()&&(c(".motopress-handle-middle-in").remove(),CE.DragDrop.myThis.emptySceneHelper.show(),CE.Utils.addSceneState("empty-scene"));
g||CE.DragDrop.myThis.resize(b,a,"remove",e);CE.Resizer.myThis.updateSplittableOptions(null,b,null);CE.Resizer.myThis.updateAllHandles();c(window).trigger("resize");var l,h={involvedElements:{}};d.length&&(a=d.find(".motopress-block-content > [data-motopress-shortcode]"),a.length&&a.each(function(){l=c(this).attr("data-motopress-shortcode");h.involvedElements.hasOwnProperty(l)||(h.involvedElements[l]=[]);h.involvedElements[l].push(this)}));c("body").trigger("MPCEObjectRemove",h)},cloneShortcodes:function(a){var b=
"";a.hasClass("motopress-row")||a.hasClass("motopress-clmn")||(b=parent.CE.Save.getShortcode(b,a));var d=c.Deferred();c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"html",data:{action:"motopress_ce_render_shortcodes_string",nonce:parent.motopressCE.nonces.motopress_ce_render_shortcodes_string,postID:parent.motopressCE.postID,content:b},success:function(a){d.resolve(a)},error:function(a){a=c.parseJSON(a.responseText);d.reject(a);a.debug?console.log(a.message):(parent.MP.Flash.setFlash(a.message,
"error"),parent.MP.Flash.showMessage())}});return d.promise()},duplicateBlock:function(){var a=c(".motopress-selected").closest(".motopress-clmn");CE.Selectable.myThis.unselect();var b=a.closest(".motopress-row"),d=parent.MP.Utils.getEdgeRow(b).children(".motopress-clmn").index(a),e=1===parent.MP.Utils.detectSpanNestingLvl(a)?CE.DragDrop.myThis.spanHtml.clone():CE.DragDrop.myThis.spanInnerHtml.clone(),f=a.children(".motopress-block-content").children("[data-motopress-shortcode]").clone(),g=f.attr("data-motopress-styles"),
g=c.parseJSON(g);g.hasOwnProperty("mp_custom_style")&&g.mp_custom_style.hasOwnProperty("value")&&(g.mp_custom_style.value=CE.StyleEditor.myThis.changePrivateClassToDuplicated(g.mp_custom_style.value),g=JSON.stringify(g),f.attr("data-motopress-styles",g));"mp_space"===f.attr("data-motopress-shortcode")&&(e.addClass(CE.DragDrop.myThis.spaceClass),g=a.css("min-height"),e.css({"min-height":g}));CE.DragDrop.myThis._setAttrs(e);CE.DragDrop.myThis.makeEditable(e,null,!0);e.find(".motopress-filler-content").replaceWith(f);
CE.DragDrop.myThis.initShortcodeController(f,!1);f.control(CE.Controls).renderShortcode("duplicated");if(d=CE.DragDrop.myThis.canBeMoved(null,b,null,d,null,"out",null,!0))l=a.closest(".motopress-row"),a.after(e),CE.DragDrop.myThis.resize(b,e,"right-out",d);else{CE.DragDrop.interruptInsert=!1;CE.Resizer.myThis.changeSpanClass(e,parent.CE.Iframe.myThis.gridObj.span.fullclass);var l=parent.MP.Utils.detectRowNestingLvl(b)?CE.DragDrop.myThis.rowHtml.clone():CE.DragDrop.myThis.rowInnerHtml.clone();l.find(".motopress-filler-content").replaceWith(e);
b.next(".motopress-handle-middle-in").after(l);CE.DragDrop.myThis.makeRowEditable(l,!0);var h=setTimeout(function(){CE.DragDrop.myThis.addHandleMiddle(l);CE.DragDrop.myThis.resize(b,e,"middle");clearTimeout(h)},0)}var m=setTimeout(function(){CE.Selectable.myThis.select(e.children(".motopress-helper").children(".motopress-drag-handle"));CE.DragDrop.myThis.makeDroppable();CE.Resizer.myThis.updateSplittableOptions(e,b,l);CE.Resizer.myThis.updateAllHandles();c(window).trigger("resize");var a,d,f={involvedElements:{}};
f.duplicatedElement=e.children(".motopress-block-content").children("[data-motopress-shortcode]");a=e.siblings(".motopress-clmn");a.length&&(a=a.find(".motopress-block-content > [data-motopress-shortcode]"),a.length&&a.each(function(){d=c(this).attr("data-motopress-shortcode");f.involvedElements.hasOwnProperty(d)||(f.involvedElements[d]=[]);f.involvedElements[d].push(this)}));c("body").trigger("MPCEObjectDuplicated",f);clearTimeout(m)},0)}})}(jQuery),function(c){CE.Resizer=can.Construct({myThis:null},
{minHeight:30,minWidth:8,spaceMinHeight:10,gmapMinHeight:150,handle:null,addedStyleProperties:"position top left width height background-position background-repeat".split(" "),emptySpan:null,gridColumnSizeClassesString:"",splitter:c("<div />",{"class":"motopress-splitter"}),oldWidth:null,emptySpanNumber:0,resizeWindowTimer:null,container:c("#motopress-container"),bodyEl:c("body"),setup:function(){this.setGridColumnSizeClassesString();this.setEmptySpan()},init:function(){CE.Resizer.myThis=this;CE.Grid.myThis.padding&&
this.splitter.css({width:2*CE.Grid.myThis.padding,"margin-left":-2*CE.Grid.myThis.padding});c(window).on("resize",function(a){parent.CE.Iframe.myThis.setSceneWidth();a.target===this&&CE.Resizer.myThis.proxy("updateHandle");CE.Resizer.myThis.resizeWindowTimer&&clearTimeout(CE.Resizer.myThis.resizeWindowTimer);CE.Resizer.myThis.resizeWindowTimer=setTimeout(function(){parent.MP.Editor.triggerIfr("Resize")},500)});parent.MP.Editor.onIfr("Resize",function(a){CE.Resizer.myThis.updateAllHandles()})},setGridColumnSizeClassesString:function(){for(var a=
[],b=1;b<=parent.CE.Iframe.myThis.gridObj.row.col;b++)a.push(parent.CE.Iframe.myThis.gridObj.span["class"]+b);this.gridColumnSizeClassesString=a.join(" ")},setEmptySpan:function(){var a=c(parent.motopressCE.rendered_shortcodes.empty[parent.CE.Iframe.myThis.gridObj.span.shortcode]);CE.DragDrop.setEdgeSpan(a,!0);a.find(".motopress-filler-content").remove();a.removeClass(this.gridColumnSizeClassesString);CE.LeftBar.myThis.setAttrs(a,CE.LeftBar.myThis.library.mp_grid.id,CE.LeftBar.myThis.library.mp_grid.objects[parent.CE.Iframe.myThis.gridObj.span.shortcode]);
this.emptySpan=a},getMinHeight:function(a){var b=a.find(".motopress-block-content > [data-motopress-shortcode]");return b.length&&"mp_gmap"===b.attr("data-motopress-shortcode")?this.gmapMinHeight:a.hasClass(CE.DragDrop.myThis.spaceClass)?this.spaceMinHeight:this.minHeight},makeResizable:function(a){var b=this;a.not("[data-motopress-wrapper-id], .motopress-empty").each(function(){var a=c(this).find(".motopress-block-content > [data-motopress-shortcode]"),e=a.length?a.attr("data-motopress-shortcode"):
null,f;c(this).resizable({grid:[1,10],handles:"e, s, w, se, sw",helper:"motopress-resizer-helper",minWidth:2,minHeight:CE.Resizer.myThis.getMinHeight(c(this)),zIndex:1002,create:function(){c(this).resizable("option","maxWidth",parseFloat(c(this).css("width")));c(this).children(".ui-resizable-handle").hide();var a=CE.Grid.myThis.padding-4;c(this).children(".ui-resizable-e, .ui-resizable-se").css("right",a);c(this).children(".ui-resizable-w, .ui-resizable-sw").css("left",a)},start:function(g,h){CE.Utils.addSceneAction("resize");
CE.LeftBar.myThis.disable();CE.LeftBar.myThis.hide();b.hideSplitters();b.hideEmptySpans();c(".motopress-content-wrapper > .motopress-handle-middle-in:last").height("");c(this).find(".motopress-handle-bottom-in").css({bottom:"",height:""});CE.Dialog.myThis.element.dialog("isOpen")&&CE.Dialog.myThis.element.dialog("close");CE.Resizer.myThis.handle=c(g.originalEvent.target);b.oldWidth=parseFloat(h.element.css("width"));f=parent.MP.Utils.getHandleClass(CE.Resizer.myThis.handle.prop("class").split(" "));
var m=null,m="ui-resizable-e"===f||"ui-resizable-se"===f?h.element.next(".motopress-empty"):h.element.prev(".motopress-empty"),k=parent.MP.Utils.getSpanClass(h.element.prop("class").split(" ")),k=parent.MP.Utils.getSpanNumber(k);b.oldSpanNumber=k;var q=0;m&&m.length&&(m=parent.MP.Utils.getSpanClass(m.prop("class").split(" ")),q=parent.MP.Utils.getSpanNumber(m));m=k+q;CE.Resizer.myThis.maxSpanNumber=m;var n=c(this).parent(".motopress-row-edge").width()/100;h.element.resizable("option","maxWidth",n*
CE.Grid.myThis.colWidthByNumber[m]);k=[];for(q=1;q<=m;q++)k[q]=n*CE.Grid.myThis.colWidthByNumber[q];for(var n=Math.floor(m/2),p=0===m%2,q=1;q<=n;q++)0>k[q]-2*CE.Grid.myThis.padding&&(k[q]*=-1,p?q!==n&&(k[m-q]*=-1):k[m-q]*=-1);h.element.data("mp-snap-grid",k);CE.Resizer.myThis.handle.addClass("motopress-resizable-handle-hover");h.element.css({position:"relative",top:0,left:0});c(this).closest(".motopress-row").parent(".motopress-content-wrapper").length||(m=c(this).closest(".motopress-row").nextAll(".motopress-handle-middle-in:last"),
k=parseInt(m.css("min-height")),m.height(k));c("body").trigger("MPCEObjectResizeStart",{objElement:a,objName:e,handle:f})},stop:function(g,h){CE.Utils.removeSceneAction("resize");CE.LeftBar.myThis.enable();CE.LeftBar.myThis.show();b.showSplitters();b.showEmptySpans();CE.Resizer.myThis.splitterHandle=!1;CE.Resizer.myThis.handle.removeClass("motopress-resizable-handle-hover");for(var m={},k=0;k<CE.Resizer.myThis.addedStyleProperties.length;k++)m[CE.Resizer.myThis.addedStyleProperties[k]]="";h.element.css(m);
c(this).hasClass("ce_controls")&&!CE.Dialog.myThis.element.dialog("isOpen")&&(m=h.element.find(".motopress-drag-handle"),CE.Dialog.myThis.open(m));m=h.element.prev(".motopress-empty");k=h.element.next(".motopress-empty");CE.DragDrop.myThis.makeEditableEmptySpan(m.add(k));b.updateSplittableOptions(m,null,null);b.updateSplittableOptions(k,null,null);CE.Resizer.myThis.updateAllHandles();parent.CE.Save.changeContent();c("body").trigger("MPCEObjectResizeStop",{objElement:a,objName:e,handle:f})},resize:function(b,
g){switch(f){case "ui-resizable-s":CE.Resizer.myThis.verticalResize(g);break;case "ui-resizable-w":CE.Resizer.myThis.horizontalResize(f,g);break;case "ui-resizable-e":CE.Resizer.myThis.horizontalResize(f,g);break;case "ui-resizable-sw":CE.Resizer.myThis.verticalResize(g);CE.Resizer.myThis.horizontalResize(f,g);break;case "ui-resizable-se":CE.Resizer.myThis.verticalResize(g),CE.Resizer.myThis.horizontalResize(f,g)}c("body").trigger("MPCEObjectResize",{objElement:a,objName:e,handle:f})}});if(a.length){var g=
a.attr("data-motopress-resize");"undefined"===typeof g&&(g=a.attr("data-motopress-group"),g=CE.LeftBar.myThis.library[g].objects[e].resize);switch(g){case "none":c(this).children(".ui-resizable-handle").addClass("motopress-hide");break;case "horizontal":c(this).children('.ui-resizable-handle:not(".ui-resizable-e, .ui-resizable-w")').addClass("motopress-hide");break;case "vertical":c(this).children('.ui-resizable-handle:not(".ui-resizable-s")').addClass("motopress-hide")}}})},horizontalResize:function(a,
b){var c=parseFloat(b.helper.css("width"));b.element.css({top:0,left:0});if(c===this.oldWidth)return!1;for(var e=c<this.oldWidth?-1:1,f=b.element.data("mp-snap-grid"),g=f.length-1,l=!1,h=1;h<=g;h++)if(!(0>=f[h])&&(l=1===h?0>e?f[h]:Math.abs(f[h+1])-Math.abs(f[h]):h==g?Math.abs(f[h])-Math.abs(f[h-1]):0>e?Math.abs(f[h])-Math.abs(f[h-1]):Math.abs(f[h+1])-Math.abs(f[h]))&&(l=Math.abs(l)/2,c>=f[h]-l/2&&c<=f[h]+l&&(l=h-this.oldSpanNumber,0!==l))){e=null;parent.MP.Utils.getSpanClass(b.element.prop("class").split(" "));
CE.Resizer.myThis.changeSpanClass(b.element,parent.CE.Iframe.myThis.gridObj.span["class"]+h);"ui-resizable-e"===a||"ui-resizable-se"===a?(f="east",e=b.element.next(".motopress-empty")):(f="west",e=b.element.prev(".motopress-empty"));e&&e.length?(f=parent.MP.Utils.getSpanClass(e.prop("class").split(" ")),f=parent.MP.Utils.getSpanNumber(f),l<f?CE.Resizer.myThis.changeSpanClass(e,parent.CE.Iframe.myThis.gridObj.span["class"]+(f-l)):e.remove()):(e=CE.Resizer.myThis.emptySpan.clone(),e.addClass(parent.CE.Iframe.myThis.gridObj.span["class"]+
Math.abs(l)).addClass("motopress-empty-hide"),"east"===f?b.element.after(e):b.element.before(e));b.element.css({width:""});this.oldWidth=c;this.oldSpanNumber=h;break}return!1},verticalResize:function(a){var b=parseInt(a.element.css("min-height")),c=a.helper.height();b===c&&a.element.css("min-height","");a.element.css("min-height",c);a.element.css("height",c)},getMinChildColumn:function(a){var b=CE.Grid.myThis.columnCount;a.find(".motopress-clmn").each(function(){var a=parent.MP.Utils.getSpanNumber(parent.MP.Utils.getSpanClass(c(this).prop("class").split(" ")));
a<b&&(b=a)});return b},isAllowedColSize:function(a,b){return 0>b/100*CE.Grid.myThis.colWidthByNumber[a]-2*CE.Grid.myThis.padding?!1:!0},makeSplittable:function(a){if(!a.length)return!1;var b=this,d,e,f;(a.hasClass("motopress-splitter")?a:a.find(".motopress-splitter")).draggable({axis:"x",cursor:"col-resize",grid:[1,0],helper:"clone",zIndex:1,start:function(a,e){CE.Utils.addSceneAction("split");e.helper.hide();b.hideSplitters(c(this));b.hideEmptySpans();c(".motopress-content-wrapper > .motopress-handle-middle-in:last").height("");
d=null;f=!1;CE.LeftBar.myThis.disable();CE.LeftBar.myThis.hide();c(this).addClass("motopress-splitter-hover");CE.Dialog.myThis.element.dialog("isOpen")&&CE.Dialog.myThis.element.dialog("close");var h=e.helper.closest(".motopress-row");h.find(".motopress-drag-handle").css("cursor","col-resize");var m=parent.MP.Utils.getEdgeRow(h).width()/100,k=c(this).closest(".motopress-clmn"),h=k.prev(".motopress-clmn"),q=parent.MP.Utils.getSpanNumber(parent.MP.Utils.getSpanClass(k.prop("class").split(" "))),n=parent.MP.Utils.getSpanNumber(parent.MP.Utils.getSpanClass(h.prop("class").split(" "))),
p=h.offset().left;if(h.is("[data-motopress-wrapper-id]"))var r=b.getMinChildColumn(h);if(k.is("[data-motopress-wrapper-id]"))var t=b.getMinChildColumn(k);for(var u=q+n-1,v=[],s=1;s<=u;s++)v[s]=m*CE.Grid.myThis.colWidthByNumber[s];for(var m=v.slice(),x,s=1;s<n;s++)0>v[s]-2*CE.Grid.myThis.padding?v[s]=-1*(p+v[s]):(x=1,u=Math.abs(v[s]),0<v[s]&&h.is("[data-motopress-wrapper-id]")&&(b.isAllowedColSize(r,u)||(x=-1)),v[s]=(p+v[s])*x);r=n-1;for(s=q;1<=s;s--)r++,0>m[s]-2*CE.Grid.myThis.padding?v[r]=-1*(p+
v[r]):(x=1,u=m[s],0<m[s]&&k.is("[data-motopress-wrapper-id]")&&(b.isAllowedColSize(t,u)||(x=-1)),v[r]=(p+v[r])*x);c(this).data("mp-snap-grid",v);b.currentI=n;b.curSplitterArea="";var y,z={involvedElements:{}};k.length&&(t=k.find(".motopress-block-content > [data-motopress-shortcode]"),t.length&&t.each(function(){y=c(this).attr("data-motopress-shortcode");z.involvedElements.hasOwnProperty(y)||(z.involvedElements[y]=[]);z.involvedElements[y].push(this)}));h.length&&(t=h.find(".motopress-block-content > [data-motopress-shortcode]"),
t.length&&t.each(function(){y=c(this).attr("data-motopress-shortcode");z.involvedElements.hasOwnProperty(y)||(z.involvedElements[y]=[]);z.involvedElements[y].push(this)}));c("body").trigger("MPCEObjectSplitStart",z)},stop:function(a,d){CE.Utils.removeSceneAction("split");CE.LeftBar.myThis.enable();CE.LeftBar.myThis.show();b.showSplitters();b.showEmptySpans();d.helper.closest(".motopress-row").find(".motopress-drag-handle").css("cursor","move");c(this).removeClass("motopress-splitter-hover");var h=
c(this).closest(".motopress-clmn"),m=h.prev(".motopress-clmn");CE.Resizer.myThis.updateSplittableOptions(h,null,null,"split");CE.Resizer.myThis.updateAllHandles();f&&e.length&&e.remove();parent.CE.Save.changeContent();var k,q={involvedElements:{}};h.length&&(h=h.find(".motopress-block-content > [data-motopress-shortcode]"),h.length&&h.each(function(){k=c(this).attr("data-motopress-shortcode");q.involvedElements.hasOwnProperty(k)||(q.involvedElements[k]=[]);q.involvedElements[k].push(this)}));m.length&&
(h=m.find(".motopress-block-content > [data-motopress-shortcode]"),h.length&&h.each(function(){k=c(this).attr("data-motopress-shortcode");q.involvedElements.hasOwnProperty(k)||(q.involvedElements[k]=[]);q.involvedElements[k].push(this)}));c("body").trigger("MPCEObjectSplitStop",q)},drag:function(a,l){var h=!1,m=l.offset.left-CE.Grid.myThis.padding/2;null===d&&(d=m);if(m!==d){var k=c(this).closest(".motopress-clmn"),q=null,n=k.closest(".motopress-row-edge").width(),p,r,t=c(this).data("mp-snap-grid"),
u=t.length-1;1<u?(p=Math.abs(t[2])-Math.abs(t[1]),r=Math.abs(t[u])-Math.abs(t[u-1])):p=r=n/100*CE.Grid.myThis.colWidthByNumber[1];p>CE.Grid.myThis.padding&&(p-=CE.Grid.myThis.padding);p>CE.Grid.myThis.padding&&(p-=CE.Grid.myThis.padding);r>CE.Grid.myThis.padding&&(r-=CE.Grid.myThis.padding);p=2>=a.pageX||m<=Math.abs(t[1])-p;r=a.pageX>=c(document).width()-2||m>=Math.abs(t[u])+1.5*r;if(p||r){if(p&&"left"===b.curSplitterArea||r&&"right"===b.curSplitterArea)return;q=k.prev(".motopress-clmn");m=parent.MP.Utils.getSpanClass(k.prop("class").split(" "));
n=parent.MP.Utils.getSpanClass(q.prop("class").split(" "));m=parent.MP.Utils.getSpanNumber(m);n=parent.MP.Utils.getSpanNumber(n);if(p)if(b.curSplitterArea="left",q.hasClass("motopress-empty"))CE.Resizer.myThis.changeSpanClass(k,parent.CE.Iframe.myThis.gridObj.span["class"]+(m+n)),e=q,f=!0,c(window).trigger("resize"),h=!0;else{m=0;for(p=1;p<=u;p++)if(0<t[p]){m=p;break}m&&(CE.Resizer.myThis.changeSpanClass(k,parent.CE.Iframe.myThis.gridObj.span["class"]+(u+1-m)),CE.Resizer.myThis.changeSpanClass(q,
parent.CE.Iframe.myThis.gridObj.span["class"]+m),b.currentI=m,c(window).trigger("resize"),h=!0)}else if(b.curSplitterArea="right",k.hasClass("motopress-empty"))CE.Resizer.myThis.changeSpanClass(q,parent.CE.Iframe.myThis.gridObj.span["class"]+(n+m)),e=k,f=!0,c(window).trigger("resize"),h=!0;else{m=0;for(p=u;1<=p;p--)if(0<t[p]){m=p;break}m&&(CE.Resizer.myThis.changeSpanClass(k,parent.CE.Iframe.myThis.gridObj.span["class"]+(u+1-m)),CE.Resizer.myThis.changeSpanClass(q,parent.CE.Iframe.myThis.gridObj.span["class"]+
m),b.currentI=m,c(window).trigger("resize"),h=!0)}}else{b.curSplitterArea="center";var v=m<d?-1:1;r=!1;for(p=1;p<=u;p++)if(!(0>=t[p])&&(r=!1,r=1<u?1===p?Math.abs(t[p+1])-Math.abs(t[p]):p==u?Math.abs(t[p])-Math.abs(t[p-1]):0>v?Math.abs(t[p])-Math.abs(t[p-1]):Math.abs(t[p+1])-Math.abs(t[p]):n/100*CE.Grid.myThis.colWidthByNumber[1])&&(r=Math.abs(r)/2,m>=t[p]-r/2&&m<=t[p]+r&&(r=p-b.currentI,f=!1,0!==r))){k=c(this).closest(".motopress-clmn");q=k.prev(".motopress-clmn");m=parent.MP.Utils.getSpanClass(k.prop("class").split(" "));
n=parent.MP.Utils.getSpanClass(q.prop("class").split(" "));n=parent.MP.Utils.getSpanClass(q.prop("class").split(" "));m=parent.MP.Utils.getSpanNumber(m);n=parent.MP.Utils.getSpanNumber(n);h=n+r;CE.Resizer.myThis.changeSpanClass(k,parent.CE.Iframe.myThis.gridObj.span["class"]+(m-r));CE.Resizer.myThis.changeSpanClass(q,parent.CE.Iframe.myThis.gridObj.span["class"]+h);b.currentI=p;c(window).trigger("resize");h=!0;break}}k&&k.length&&(t=parseInt(k.css("margin-top"))+parseInt(k.css("border-top-width")),
u=c(this).closest(".motopress-row").height(),c(this).css({top:-t,height:u}),f&&a.preventDefault());if(h){CE.Resizer.myThis.updateSplitterHeight();var s,x={involvedElements:{}};k&&k.length&&(k=k.find(".motopress-block-content > [data-motopress-shortcode]"),k.length&&k.each(function(){s=c(this).attr("data-motopress-shortcode");x.involvedElements.hasOwnProperty(s)||(x.involvedElements[s]=[]);x.involvedElements[s].push(this)}));q&&q.length&&(k=q.find(".motopress-block-content > [data-motopress-shortcode]"),
k.length&&k.each(function(){s=c(this).attr("data-motopress-shortcode");x.involvedElements.hasOwnProperty(s)||(x.involvedElements[s]=[]);x.involvedElements[s].push(this)}));c("body").trigger("MPCEObjectSplit",x)}}}})},calcSplitterOptions:function(a,b){var d=null,e=null,f=null;if("column"===b)e=a.parent(".motopress-row-edge").width(),d=a;else if("row"===b)d=parent.MP.Utils.getEdgeRow(a),e=d.width(),d=d.children(".motopress-clmn");else return!1;if(!CE.Grid.myThis.padding)var e=e/100,g=e*CE.Grid.myThis.columnMarginPiece,
l=e*CE.Grid.myThis.splitterWidthPiece+g,h=-(e*CE.Grid.myThis.splitterMarginPiece+g/2);d.each(function(){f=c(this).find(".motopress-helper > .motopress-splitter");CE.Resizer.myThis.makeSplittable(f);CE.Grid.myThis.padding||(f.width(l),f.css("margin-left",h-parseInt(c(this).css("border-left-width"))));c(this).children(".motopress-row").length||CE.Resizer.myThis.makeResizable(c(this))})},updateSplittableOptions:function(a,b,d,e){"undefined"===typeof e&&(e="default");"init"===e||"split"===e?(b=null,"init"===
e?b=c(".motopress-content-wrapper .motopress-row"):"split"===e&&(a=a.parents(".motopress-row, .motopress-content-wrapper").eq(-2),"undefined"!==typeof a&&(b=c.merge(c.merge([],a),a.find(".motopress-row")))),b&&"undefined"!==typeof b&&c.each(b,function(){CE.Resizer.myThis.calcSplitterOptions(c(this),"row")})):(a&&this.calcSplitterOptions(a,"column"),b&&c.each(c.merge(c.merge([],b),b.find(".motopress-row")),function(){CE.Resizer.myThis.calcSplitterOptions(c(this),"row")}),d&&c.each(c.merge(c.merge([],
d),d.find(".motopress-row")),function(){CE.Resizer.myThis.calcSplitterOptions(c(this),"row")}))},updateSplitterHeight:function(a,b){var d=setTimeout(function(){var a=null,a=c(".motopress-content-wrapper .motopress-row");c.each(a.get().reverse(),function(){var a=parent.MP.Utils.getEdgeRow(c(this)),b=a.children(".motopress-clmn").filter(".motopress-empty");b.css("height","");var d=a.height();c.each(b,function(){var a=parseFloat(c(this).css("margin-top"))+parseFloat(c(this).css("margin-bottom")),a=d-
a;c(this).outerHeight(a)})});c.each(a,function(){var a=c(this),b=parent.MP.Utils.getEdgeRow(a),a=b.children(".motopress-clmn"),d=0,d=CE.Grid.myThis.padding?2*CE.Grid.myThis.padding:b.width()/100*CE.Grid.myThis.columnMarginPiece,e=b.outerHeight();a.each(function(){var a=c(this),f=parent.MP.Utils.getEdgeSpan(a),q=CE.Grid.myThis.padding&&a.is("[data-motopress-wrapper-id]")?d/2:d,f=f.offset().top-b.offset().top+parseFloat(f.css("border-top-width"));a.find(".motopress-splitter").css({height:e,top:-f});
a.find(".motopress-handle-intermediate").css({width:d,height:e,top:-f,left:-q-parseInt(a.css("border-left-width"))})})});clearTimeout(d)},50)},hideSplitters:function(a){a="undefined"===typeof a?a=!1:a;var b=c(".motopress-content-wrapper .motopress-clmn .motopress-splitter");a?b.not(a).addClass("motopress-hide"):b.addClass("motopress-hide")},showSplitters:function(){c(".motopress-content-wrapper .motopress-clmn .motopress-splitter").removeClass("motopress-hide")},hideEmptySpans:function(){c(".motopress-content-wrapper .motopress-clmn.motopress-empty").addClass("motopress-empty-hide").height(1)},
showEmptySpans:function(){c(".motopress-content-wrapper .motopress-clmn.motopress-empty").removeClass("motopress-empty-hide")},calculateRowGap:function(a,b){var c=0,e=parent.MP.Utils.getEdgeRow(a);if(!a.is(e))switch(b){case "top":c+=e.offset().top-a.offset().top;break;case "bottom":var f=a.offset().top+a.outerHeight(),g=e.offset().top+e.outerHeight(),c=c+(f-g);break;case "left":c+=e.offset().left-a.offset().left;break;case "right":f=a.offset().left+a.outerWidth(),g=e.offset().left+e.outerWidth(),
c+=f-g}c+=parseFloat(e.css("padding-"+b));return c+=parseFloat(e.css("border-"+b+"-width"))},updateHandle:function(){var a=setTimeout(function(){if(!CE.DragDrop.myThis.isEmptyScene()){var b=c(".motopress-content-wrapper > .motopress-row:first"),d=b.offset(),e=parseFloat(b.css("margin-left")),f=c(".motopress-content-wrapper > .motopress-row:last"),g=d.left-0;c(".motopress-content-wrapper > .motopress-row").each(function(){var a=c(this),b=a.outerHeight();parent.MP.Utils.getEdgeRow(a).children(".motopress-clmn:first, .motopress-clmn:last").each(function(){var d=
c(this),e=parent.MP.Utils.getEdgeSpan(d),f=e.offset().top-a.offset().top+parseFloat(e.css("border-top-width"));d.children(".motopress-wrapper-helper, .motopress-helper").each(function(){var a=c(this).hasClass("motopress-wrapper-helper");c(this).find(".motopress-handle-left, .motopress-handle-right").each(function(){var d=c(this).hasClass("motopress-handle-left")?"left":"right",g=parseFloat(e.css("border-"+d+"-width")),h="left"===d?e.offset().left-0:c(window).width()-e.offset().left-e.outerWidth(),
l=h+g+CE.Grid.myThis.padding;0>=Math.floor(l)&&(l=25,h=0);l={top:-f,width:l,height:b};l[d]=-(a?h+g:h+g+CE.Grid.myThis.padding);c(this).css(l)})})})});var l=c("html"),h=c(document),m=h.width()-0,k=c(".motopress-content-wrapper > .motopress-handle-middle-in:first"),q=c(".motopress-content-wrapper > .motopress-handle-middle-in:last"),n=q.prevAll(".motopress-handle-middle-in:first");n[0]!==k[0]&&n.css({width:"",left:"",height:"","margin-top":""});var n=h.height(),p=parseInt(l.css("top")),l=n-q.offset().top;
n<p+h.outerHeight(!0)&&(l+=p);f=parseInt(f.css("margin-bottom"));Math.abs(parseInt(q.css("margin-top")))!==f&&(l+=f);b=parseInt(b.css("margin-top"));k.css({width:m,height:d.top,top:b-d.top,left:-g+e,"margin-top":""});q.css({width:m,left:-g+e,height:l,"margin-top":-f})}clearTimeout(a)},50)},updateBottomInHandleMiddle:function(){var a=setTimeout(function(){CE.DragDrop.myThis.isEmptyScene()||c(".motopress-content-wrapper > .motopress-row").each(function(){CE.Resizer.myThis.setHandleHeight(c(this))});
clearTimeout(a)},50)},setHandleHeight:function(a){var b=parseInt(a.find(".motopress-handle-middle-in:last").css("min-height"));a.find(".motopress-handle-middle-in").each(function(){c(this).height(b)});parent.MP.Utils.getEdgeRow(a).children('.motopress-clmn:not(".motopress-empty")').each(function(){var b=c(this),e=parent.MP.Utils.getEdgeSpan(b),f=e.width(),g=e.children(".motopress-row"),l=a.is(":last-of-type")?0:5,h=a.is(":first-of-type")?0:5,m=e.offset().top+e.outerHeight(),k=a.offset().top+a.outerHeight();
g.length?(h=e.children(".motopress-handle-middle-in:last-of-type"),b=k-m,l=h.prev(".motopress-row"),l=l.offset().top+l.outerHeight(),m=parseFloat(h.css("min-height")),h.css({bottom:-b+m,height:k-l,width:f}),k=e.children(".motopress-handle-middle-in:first-of-type"),h=parseFloat(e.css("padding-top")),b=parseFloat(e.css("border-top")),e=e.offset().top-a.offset().top,l=parseFloat(k.css("min-height")),k.css({top:-e-b,height:e+b+h+l,width:f}),g.each(function(){CE.Resizer.myThis.setHandleHeight(c(this))})):
(f=b.find(".motopress-handle-bottom-in"),g=parseFloat(f.css("min-height")),m=e.offset().top+e.outerHeight(),k=a.offset().top+a.outerHeight(),k=m-k,f.css({bottom:l+k,height:g-k+parseFloat(e.css("border-bottom-width"))}),f=e.offset().top-a.offset().top,g=b.find(".motopress-handle-top-in"),k=parseInt(g.css("min-height")),g.css({top:h-f,height:k+f+parseFloat(e.css("border-top-width"))}))})},updateHandleMiddle:function(){var a=setTimeout(function(){c('.motopress-content-wrapper > .motopress-handle-middle-in:not(":first-of-type, :last-of-type"), .motopress-content-wrapper .motopress-row-edge > .motopress-clmn .motopress-handle-middle-in:not(":first-of-type, :last-of-type")').each(function(){var a=
c(this),d=a.prev(".mpce-wp-more-tag").length?a.prev(".mpce-wp-more-tag").prev(".motopress-row"):a.prev(".motopress-row"),e=a.next(".motopress-row"),d=d.length?parseInt(d.css("margin-bottom")):0,f=e.length?parseInt(e.css("margin-top")):0,e=-d-5,d=Math.max(d,f)+10,f={};f.width=a.parent(".motopress-clmn-edge, .motopress-content-wrapper").width();0<d?(f["margin-top"]=e,f.height=d):(f["margin-top"]="",f.height="");f.bottom="";a.css(f)});c(".motopress-content-wrapper > .motopress-handle-middle-in:first-of-type, .motopress-content-wrapper > .motopress-handle-middle-in:last-of-type").css({"margin-left":"",
"margin-right":""});clearTimeout(a)},70)},changeSpanClass:function(a,b){parent.CE.Iframe.myThis.gridObj.span.type&&"multiple"===parent.CE.Iframe.myThis.gridObj.span.type&&"undefined"!==typeof a.attr("data-motopress-shortcode")&&(spanNumber=parent.MP.Utils.getSpanNumber(b),a.attr("data-motopress-shortcode",parent.CE.Iframe.myThis.gridObj.span.shortcode[spanNumber-1]));b===parent.CE.Iframe.myThis.gridObj.span.minclass&&(b+=" motopress-clmn-min");a.removeClass(this.gridColumnSizeClassesString+" motopress-clmn-min").addClass(b)},
updateAllHandles:function(){CE.Resizer.myThis.updateBottomInHandleMiddle();CE.Resizer.myThis.updateSplitterHeight();CE.Resizer.myThis.updateHandle();CE.Resizer.myThis.updateHandleMiddle()}})}(jQuery),function(c){can.Construct("CE.DragDrop",{myThis:null,interruptInsert:!1,curHandle:null,setEdgeRow:function(a){c.each(a,function(){c(this).hasClass(parent.CE.Iframe.myThis.gridObj.row.edgeclass)?c(this).addClass("motopress-row-edge"):c(this).find("."+parent.CE.Iframe.myThis.gridObj.row.edgeclass).first().addClass("motopress-row-edge")})},
setEdgeSpan:function(a,b,d){d="undefined"!==typeof d&&d;var e="undefined"!==typeof b&&b?".motopress-filler-content":"[data-motopress-shortcode]",f;c.each(a,function(){f=c(this).find(e).first();f.parent().addClass("motopress-clmn-edge");d&&f.remove()})}},{inited:!1,blockContent:c("<div />",{"class":"motopress-block-content"}),handleTopIn:c("<div />",{"class":"motopress-handle-top-in","data-motopress-position":"top-in"}),handleBottomIn:c("<div />",{"class":"motopress-handle-bottom-in","data-motopress-position":"bottom-in"}),
handleIntermediate:c("<div />",{"class":"motopress-handle-intermediate","data-motopress-position":"intermediate"}),handleLeftOut:c("<div />",{"class":"motopress-handle-left-out","data-motopress-position":"left-out"}),handleRightOut:c("<div />",{"class":"motopress-handle-right-out","data-motopress-position":"right-out"}),handleLeftIn:c("<div />",{"class":"motopress-handle-left-in","data-motopress-position":"left-in"}),handleRightIn:c("<div />",{"class":"motopress-handle-right-in","data-motopress-position":"right-in"}),
handleLeft:c("<div />",{"class":"motopress-outer-handle motopress-handle-left motopress-outer-handle-hidden","data-motopress-position":"left"}),handleRight:c("<div />",{"class":"motopress-outer-handle motopress-handle-right motopress-outer-handle-hidden","data-motopress-position":"right"}),overlay:c("<div />",{"class":"motopress-overlay"}),dragHandle:c("<div />",{"class":"motopress-drag-handle"}),focusArea:c("<div />",{"class":"motopress-focus-area",tabindex:-1}),helper:c("<section />",{"class":"motopress-helper"}),
handleMiddleOut:c("<span />",{"class":"motopress-handle-middle-out","data-motopress-position":"middle-out"}),handleMiddleIn:c("<span />",{"class":"motopress-outer-handle motopress-handle-middle-in motopress-outer-handle-hidden","data-motopress-position":"middle-in"}),emptySceneHelper:c("<section />",{id:"motopress-empty-scene-helper"}),emptySceneDroppable:c("<div />",{"class":"motopress-empty-scene",html:'<div class="motopress-empty-scene-container-first"><div class="motopress-empty-scene-image"></div><div class="motopress-empty-scene-wrapper-right"><div class="motopress-empty-scene-title">'+
localStorage.getItem("CEEmptySceneHelperTitle")+'</div><div class="motopress-empty-scene-content">'+localStorage.getItem("CEEmptySceneHelperContent")+'</div></div></div><div class="motopress-empty-scene-container-second"><div class="motopress-empty-scene-or-label">'+localStorage.getItem("CEEmptySceneHelperOr")+'</div><input type="text" class="motopress-empty-scene-type-here" value="'+localStorage.getItem("CEEmptySceneHelperInputText")+'"></div>'}),templates:c("<div />",{"class":"motopress-templates-container",
html:'<div class="motopress-templates-title"><div class="motopress-templates-separator"><div class="motopress-templates-separator-line"></div></div><div class="motopress-templates-label">'+localStorage.getItem("CEChooseLayout")+'</div><div class="motopress-templates-separator"><div class="motopress-templates-separator-line"></div></div></div><div id="motopress-templates"></div>'}),handleInsert:c("<div />",{"class":"motopress-handle-insert","data-motopress-position":"insert"}),emptySpanOverlay:c("<div />",
{"class":"motopress-overlay"}),emptySpanHelper:c("<section />",{"class":"motopress-helper"}),handleWrapper:c("<div />",{"class":"motopress-handle-wrapper"}),wrapperHelper:c("<section />",{"class":"motopress-wrapper-helper"}),wrapperHelperResizer:c("<section />",{"class":"motopress-helper"}),wrapperId:0,lineHelperIntermediate:c("<div />",{"class":"motopress-line-helper-intermediate"}),lineHelperLeftOut:c("<div />",{"class":"motopress-line-helper-left-out"}),lineHelperRightOut:c("<div />",{"class":"motopress-line-helper-right-out"}),
lineHelperLeft:c("<div />",{"class":"motopress-line-helper-left"}),lineHelperRight:c("<div />",{"class":"motopress-line-helper-right"}),lineHelperLeftIn:c("<div />",{"class":"motopress-line-helper-left-in"}),lineHelperRightIn:c("<div />",{"class":"motopress-line-helper-right-in"}),lineHelperTopIn:c("<div />",{"class":"motopress-line-helper-top-in"}),lineHelperBottomIn:c("<div />",{"class":"motopress-line-helper-bottom-in"}),lineHelperHandleMiddle:c("<div />",{"class":"motopress-line-helper-middle-in"}),
lineHelperInsert:c("<div />",{"class":"motopress-line-helper-insert"}),textHelperIntermediate:c("<div />",{"class":"motopress-text-helper-intermediate",text:localStorage.getItem("helperNewColumn")}),textHelperLeftOut:c("<div />",{"class":"motopress-text-helper-left-out",text:localStorage.getItem("helperNewColumn")}),textHelperRightOut:c("<div />",{"class":"motopress-text-helper-right-out",text:localStorage.getItem("helperNewColumn")}),textHelperLeft:c("<div />",{"class":"motopress-text-helper-left",
text:localStorage.getItem("helperNewColumn")}),textHelperRight:c("<div />",{"class":"motopress-text-helper-right",text:localStorage.getItem("helperNewColumn")}),textHelperLeftIn:c("<div />",{"class":"motopress-text-helper-left-in",text:localStorage.getItem("helperInsert")}),textHelperRightIn:c("<div />",{"class":"motopress-text-helper-right-in",text:localStorage.getItem("helperInsert")}),textHelperTopIn:c("<div />",{"class":"motopress-text-helper-top-in",text:localStorage.getItem("helperInsert")}),
textHelperBottomIn:c("<div />",{"class":"motopress-text-helper-bottom-in",text:localStorage.getItem("helperInsert")}),textHelperHandleMiddle:c("<div />",{"class":"motopress-text-helper-middle-in",text:localStorage.getItem("helperMiddle")}),textHelperInsert:c("<div />",{"class":"motopress-text-helper-insert",text:localStorage.getItem("helperInsert")}),textHelperHalfSize:null,lineHelperThickness:null,lineHelperHalfThickness:null,handleMiddleHalfThickness:null,moreHandler:null,helperContainer:c("<div />",
{"class":"motopress-helper-container"}).appendTo("body"),newBlock:null,spaceClass:"motopress-space",resizer:null,tools:null,wpMore:null,canDrop:!1,spanSizeRules:null,rowHtml:null,rowInnerHtml:null,spanHtml:null,spanInnerHtml:null,bodyEl:c("body"),container:c("#motopress-container"),init:function(){this.setEdges();new CE.Grid(c("#motopress-ce-grid"));this.setupNewBlock();this.resizer=new CE.Resizer;this.tools=new CE.Tools;this.wpMore=CE.WPMore.getInstance();this.generateSpanSizeRules();this.setCalcWrapperWidth(this.helper);
this.setCalcWrapperWidth(this.emptySpanHelper);this.setCalcWrapperWidth(this.wrapperHelper);this.setCalcWrapperWidth(this.wrapperHelperResizer);CE.Grid.myThis.padding&&(this.helper.css("left",CE.Grid.myThis.padding),this.emptySpanHelper.css("left",CE.Grid.myThis.padding),this.wrapperHelperResizer.css("left",CE.Grid.myThis.padding));this.overlay.append(this.handleIntermediate.clone(),this.handleLeft.clone(),this.handleTopIn,this.handleBottomIn,this.handleLeftOut,this.handleRightOut,this.handleLeftIn,
this.handleRightIn,this.handleRight.clone());this.helper.append(this.overlay,this.focusArea.clone(),this.dragHandle.clone(),this.resizer.splitter.clone());this.emptySpanOverlay.append(this.handleIntermediate.clone(),this.handleLeft.clone(),this.handleRight.clone(),this.handleInsert.clone());this.emptySpanHelper.append(this.emptySpanOverlay,this.resizer.splitter.clone());this.wrapperHelper.append(this.handleIntermediate.clone(),this.handleLeft.clone(),this.handleRight.clone());this.wrapperHelperResizer.append(this.resizer.splitter.clone());
var a=setTimeout(function(){CE.DragDrop.myThis.textHelperHalfSize=Math.round(CE.DragDrop.myThis.textHelperHandleMiddle.height()/2);CE.DragDrop.myThis.lineHelperThickness=CE.DragDrop.myThis.lineHelperLeftIn.outerWidth();CE.DragDrop.myThis.lineHelperHalfThickness=Math.round(CE.DragDrop.myThis.lineHelperHandleMiddle.height()/2);CE.DragDrop.myThis.handleMiddleHalfThickness=Math.round(3);clearTimeout(a)},0);this.emptySceneHelper.append(this.emptySceneDroppable,this.templates).appendTo(c(".motopress-content-wrapper"));
this.helperContainer.append(this.lineHelperIntermediate,this.lineHelperLeftOut,this.lineHelperRightOut,this.lineHelperLeft,this.lineHelperRight,this.lineHelperLeftIn,this.lineHelperRightIn,this.lineHelperTopIn,this.lineHelperBottomIn,this.lineHelperHandleMiddle,this.lineHelperInsert,this.textHelperIntermediate,this.textHelperLeftOut,this.textHelperRightOut,this.textHelperLeft,this.textHelperRight,this.textHelperLeftIn,this.textHelperRightIn,this.textHelperTopIn,this.textHelperBottomIn,this.textHelperHandleMiddle,
this.textHelperInsert);this.wpMore.pointAppendTo(this.handleMiddleIn);this.setupDefaultGridHtml();CE.DragDrop.myThis=this;this.main();parent.MP.Preloader.myThis.load(CE.DragDrop.shortName);parent.MP.Preloader.myThis.hide()},setEdges:function(){var a=c(".motopress-content-wrapper .motopress-row").not('.motopress-content-wrapper [data-motopress-group]:not([data-motopress-group="mp_grid"]) .motopress-row');CE.DragDrop.setEdgeRow(a);a=c(".motopress-content-wrapper .motopress-clmn").not('.motopress-content-wrapper [data-motopress-group]:not([data-motopress-group="mp_grid"]) .motopress-clmn');
CE.DragDrop.setEdgeSpan(a.not(".motopress-empty"));CE.DragDrop.setEdgeSpan(a.filter(".motopress-empty"),!0,!0)},setupNewBlock:function(){var a=c(parent.motopressCE.rendered_shortcodes.grid[parent.CE.Iframe.myThis.gridObj.span.shortcode]);a.addClass(parent.CE.Iframe.myThis.gridObj.span.minclass);CE.DragDrop.setEdgeSpan(a,!0,!0);this.newBlock=a},setupDefaultGridHtml:function(){this.spanHtml=c(parent.motopressCE.rendered_shortcodes.grid[parent.CE.Iframe.myThis.gridObj.span.shortcode]);CE.DragDrop.setEdgeSpan(this.spanHtml,
!0);CE.Resizer.myThis.changeSpanClass(this.spanHtml,"");this.spanInnerHtml=c(parent.motopressCE.rendered_shortcodes.grid[parent.CE.Iframe.myThis.gridObj.span.inner]);CE.DragDrop.setEdgeSpan(this.spanInnerHtml,!0);CE.Resizer.myThis.changeSpanClass(this.spanInnerHtml,"");this.rowHtml=c(parent.motopressCE.rendered_shortcodes.grid[parent.CE.Iframe.myThis.gridObj.row.shortcode]);this.rowInnerHtml=c(parent.motopressCE.rendered_shortcodes.grid[parent.CE.Iframe.myThis.gridObj.row.inner])},main:function(){this.inited||
this.sceneEvents();var a=c(".motopress-content-wrapper .motopress-row").not('.motopress-content-wrapper [data-motopress-group]:not([data-motopress-group="mp_grid"]) .motopress-row'),b=c(".motopress-content-wrapper .motopress-clmn").not('.motopress-content-wrapper [data-motopress-group]:not([data-motopress-group="mp_grid"]) .motopress-clmn');this.inited||this.addEmptySceneHelper();this.inited||this.addHandleMoreDisable();this.recursiveAddHandleMiddle(c(".motopress-content-wrapper"));this.makeEditable(b.not(".motopress-empty"));
this.makeRowEditable(a);this.makeEditableEmptySpan(b.filter(".motopress-empty"));this.resizer.updateSplittableOptions(null,null,null,"init");this.resizer.updateAllHandles();this.isEmptyScene()&&CE.Utils.addSceneState("empty-scene");this.inited=!0},isEmptyScene:function(){return!c(".motopress-content-wrapper>.motopress-row").length},addEmptySceneHelper:function(){this.makeEmptySceneHelperDroppable();this.makeEmptySceneHelperFocusable();this.isEmptyScene()&&(this.emptySceneHelper.show(),CE.Utils.removeSceneState("empty-scene"))},
addHandleMoreDisable:function(){var a=c(".motopress-content-wrapper");this.wpMore.pointPrependTo(a,"first");this.wpMore.pointPrependTo(a,"last")},makeEmptySceneHelperFocusable:function(){var a=this;c(".motopress-empty-scene-type-here").off("focusin").on("focusin",function(b){a.emptySceneTypeHereOnFocusein(b,this)})},emptySceneTypeHereOnFocusein:function(a,b){var d=this;this.emptySceneHelper.hide().css("opacity",1);var e=c(b).closest(".motopress-row"),f=this.newBlock.clone();this.resizer.changeSpanClass(f,
parent.CE.Iframe.myThis.gridObj.span.fullclass);var g={helper:c("<div />",{"data-motopress-close-type":CE.LeftBar.myThis.library.mp_text.objects.mp_text.closeType,"data-motopress-shortcode":CE.LeftBar.myThis.library.mp_text.objects.mp_text.id,"data-motopress-group":CE.LeftBar.myThis.library.mp_text.id,"data-motopress-resize":CE.LeftBar.myThis.library.mp_text.objects.mp_text.resize})},l=CE.LeftBar.myThis.library.mp_text.objects.mp_text.parameters;if(!c.isEmptyObject(l)){var h={};c.each(l,function(a){h[a]=
{}});g.helper.attr("data-motopress-parameters",JSON.stringify(h))}l=CE.LeftBar.myThis.getStyleAttrs(CE.LeftBar.myThis.library.mp_text.id,CE.LeftBar.myThis.library.mp_text.objects.mp_text.id);if(!c.isEmptyObject(l)){var m={};c.each(l,function(a){m[a]={}});g.helper.attr("data-motopress-styles",JSON.stringify(m))}this.makeEditable(f,g,!0);e=this.rowHtml.clone().find(".motopress-filler-content").replaceWith(f).end();this.makeRowEditable(e,!0);c(".motopress-content-wrapper").append(e);var k=setTimeout(function(){d.addHandleMiddle(e,
parent.CE.Iframe.myThis.gridObj.span.fullclass);clearTimeout(k)},0),q=setTimeout(function(){CE.Selectable.myThis.select(f.find(".motopress-drag-handle"));d.makeDroppable();d.resizer.updateSplittableOptions(f,null,e);d.resizer.updateAllHandles();clearTimeout(q)},0);parent.CE.Save.changeContent();CE.Utils.removeSceneState("empty-scene")},makeSpanSelectable:function(a){var b=c("<div />",{"class":"motopress-clmn-select-handle"});a.children(".motopress-helper").append(b.clone())},makeRowEditable:function(a,
b){b="undefined"!==typeof b&&b;a.each(function(){var a=c(this);CE.DragDrop.setEdgeRow(a);var e=parent.MP.Utils.getEdgeRow(a);if(!e.children(".motopress-row-helper").length){var f=c("<span />",{"class":"motopress-row-helper"}),g=c("<div />",{"class":"motopress-row-select-handle"});f.append(g.clone());e.append(f.clone());f=a.attr("data-motopress-shortcode");!b&&f||CE.DragDrop.myThis.setAttrs(a)}"undefined"===typeof a.control(CE.Controls)&&a.ce_controls({isNew:b});e=a.control(CE.Controls);!b&&f||!e||
(e.stylesCtrl.setDefaultAttrs(),a="undefined"!==typeof a.attr("data-motopress-parameters")?a.attr("data-motopress-parameters"):null,e.settingsCtrl.setDefaultAttrs(a),e.stylesCtrl.save())})},makeEditable:function(a,b,d){d="undefined"!==typeof d&&d;a.each(function(){var a=c(this);CE.DragDrop.setEdgeSpan(c(this));var f=parent.MP.Utils.getEdgeSpan(a);if(!a.closest(".motopress-block-content").length){CE.DragDrop.myThis.addHelpers(a);CE.DragDrop.myThis.resizer.makeResizable(a);CE.DragDrop.myThis.resizer.makeSplittable(a);
CE.DragDrop.myThis.makeDraggable(a);CE.DragDrop.myThis.makeDroppable();"undefined"!==typeof b&&null!==b&&CE.DragDrop.myThis.setAttrs(a,b);d&&a.addClass("motopress-new-object");a.ce_controls({isNew:d});var g=a.control(CE.Controls);if(d&&g){g.stylesCtrl.setDefaultAttrs();var l="undefined"!==typeof a.attr("data-motopress-parameters")?a.attr("data-motopress-parameters"):null;g.settingsCtrl.setDefaultAttrs(l);g.stylesCtrl.save()}f=f.children(".motopress-block-content");f.length&&(f=f.children("[data-motopress-shortcode]"),
CE.DragDrop.myThis.initShortcodeController(f,d),(f=f.control(CE.Controls))&&(d?f.renderShortcode(d):f.element.trigger("render")));a.children(".motopress-clmn-select-handle").length||CE.DragDrop.myThis.makeSpanSelectable(a)}})},initShortcodeController:function(a,b){var c=a.attr("data-motopress-shortcode");b&&a.addClass("motopress-new-object");switch(c){case "mp_text":case "mp_heading":a.ce_inline_editor({isNew:b});break;case "mp_code":a.ce_code_editor({isNew:b});break;default:a.ce_controls({isNew:b})}},
makeEditableEmptySpan:function(a){if(a.length){CE.DragDrop.setEdgeSpan(a,!0,!0);a.each(function(){c(this).children(".motopress-helper").length||c(this).append(CE.DragDrop.myThis.emptySpanHelper.clone())});var b=setTimeout(function(){CE.DragDrop.myThis.makeDroppable();clearTimeout(b)},0);this.resizer.makeSplittable(a)}},addHelpers:function(a){a.each(function(){var a=c(this),d=parent.MP.Utils.getEdgeSpan(a);if(!d.children(".motopress-block-content").length&&!d.children(".motopress-row").length){d.find("script").remove().end().wrapInner(CE.DragDrop.myThis.blockContent.clone());
d.children(".motopress-block-content").children().length||d.children(".motopress-block-content").append("<div />");var e=d.find(".motopress-block-content > [data-motopress-shortcode]");e.length&&e.attr("data-motopress-shortcode")}a.children(".motopress-helper").length||(d.children(".motopress-row").length?(a.attr("data-motopress-wrapper-id",CE.DragDrop.myThis.wrapperId),CE.DragDrop.myThis.setCalcWrapperWidth(d.children(".motopress-handle-middle-in")),a.prepend(CE.DragDrop.myThis.wrapperHelperResizer.clone()),
d=null,a.closest(".motopress-row").parent(".motopress-content-wrapper").length?(d=CE.DragDrop.myThis.wrapperHelper.clone(),a.prepend(d)):a.closest('.motopress-clmn:has(".motopress-wrapper-helper")').children(".motopress-wrapper-helper"),CE.DragDrop.myThis.wrapperId++):a.append(CE.DragDrop.myThis.helper.clone()))})},setAttrs:function(a,b){this._setAttrs(a);var c=a.find("> .motopress-block-content > div");if(c.length){var e=this.getAttrsFromElement(b.draggable?b.draggable:b.helper);this._setAttrs(c,
e)}},getAttrsFromElement:function(a){var b={closeType:a.attr("data-motopress-close-type"),id:a.attr("data-motopress-shortcode"),group:a.attr("data-motopress-group"),resize:a.attr("data-motopress-resize")},c=a.attr("data-motopress-parameters");"undefined"!==typeof c&&(b.parameters=c);a=a.attr("data-motopress-styles");"undefined"!==typeof a&&(b.styles=a);return b},_setAttrs:function(a,b){if("undefined"===typeof b){var c=null;a.hasClass("motopress-row")?c=a.parent(".motopress-content-wrapper").length?
parent.CE.Iframe.myThis.gridObj.row.shortcode:parent.CE.Iframe.myThis.gridObj.row.inner:"multiple"===parent.CE.Iframe.myThis.gridObj.span.type?(c=parent.MP.Utils.getSpanClass(a.prop("class").split(" ")),c=parent.MP.Utils.getSpanNumber(c),c=parent.CE.Iframe.myThis.gridObj.span.shortcode[c-1]):c=parent.CE.Iframe.myThis.gridObj.span.shortcode;CE.LeftBar.myThis.setAttrs(a,CE.LeftBar.myThis.library.mp_grid.id,CE.LeftBar.myThis.library.mp_grid.objects[c])}else a.attr({"data-motopress-close-type":b.closeType,
"data-motopress-shortcode":b.id,"data-motopress-group":b.group,"data-motopress-resize":b.resize}),b.hasOwnProperty("parameters")&&a.attr("data-motopress-parameters",b.parameters),b.hasOwnProperty("styles")&&a.attr("data-motopress-styles",b.styles)},makeDraggable:function(a){var b=this,d=a.find(".motopress-drag-handle");a.draggable({cursor:"move",distance:5,helper:"clone",handle:".motopress-drag-handle",opacity:"0",zIndex:1,appendTo:".motopress-content-wrapper:first",start:function(a){CE.Utils.addSceneAction("drag");
CE.LeftBar.myThis.disable();CE.LeftBar.myThis.hide();b.showOuterHandles();b.canDrop=!0;CE.Selectable.myThis.unselect(d);c(".motopress-splitter").addClass("motopress-hide");c(this).css("opacity",.3);c(".motopress-content-wrapper .motopress-clmn .motopress-drag-handle").addClass("motopress-start-drag")},stop:function(a,f){CE.Utils.removeSceneAction("drag");CE.LeftBar.myThis.enable();CE.LeftBar.myThis.show();b.hideOuterHandles();c(".motopress-splitter").removeClass("motopress-hide");c(this).css("opacity",
"");c(".motopress-content-wrapper .motopress-clmn .motopress-drag-handle").removeClass("motopress-start-drag");CE.Selectable.myThis.select(d);CE.DragDrop.myThis.helperContainer.children().hide()},drag:function(){CE.DragDrop.myThis.onDrag()}}).removeClass("ui-draggable")},makeDraggableNewBlock:function(){var a=this,b={top:-10,left:-10},d=c(".motopress-content-wrapper:first"),e=d.length?d.offset().top:0;c(".motopress-ce-object").draggable({cursor:"move",cursorAt:b,helper:"clone",zIndex:10002,appendTo:".motopress-content-wrapper:first",
start:function(d,g){CE.Utils.addSceneAction("drag");CE.LeftBar.myThis.disable();CE.LeftBar.myThis.hide();a.showOuterHandles();a.canDrop=!0;g.position.top=d.pageY-e-b.top;var l=c(".motopress-content-wrapper .motopress-clmn .motopress-drag-handle."+CE.Selectable.myThis.selectedClass);l.length&&CE.Selectable.myThis.unselect(l);c(".motopress-empty-scene-type-here").addClass("motopress-empty-scene-type-here-nohover");g.helper.children(".motopress-ce-object-inner").css("cssText","box-shadow: none !important");
c(".motopress-splitter").addClass("motopress-hide");c(".motopress-content-wrapper .motopress-clmn .motopress-drag-handle").addClass("motopress-start-drag");g.helper.data("dropped",!1)},stop:function(b,d){CE.Utils.removeSceneAction("drag");CE.LeftBar.myThis.enable();CE.LeftBar.myThis.show();a.hideOuterHandles();c(".motopress-empty-scene-type-here").removeClass("motopress-empty-scene-type-here-nohover");c(".motopress-splitter").removeClass("motopress-hide");c(".motopress-content-wrapper .motopress-clmn .motopress-drag-handle").removeClass("motopress-start-drag");
!1===d.helper.data("dropped")&&CE.DragDrop.myThis.dropOnStageHandler(b,d)&&parent.CE.Save.changeContent();CE.DragDrop.myThis.helperContainer.children().hide()},drag:function(a,c){c.position.top=a.pageY-e-b.top;CE.DragDrop.myThis.onDrag()}})},onDrag:function(){var a=this.container.find(".motopress-droppable-hover");if(a.length){if(a=a.attr("data-motopress-position"),null!==a){var a=".motopress-line-helper-"+a+", .motopress-text-helper-"+a,b=this.helperContainer.children();b.not(a).hide();b.filter(a).show()}}else this.helperContainer.children().hide()},
dropOnStageHandler:function(a,b){var d=b.helper.hasClass("motopress-ce-object"),e=c(".motopress-content-wrapper").find(".motopress-handle-middle-in:last");if(d&&e&&e.hasClass("motopress-handle-middle-in")){var f,g=CE.DragDrop.myThis,l=g.newBlock.clone();"mp_space"===b.helper.attr("data-motopress-shortcode")&&l.addClass(g.spaceClass);g.makeEditable(l,b,!0);parent.MP.Utils.getSpanClass(l.prop("class").split(" "));f=CE.DragDrop.myThis.rowHtml.clone().find(".motopress-filler-content").replaceWith(l).end();
e.after(f);CE.DragDrop.myThis.makeRowEditable(f,d);var h=setTimeout(function(){g.addHandleMiddle(f,"motopress-content-wrapper");g.resize(void 0,l,"middle");var a=l.find(".motopress-drag-handle");CE.Selectable.myThis.select(a);g.makeDroppable();CE.Resizer.myThis.updateSplittableOptions(l,void 0,f);CE.Resizer.myThis.updateAllHandles();clearTimeout(h)},0);return!0}return!1},makeEmptySceneHelperDroppable:function(){var a=this;this.emptySceneDroppable.droppable({accept:".motopress-ce-object",tolerance:"pointer",
drop:function(b,d){if(a.canDrop)a.canDrop=!1;else return!1;CE.DragDrop.myThis.emptySceneHelper.hide();c(this).css("opacity",1);var e=c(this).closest(".motopress-clmn");0==e.length&&(e=c(this));var f=parent.MP.Utils.getSpanClass(e.prop("class").split(" ")),g=e=null,l=c(this).closest(".motopress-row"),h=null,m=d.draggable.hasClass("motopress-ce-object");m?(h=CE.DragDrop.myThis.newBlock.clone(),"mp_space"===d.draggable.attr("data-motopress-shortcode")&&h.addClass(CE.DragDrop.myThis.spaceClass),CE.DragDrop.myThis.makeEditable(h,
d,!0),g=null):(h=d.draggable,g=h.parent(".motopress-row"));var e=parent.MP.Utils.getSpanClass(h.prop("class").split(" ")),e=CE.DragDrop.myThis.removeEmptyBlocks(h,e),k=!1;null==f&&(f=parent.CE.Iframe.myThis.gridObj.span.fullclass,k=!0);l=CE.DragDrop.myThis.rowHtml.clone().find(".motopress-filler-content").replaceWith(h).end();c(".motopress-content-wrapper").append(l);CE.DragDrop.myThis.makeRowEditable(l,m);var q=setTimeout(function(){g=CE.DragDrop.myThis.clearIfEmpty(g);k&&(f="motopress-content-wrapper");
CE.DragDrop.myThis.addHandleMiddle(l,f);CE.DragDrop.myThis.resize(g,h,"middle");clearTimeout(q)},0),n=setTimeout(function(){var a=h.find(".motopress-drag-handle");CE.Selectable.myThis.select(a);CE.DragDrop.myThis.makeDroppable();CE.Resizer.myThis.updateSplittableOptions(h,g,l);CE.Resizer.myThis.updateAllHandles();clearTimeout(n)},0);parent.CE.Save.changeContent();CE.Utils.removeSceneState("empty-scene")},over:function(){c(this).css("opacity",.5)},out:function(){c(this).css("opacity",1)}})},makeDroppable:function(){var a=
this;c(".motopress-content-wrapper").find(".motopress-handle-intermediate, .motopress-handle-left, .motopress-handle-top-in, .motopress-handle-bottom-in, .motopress-handle-left-out, .motopress-handle-right-out, .motopress-handle-left-in, .motopress-handle-right-in, .motopress-handle-middle-in, .motopress-handle-insert, .motopress-handle-right").droppable({accept:".motopress-clmn, .motopress-ce-object",tolerance:"pointer",hoverClass:"motopress-droppable-hover",drop:function(b,d){var e=c(this).attr("data-motopress-position");
if("undefined"!==typeof a.hoveredHandles&&1<a.hoveredHandles.length&&a.hoveredHandles.filter(".motopress-handle-left, .motopress-handle-right").length)if(-1<c.inArray(e,["left","right"]))a.canDrop=!0;else return!1;if(a.canDrop)a.canDrop=!1;else return!1;d.helper.data("dropped",!0);var f=c(this).closest(".motopress-clmn");0===f.length&&(f=c(this));var g=parent.MP.Utils.getSpanClass(f.prop("class").split(" ")),l=null,h=null,m=c(this).closest(".motopress-row"),l=parent.MP.Utils.getEdgeRow(m),k=null,
q=null,n=null,p=null,r=d.draggable.hasClass("motopress-ce-object");r?(n=null,p=CE.DragDrop.myThis.newBlock.clone(),"mp_space"===d.draggable.attr("data-motopress-shortcode")&&p.addClass(CE.DragDrop.myThis.spaceClass),CE.DragDrop.myThis.makeEditable(p,d,!0),h=null):(n=d,p=n.draggable,h=p.closest(".motopress-row"));var t,q=null;null!==h&&(k=parent.MP.Utils.getEdgeRow(h).children(".motopress-clmn").index(p),q=p.prev(),q.length&&q.hasClass("motopress-empty")&&k--);q=l.children(".motopress-clmn");l=parent.MP.Utils.getSpanClass(p.prop("class").split(" "));
l=CE.DragDrop.myThis.removeEmptyBlocks(p,l);switch(e){case "top-in":if(!1!==(t=CE.DragDrop.myThis.canBeMoved(h,null,k,0,n))){e=CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(p).end();k=CE.DragDrop.myThis.spanHtml.clone().addClass(g);CE.DragDrop.setEdgeSpan(k);f.before(k);var u=CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(f).end();k.find(".motopress-filler-content").replaceWith(u);u.before(e);CE.DragDrop.myThis.makeRowEditable(e.add(u),
r);k.attr({"data-motopress-wrapper-id":CE.DragDrop.myThis.wrapperId}).prepend(CE.DragDrop.myThis.wrapperHelperResizer.clone());CE.DragDrop.myThis.resizer.makeSplittable(k);f=null;k.closest(".motopress-row").parent(".motopress-content-wrapper").length?(f=CE.DragDrop.myThis.wrapperHelper.clone(),k.prepend(f)):f=k.closest('.motopress-clmn:has(".motopress-wrapper-helper")').children(".motopress-wrapper-helper");CE.DragDrop.myThis.makeEditable(k,d,!0);CE.DragDrop.myThis.wrapperId++;var v=setTimeout(function(){h=
CE.DragDrop.myThis.clearIfEmpty(h);CE.DragDrop.myThis.addHandleMiddle(u,g);CE.DragDrop.myThis.resize(h,p,"top-in",t);clearTimeout(v)},0)}break;case "bottom-in":!1!==(t=CE.DragDrop.myThis.canBeMoved(h,null,k,0,n))&&(e=CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(p).end(),k=CE.DragDrop.myThis.spanHtml.clone().addClass(g),CE.DragDrop.setEdgeSpan(k),f.before(k),u=CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(f).end(),k.find(".motopress-filler-content").replaceWith(u),
u.after(e),CE.DragDrop.myThis.makeRowEditable(e.add(u),r),k.attr({"data-motopress-wrapper-id":CE.DragDrop.myThis.wrapperId}).prepend(CE.DragDrop.myThis.wrapperHelperResizer.clone()),CE.DragDrop.myThis.resizer.makeSplittable(k),f=null,k.closest(".motopress-row").parent(".motopress-content-wrapper").length?(f=CE.DragDrop.myThis.wrapperHelper.clone(),k.prepend(f)):f=k.closest('.motopress-clmn:has(".motopress-wrapper-helper")').children(".motopress-wrapper-helper"),CE.DragDrop.myThis.makeEditable(k,d,
!0),CE.DragDrop.myThis.wrapperId++,v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);CE.DragDrop.myThis.addHandleMiddle(u,g);CE.DragDrop.myThis.resize(h,p,"bottom-in",t);clearTimeout(v)},0));break;case "left-out":case "left":case "intermediate":q="left"===e?0:q.index(f);!1!==(t=CE.DragDrop.myThis.canBeMoved(h,m,k,0>q?0:q,n,"out"))&&(f.parent().length&&f.before(p),v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);if(null===h||h[0]!==m[0])CE.DragDrop.myThis.resize(h,p,"left-out",
t);else{var a=parent.MP.Utils.calcSpanNumber(h,n);CE.Resizer.myThis.changeSpanClass(p,parent.CE.Iframe.myThis.gridObj.span["class"]+(parent.CE.Iframe.myThis.gridObj.row.col-a))}clearTimeout(v)},0));break;case "right-out":case "right":q="right"===e?q.length:q.index(f)+1;!1!==(t=CE.DragDrop.myThis.canBeMoved(h,m,k,q,n,"out"))&&(f.parent().length&&f.after(p),v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);if(null===h||h[0]!==m[0])CE.DragDrop.myThis.resize(h,p,"right-out",t);else{var a=parent.MP.Utils.calcSpanNumber(h,
n);CE.Resizer.myThis.changeSpanClass(p,parent.CE.Iframe.myThis.gridObj.span["class"]+(parent.CE.Iframe.myThis.gridObj.row.col-a))}clearTimeout(v)},0));break;case "left-in":q=0;1<parent.MP.Utils.getSpanNumber(g)&&!1!==(t=CE.DragDrop.myThis.canBeMoved(h,m,k,q,n,"left-in",f))&&(k=CE.DragDrop.myThis.spanHtml.clone().addClass(g),CE.DragDrop.setEdgeSpan(k),f.before(k),u=CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(f).end(),k.find(".motopress-filler-content").replaceWith(u),
f.before(p),CE.DragDrop.myThis.makeRowEditable(u,r),k.attr({"data-motopress-wrapper-id":CE.DragDrop.myThis.wrapperId}).prepend(CE.DragDrop.myThis.wrapperHelperResizer.clone()),CE.DragDrop.myThis.resizer.makeSplittable(k),f=null,k.closest(".motopress-row").parent(".motopress-content-wrapper").length?(f=CE.DragDrop.myThis.wrapperHelper.clone(),k.prepend(f)):f=k.closest('.motopress-clmn:has(".motopress-wrapper-helper")').children(".motopress-wrapper-helper"),CE.DragDrop.myThis.makeEditable(k,d,!0),CE.DragDrop.myThis.wrapperId++,
v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);CE.DragDrop.myThis.addHandleMiddle(u,g);CE.DragDrop.myThis.resize(h,p,"left-in",t);clearTimeout(v)},0));break;case "right-in":q=1;1<parent.MP.Utils.getSpanNumber(g)&&!1!==(t=CE.DragDrop.myThis.canBeMoved(h,m,k,q,n,"right-in",f))&&(k=CE.DragDrop.myThis.spanHtml.clone().addClass(g),CE.DragDrop.setEdgeSpan(k),f.before(k),u=CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(f).end(),k.find(".motopress-filler-content").replaceWith(u),
f.after(p),CE.DragDrop.myThis.makeRowEditable(u,r),k.attr({"data-motopress-wrapper-id":CE.DragDrop.myThis.wrapperId}).prepend(CE.DragDrop.myThis.wrapperHelperResizer.clone()),CE.DragDrop.myThis.resizer.makeSplittable(k),f=null,k.closest(".motopress-row").parent(".motopress-content-wrapper").length?(f=CE.DragDrop.myThis.wrapperHelper.clone(),k.prepend(f)):f=k.closest('.motopress-clmn:has(".motopress-wrapper-helper")').children(".motopress-wrapper-helper"),CE.DragDrop.myThis.makeEditable(k,d,!0),CE.DragDrop.myThis.wrapperId++,
v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);CE.DragDrop.myThis.addHandleMiddle(u,g);CE.DragDrop.myThis.resize(h,p,"right-in",t);clearTimeout(v)},0));break;case "middle-in":if(!1!==(t=CE.DragDrop.myThis.canBeMoved(h,null,k,0,n))){var s=!1;null==g&&(g=parent.CE.Iframe.myThis.gridObj.span.fullclass+" motopress-clmn",s=!0);var x=parseInt(c(this).css("min-height"));c(this).siblings(".motopress-handle-middle-in").add(this).each(function(){c(this).height(x)});c(".motopress-content-wrapper > .motopress-handle-middle-in:last").height("");
m=c(this).parent(".motopress-content-wrapper").length?CE.DragDrop.myThis.rowHtml.clone().find(".motopress-filler-content").replaceWith(p).end():CE.DragDrop.myThis.rowInnerHtml.clone().find(".motopress-filler-content").replaceWith(p).end();c(this).after(m);CE.DragDrop.myThis.makeRowEditable(m,r);l=parent.MP.Utils.getEdgeRow(m);v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);s&&(g="motopress-content-wrapper");CE.DragDrop.myThis.addHandleMiddle(m,g);CE.DragDrop.myThis.resize(h,p,"middle",
t);clearTimeout(v)},0)}break;case "insert":r=parent.MP.Utils.getSpanClass(f.prop("class").split(" ")),f.parent().length&&f.replaceWith(p),a.resizer.changeSpanClass(p,r),q=q.index(f),h&&(t=CE.DragDrop.myThis.canBeMoved(h,null,k,q,n,"insert"),v=setTimeout(function(){h=CE.DragDrop.myThis.clearIfEmpty(h);CE.DragDrop.myThis.resize(h,p,"insert",t);clearTimeout(v)},0))}var y=setTimeout(function(){var b=p.find(".motopress-drag-handle");CE.Selectable.myThis.select(b);CE.DragDrop.myThis.makeDroppable();CE.Resizer.myThis.updateSplittableOptions(p,
h,m);CE.Resizer.myThis.updateAllHandles();c(window).trigger("resize");var d,e={involvedElements:{}};e.droppedElement=p;h&&h.length&&(b=h.find(".motopress-block-content > [data-motopress-shortcode]"),b.length&&b.each(function(){d=c(this).attr("data-motopress-shortcode");e.involvedElements.hasOwnProperty(d)||(e.involvedElements[d]=[]);-1===c.inArray(this,e.involvedElements[d])&&e.involvedElements[d].push(this)}));m&&m.length&&(b=m.find(".motopress-block-content > [data-motopress-shortcode]"),b.length&&
b.each(function(){d=c(this).attr("data-motopress-shortcode");e.involvedElements.hasOwnProperty(d)||(e.involvedElements[d]=[]);-1===c.inArray(this,e.involvedElements[d])&&e.involvedElements[d].push(this)}));a.bodyEl.trigger("MPCEObjectDrop",e);clearTimeout(y)},0);parent.CE.Save.changeContent()},over:function(){a.hoveredHandles=a.container.find(".motopress-droppable-hover");var b=c(this).attr("data-motopress-position"),d="middle-in"!==b?c(this).closest(".motopress-clmn"):c(this);CE.DragDrop.myThis.showLineTextHelper(d,
b)},out:function(){a.hoveredHandles=a.container.find(".motopress-droppable-hover");c(this).attr("data-motopress-position");a.onDrag()}})},showLineTextHelper:function(a,b){var d=a.offset(),e=d.left,f=d.top,d=a.closest(".motopress-row"),g=parent.MP.Utils.getEdgeRow(d),d=g.height(),l=g.offset().top,h=parseFloat(g.css("border-top-width")),g=parseFloat(g.css("padding-top")),m,k,q,n;0<=c.inArray(b,["intermediate","left-out","right-out","left","right"])&&(q=Math.floor(a.children(".motopress-helper, .motopress-wrapper-helper").find(".motopress-handle-intermediate").width()),
4<q?(m=2,k=q-4,q-=m):(m=1,k=q),n=0,CE.Grid.myThis.padding||(n=m/2));switch(b){case "intermediate":this.lineHelperIntermediate.css({width:k,height:d,top:l+g+h,left:Math.ceil(e+CE.Grid.myThis.padding-q-n)}).show();this.textHelperIntermediate.css({top:this.lineHelperIntermediate.offset().top,left:this.lineHelperIntermediate.offset().left+k}).show();break;case "left":case "left-out":"left"===b?(f=this.lineHelperLeft,n=this.textHelperLeft):(f=this.lineHelperLeftOut,n=this.textHelperLeftOut);q=e+CE.Grid.myThis.padding+
1;k=0;f.css({width:k,height:d,top:l+g+h,left:q}).show();n.css({top:f.offset().top,left:q+k}).show();break;case "right":case "right-out":"right"===b?(f=this.lineHelperRight,n=this.textHelperRight):(f=this.lineHelperRightOut,n=this.textHelperRightOut);k=c(document).width();q=e+a.outerWidth()-CE.Grid.myThis.padding;q>=k&&(q=k-1);k=0;e=q-n.outerWidth();f.css({width:k,height:d,top:l+g+h,left:q}).show();n.css({top:f.offset().top,left:e}).show();break;case "left-in":this.lineHelperLeftIn.css({height:a.outerHeight(),
top:f,left:e+CE.Grid.myThis.padding}).show();this.textHelperLeftIn.css({top:this.lineHelperLeftIn.offset().top,left:this.lineHelperLeftIn.offset().left+this.lineHelperThickness}).show();break;case "right-in":this.lineHelperRightIn.css({height:a.outerHeight(),top:f,left:e+a.outerWidth()-this.lineHelperThickness-CE.Grid.myThis.padding}).show();this.textHelperRightIn.css({top:this.lineHelperRightIn.offset().top,left:this.lineHelperRightIn.offset().left-this.textHelperRightIn.outerWidth()}).show();break;
case "top-in":this.lineHelperTopIn.css({width:a.outerWidth(),top:f,left:e}).show();this.textHelperTopIn.css({top:f,left:e}).show();break;case "bottom-in":this.lineHelperBottomIn.css({width:a.outerWidth(),top:f+a.outerHeight()-this.lineHelperThickness,left:e}).show();this.textHelperBottomIn.css({top:this.lineHelperBottomIn.offset().top,left:this.lineHelperBottomIn.offset().left}).show();break;case "middle-in":q=a.outerWidth();k=a.height()-2*parseInt(this.lineHelperHandleMiddle.css("outline-width"));
d=f+parseInt(this.lineHelperHandleMiddle.css("outline-width"));l=e-CE.Grid.myThis.padding;e=c(".motopress-content-wrapper > .motopress-handle-middle-in:first");if(a[0]===e[0]||a[0]===c(".motopress-content-wrapper > .motopress-handle-middle-in:last")[0])k=c(".motopress-content-wrapper"),l=k.offset(),k.find(".motopress-row"),q=k.width(),k=20,a[0]===e[0]&&(d=l.top-k),l=l.left-CE.Grid.myThis.padding;this.lineHelperHandleMiddle.css({width:q+2*CE.Grid.myThis.padding,height:k,top:d,left:l}).show();e=this.lineHelperHandleMiddle.offset();
this.textHelperHandleMiddle.css({top:e.top,left:e.left}).show();break;case "insert":q=e+CE.Grid.myThis.padding,e=q-this.textHelperInsert.outerWidth(),0>e&&(e=q+a.width()+1),this.lineHelperInsert.css({width:a.width(),height:a.outerHeight(),left:q,top:f}).show(),this.textHelperInsert.css({top:this.lineHelperInsert.offset().top,left:e}).show()}},removeEmptyBlocks:function(a,b){var c=a.prev(".motopress-empty"),e=a.next(".motopress-empty"),f=0,g=0;"undefined"!=typeof c[0]&&(f=parent.MP.Utils.getSpanNumber(parent.MP.Utils.getSpanClass(c.prop("class").split(" "))));
"undefined"!=typeof e[0]&&(g=parent.MP.Utils.getSpanNumber(parent.MP.Utils.getSpanClass(e.prop("class").split(" "))));if("undefined"!=typeof c[0]||"undefined"!=typeof e[0])a.removeClass(b),b=parent.CE.Iframe.myThis.gridObj.span["class"]+(parent.MP.Utils.getSpanNumber(b)+f+g),a.addClass(b),c.remove(),e.remove();return b},clearIfEmpty:function(a,b){"undefined"===typeof b&&(b="default");if(null!==a){var d=parent.MP.Utils.getEdgeRow(a),e=a.parent(),d=d.children(".motopress-clmn");if(!d.length){for(d=
0;0===a.parent(".motopress-content-wrapper").length&&!a.siblings(".motopress-row, .motopress-clmn").length&&!a.parent(".motopress-content-wrapper").length;){if(a.parent(".motopress-clmn").length){var f=a.parent(".motopress-clmn").attr("data-motopress-wrapper-id");c('[data-motopress-wrapper-id="'+f+'"].motopress-handle-wrapper').remove()}a.siblings(".motopress-handle-middle-in, .motopress-wrapper-helper, .motopress-helper").remove().end().unwrap();d++;if(100===d){console.log("LOOPED IN `clearIfEmpty()`");
break}}d=!1;f=null;a.siblings(".motopress-row").length||(d=!0,a.parent(":not(.motopress-content-wrapper)").length?f=a.parent():a.parent(".motopress-row").length&&(f=a.parent(".motopress-row")));a.prev(".motopress-handle-middle-in").remove().end().remove();if("undefined"!==typeof e&&null!==e&&!e.hasClass("motopress-content-wrapper")){var g=e.children(".motopress-row");if(1===g.length&&(g=parent.MP.Utils.getEdgeRow(g).children(".motopress-clmn:not(.motopress-empty)"),1===g.length)){parent.MP.Utils.getSpanClass(g.prop("class").split(" "));
var l=parent.MP.Utils.getSpanClass(e.prop("class").split(" "));CE.Resizer.myThis.changeSpanClass(g,l);e.replaceWith(g)}}return d?f:a}if(1===d.length&&!a.parent(".motopress-content-wrapper").length){var h,m,k,q=null;d.parentsUntil(".motopress-content-wrapper",".motopress-clmn").each(function(){h=c(this).children(".motopress-row");m=c(this).siblings(".motopress-clmn");k=c(this).closest(".motopress-row").parent(".motopress-content-wrapper");if(1===h.length&&(m.length||k.length))return q=c(this),!1});
null!==q&&(parent.MP.Utils.getSpanClass(d.prop("class").split(" ")),e=parent.MP.Utils.getSpanClass(q.prop("class").split(" ")),CE.Resizer.myThis.changeSpanClass(d,e),q.replaceWith(d),a="remove"===b?{row:q.parent()}:null)}}return a},recursiveAddHandleMiddle:function(a){a.children(".motopress-row").each(function(a){var d=CE.DragDrop.myThis.handleMiddleIn;0==a&&c(this).before(d.clone());c(this).next(".mpce-wp-more-tag").length?c(this).next(".mpce-wp-more-tag").after(d.clone()):c(this).after(d.clone());
parent.MP.Utils.getEdgeRow(c(this)).children(".motopress-clmn").each(function(){parent.MP.Utils.getEdgeSpan(c(this)).children(".motopress-row").length&&CE.DragDrop.myThis.recursiveAddHandleMiddle(parent.MP.Utils.getEdgeSpan(c(this)))})})},addHandleMiddle:function(a,b){a.parent(("undefined"===typeof b?"":"."+b)+".motopress-clmn, .motopress-content-wrapper").children(".motopress-row").each(function(a){var b=null,b=CE.DragDrop.myThis.handleMiddleIn;0==a&&(a=c(this).prevAll(".motopress-handle-middle-in"),
0==a.length?(c(this).before(b.clone()),c(this).parent().is("[data-motopress-wrapper-id]")&&CE.DragDrop.myThis.setCalcWrapperWidth(c(this).prev())):a.each(function(a,b){0!=a&&c(b).remove()}));b=b.clone();a=c(this).nextUntil(".motopress-row",".motopress-handle-middle-in");0==a.length?(c(this).next(".mpce-wp-more-tag").length?c(this).next(".mpce-wp-more-tag").after(b):c(this).after(b),c(this).parent().is("[data-motopress-wrapper-id]")&&CE.DragDrop.myThis.setCalcWrapperWidth(b)):a.each(function(a,b){0!=
a&&c(b).remove()})})},getMinAllowedSpanSize:function(a,b,c){for(var e=1,f,g=1;g<=parent.CE.Iframe.myThis.gridObj.row.col;g++)if(e=g,b){if(f=a/100*CE.Grid.myThis.colWidthByNumber[g],this.resizer.isAllowedColSize(c,f))break}else if(this.resizer.isAllowedColSize(g,a))break;return e},canBeMoved:function(a,b,d,e,f,g,l,h){var m,k;k="undefined"===typeof a||a instanceof jQuery&&!a.length?parent.MP.Utils.getEdgeRow(a):a=null;m="undefined"===typeof b||b instanceof jQuery&&!b.length?parent.MP.Utils.getEdgeRow(b):
b=null;d="undefined"===typeof d?null:d;e="undefined"===typeof e?null:e;f="undefined"===typeof f?null:f;g="undefined"===typeof g?!1:g;h="undefined"===typeof h?!1:h;l="undefined"===typeof l?null:l;var q={},n=parent.CE.Iframe.myThis.gridObj.row.col,p=0,r=!0;if(null!==b){if(g&&"out"===g&&null!==k&&k[0]===m[0])return!0;m.children(".motopress-clmn").each(function(){parent.MP.Utils.notClone(c(this),f)&&p++})}if(p<n||null===m){var t=this,u,v,s,x,y,z,J,G=[];b=[];var D,E,I=null,K=null,B=[],A=[],F=0;if(null!==
a){u=-1;D=parseFloat(a.css("width"));F=k.children(".motopress-clmn");a=F.length-1;J=!0;g&&"insert"===g&&(a++,m=null,J=!1);var M=!1;if(m){var w=m.closest(".motopress-row-edge");k[0]===w[0]&&(M=!0)}if(1<=a){var L=this.getMinAllowedSpanSize(D,!1);z=y=0;x=!1;v=t.getSpanSizeRules(a);var N=!1;!g||"left-in"!==g&&"right-in"!==g||(N=!0);F.each(function(a){a===d&&J||(u++,s={},s.index=u,s.isWrapper=c(this).is("[data-motopress-wrapper-id]"),s.size=v[u],s.isWrapper?(M&&c(this).find(".motopress-row-edge").each(function(){c(this)[0]===
m[0]&&(I=u)}),s.wrapperWidth=D/100*CE.Grid.myThis.colWidthByNumber[v[u]],s.minSpan=t.resizer.getMinChildColumn(c(this)),s.minSize=t.getMinAllowedSpanSize(D,!0,s.minSpan),s.isAllowed=t.resizer.isAllowedColSize(s.minSpan,s.wrapperWidth)):(s.minSize=L,N&&this===l[0]&&1>=s.minSize&&(s.minSize=2),s.isAllowed=t.resizer.isAllowedColSize(v[u],D)),s.size<s.minSize?y+=s.minSize-s.size:z+=s.size-s.minSize,x||s.isAllowed||(x=!0),B.push(s))});if(x)if(y>z)r=!1;else{for(F=a=k=0;2*y!==k+a;){for(w=0;w<B.length;w++)B[w].isAllowed&&
B[w].size>B[w].minSize&&k<y?(B[w].size--,k++):!B[w].isAllowed&&B[w].size<B[w].minSize&&(B[w].size++,a++);if(50<=++F){r=!1;break}}for(w=0;w<B.length;w++)G.push(B[w].size);q.from=G}null!==I&&(K=G.length?D/100*CE.Grid.myThis.colWidthByNumber[G[I]]:D/100*CE.Grid.myThis.colWidthByNumber[v[I]])}}if(r){var H;if(g&&"out"!==g&&"insert"!==g)switch(g){case "left-in":case "right-in":for(E=parseFloat(l.css("width")),v=t.getSpanSizeRules(2),w=0;w<v.length;w++)if(H=this.getMinAllowedSpanSize(E,!1,v[w]),v[w]<H){r=
!1;break}}else if(null!==m){E=K?K:parseFloat(m.css("width"));g=m.children(".motopress-clmn");var G=g.length,C;u=-1;v=t.getSpanSizeRules(p+1);H=this.getMinAllowedSpanSize(E,!1);z=y=0;x=!1;C={index:e,isWrapper:!1,size:v[e],minSize:H,isAllowed:v[e]>=H};C.size<C.minSize?y+=C.minSize-C.size:z+=C.size-C.minSize;g.each(function(a){u++;a===e&&(A.push(C),x||C.isAllowed||(x=!0),u++);s={};s.index=u;s.isWrapper=c(this).is("[data-motopress-wrapper-id]");s.size=v[u];s.isWrapper?(s.wrapperWidth=E/100*CE.Grid.myThis.colWidthByNumber[v[u]],
s.minSpan=t.resizer.getMinChildColumn(c(this)),s.minSize=t.getMinAllowedSpanSize(E,!0,s.minSpan),s.isAllowed=t.resizer.isAllowedColSize(s.minSpan,s.wrapperWidth)):(s.minSize=H,s.isAllowed=t.resizer.isAllowedColSize(v[u],E));s.size<s.minSize?y+=s.minSize-s.size:z+=s.size-s.minSize;x||s.isAllowed||(x=!0);A.push(s)});e===G&&(A.push(C),x||C.isAllowed||(x=!0));if(x)if(y>z)r=!1;else{for(F=a=k=0;2*y!==k+a;){for(w=0;w<A.length;w++)A[w].isAllowed&&A[w].size>A[w].minSize&&k<y?(A[w].size--,k++):!A[w].isAllowed&&
A[w].size<A[w].minSize&&(A[w].size++,a++);if(50<=++F){r=!1;break}}for(w=0;w<A.length;w++)b.push(A[w].size);q.to=b}}}}return p>=n||!r?(CE.DragDrop.interruptInsert=!0,h||(parent.MP.Flash.setFlash(localStorage.getItem("blocksOverflow"),"error"),parent.MP.Flash.showMessage()),!1):Object.keys(q).length?q:!0},resize:function(a,b,d,e){e="object"===typeof e?e:{};var f=null;if(null!==a&&"undefined"!==typeof a){a=parent.MP.Utils.getEdgeRow(a).children(".motopress-clmn");var g=a.length;0<g&&g<=parent.CE.Iframe.myThis.gridObj.row.col&&
(f=e.hasOwnProperty("from")?e.from:this.getSpanSizeRules(g),a.each(function(a){parent.MP.Utils.getSpanClass(c(this).prop("class").split(" "));CE.Resizer.myThis.changeSpanClass(c(this),parent.CE.Iframe.myThis.gridObj.span["class"]+f[a])}))}if("undefined"===typeof d||"undefined"!==typeof d&&"insert"!==d)a=b.parent(),null!==a&&"undefined"!==typeof a&&(a=a.children(".motopress-clmn"),g=a.length,0<g&&g<=parent.CE.Iframe.myThis.gridObj.row.col&&(f=e.hasOwnProperty("to")?e.to:this.getSpanSizeRules(g),a.each(function(a){parent.MP.Utils.getSpanClass(c(this).prop("class").split(" "));
CE.Resizer.myThis.changeSpanClass(c(this),parent.CE.Iframe.myThis.gridObj.span["class"]+f[a])})));"undefined"===typeof d||"top-in"!==d&&"bottom-in"!==d||(parent.MP.Utils.getSpanClass(b.prop("class").split(" ")),CE.Resizer.myThis.changeSpanClass(b,parent.CE.Iframe.myThis.gridObj.span.fullclass),d="top-in"===d?1:0,b=b.closest(".motopress-row").parent(".motopress-clmn").children(".motopress-row").get(d),b=c(b),b=parent.MP.Utils.getEdgeRow(b).children(".motopress-clmn"),"undefined"!==typeof b&&b.length&&
(parent.MP.Utils.getSpanClass(b.prop("class").split(" ")),CE.Resizer.myThis.changeSpanClass(b,parent.CE.Iframe.myThis.gridObj.span.fullclass)))},getSpanSizeRules:function(a){return this.spanSizeRules[a]},generateSpanSizeRules:function(){for(var a=parent.CE.Iframe.myThis.gridObj.row.col,b=[],c=1;c<=a;c++){b[c]=[];for(var e=Math.floor(a/c),f=a%c,g=1;g<=c;g++)b[c].push(g<=f?e+1:e)}this.spanSizeRules=b},setCalcWrapperWidth:function(a){if(CE.Grid.myThis.padding){var b=2*CE.Grid.myThis.padding,c="";parent.MP.Utils.Browser.Mozilla?
c="-moz-":parent.MP.Utils.Browser.Chrome&&(c="-webkit-");a.css("width",c+"calc(100% - "+b+"px)")}},sceneEvents:function(){this.container.off("hover").hover(function(){CE.Utils.addSceneAction("container-hover")},function(){CE.Utils.removeSceneAction("container-hover")})},hideOuterHandles:function(){c(".motopress-outer-handle").addClass("motopress-outer-handle-hidden")},showOuterHandles:function(){c(".motopress-outer-handle").removeClass("motopress-outer-handle-hidden")}})}(jQuery),function(c){CE.Template=
can.Control.extend({myThis:null,templates:null},{template:c("<div />",{"class":"motopress-template",html:'<img class="motopress-template-icon"><p class="motopress-template-name"></p>'}),init:function(a,b){CE.Template.myThis=this;if(null!==CE.Template.templates){var d=this,e=[];c.each(CE.Template.templates,function(a,b){var c=d.template.clone();c.attr("data-motopress-template-id",b.id);c.children(".motopress-template-icon").attr("src",b.icon);c.children(".motopress-template-name").text(b.name);e.push(c)});
this.element.append(e)}},".motopress-template click":function(a,b){var d=a.attr("data-motopress-template-id");d&&(parent.MP.Preloader.myThis.show(),c.ajax({url:parent.motopress.ajaxUrl,type:"POST",dataType:"html",data:{action:"motopress_ce_render_template",nonce:parent.motopressCE.nonces.motopress_ce_render_template,postID:parent.motopressCE.postID,templateId:d},success:function(a){CE.Utils.removeSceneState("empty-scene");var b=c(a).find(".motopress-ce-private-styles-updates-wrapper").andSelf().filter(".motopress-ce-private-styles-updates-wrapper").children("style");
CE.ShortcodePrivateStyle.addRenderedStyleTags(b);a=c(a).find(".motopress-ce-rendered-content-wrapper").andSelf().filter(".motopress-ce-rendered-content-wrapper").html();CE.DragDrop.myThis.emptySceneHelper.hide();CE.DragDrop.myThis.emptySceneHelper.before(a);parent.CE.Iframe.myThis.unwrapGrid();CE.DragDrop.myThis.setEdges();CE.DragDrop.myThis.main();parent.CE.Save.changeContent();parent.MP.Preloader.myThis.hide()},error:function(a){parent.MP.Preloader.myThis.hide();a=c.parseJSON(a.responseText);a.debug?
console.log(a.message):(parent.MP.Flash.setFlash(a.message,"error"),parent.MP.Flash.showMessage())}}))}})}(jQuery),function(c){CE.Selectable=can.Construct({myThis:null,scrollY:0,focusFlag:!1,blurFlag:!1,setScrollY:function(a){CE.Selectable.scrollY=a},focusWithoutScroll:function(a){if(!CE.Selectable.focusFlag){CE.Selectable.focusFlag=!0;a.focus();window.scrollTo(0,CE.Selectable.scrollY);var b=setTimeout(function(){CE.Selectable.focusFlag=!1;clearTimeout(b)},0)}return a},blurWithoutScroll:function(a){if(!CE.Selectable.blurFlag){CE.Selectable.blurFlag=
!0;a.blur();window.scrollTo(0,CE.Selectable.scrollY);var b=setTimeout(function(){CE.Selectable.blurFlag=!1;clearTimeout(b)},0)}return a}},{selectedClass:"motopress-selected",init:function(){CE.Selectable.myThis=this;c(document).mousedown(function(){CE.Selectable.setScrollY(window.scrollY)});c(document).mouseup(function(){CE.Selectable.setScrollY(window.scrollY)});this.makeSelectable()},makeSelectable:function(){c(".motopress-content-wrapper").on("click",".motopress-drag-handle, .motopress-clmn-select-handle, .motopress-row-select-handle",
function(){if(c(this).hasClass(".motopress-clmn-select-handle")&&c(this).closest(".motopress-clmn").hasClass(CE.Selectable.myThis.selectedClass)||c(this).hasClass(".motopress-row-select-handle")&&c(this).closest(".motopress-row").hasClass(CE.Selectable.myThis.selectedClass)||c(this).hasClass(CE.Selectable.myThis.selectedClass)){var a=null,a=c(this).hasClass(".motopress-row-select-handle")?c(this).closest(".motopress-row"):c(this).hasClass(".motopress-clmn-select-handle")?c(this).closest(".motopress-clmn"):
c(this).closest(".motopress-clmn").find(".motopress-block-content").first().children("[data-motopress-shortcode]"),b=a.control(),b=a.hasClass("ce_inline_editor")?b.isOpen:!1;!(a.hasClass("ce_controls")||a.hasClass("ce_inline_editor")||a.hasClass("ce_code_editor")||a.hasClass(".motopress-row"))||CE.Dialog.myThis.element.dialog("isOpen")||parent.CE.CodeModal.myThis.element.data("modal").isShown||b||CE.Dialog.myThis.open(c(this))}else CE.Selectable.myThis.select(c(this));CE.Selectable.focusWithoutScroll(c(this).prev())});
c(".motopress-content-wrapper").on("keydown",".motopress-focus-area",function(a){if(c(this).next().hasClass(CE.Selectable.myThis.selectedClass))if(a.which===c.ui.keyCode.ESCAPE)CE.Selectable.setScrollY(window.scrollY),CE.Selectable.myThis.unselect();else if(a.which===c.ui.keyCode.DELETE||a.which===c.ui.keyCode.BACKSPACE)a.preventDefault(),CE.Selectable.setScrollY(window.scrollY),CE.Tools.myThis.removeBlock(),parent.CE.Save.changeContent()});c(document).on("click",function(a){c(a.target).hasClass(CE.Selectable.myThis.selectedClass)||
c(a.target).hasClass("motopress-clmn-select-handle")||c(a.target).hasClass("motopress-row-select-handle")||c(a.target).closest("."+CE.Dialog.myThis.dialogClass).length||CE.InlineEditor.isTinymce(a)||CE.Selectable.myThis.unselect()})},select:function(a){if(!1===CE.DragDrop.interruptInsert){this.unselect();var b=null;CE.Selectable.focusWithoutScroll(a.prev());a.hasClass("motopress-row-select-handle")?(a.closest(".motopress-row").addClass(this.selectedClass),b=a.closest(".motopress-row")):(a.hasClass("motopress-clmn-select-handle")?
a.closest(".motopress-clmn").addClass(this.selectedClass):a.addClass(this.selectedClass).closest(".motopress-helper").nextAll('.ui-resizable-handle:not(".motopress-hide")').show(),b=a.closest(".motopress-clmn"));CE.Utils.addSceneAction("select");a.hasClass("motopress-row-select-handle")||a.hasClass("motopress-clmn-select-handle")||parent.CE.Navbar.myThis.showObjectControlBtns();(b.hasClass("ce_controls")||b.hasClass("ce_inline_editor")||b.hasClass("ce_code_editor")||b.hasClass("motopress-row"))&&
!CE.Dialog.myThis.element.dialog("isOpen")&&CE.Dialog.myThis.open(a)}CE.DragDrop.interruptInsert=!1},unselect:function(){var a=c(".motopress-content-wrapper ."+this.selectedClass);a.length&&(a.each(function(){c(this).removeClass(CE.Selectable.myThis.selectedClass);c(this).hasClass("motopress-clmn")||c(this).hasClass("motopress-row")||c(this).closest(".motopress-helper").nextAll('.ui-resizable-handle:not(".motopress-hide")').hide()}),parent.CE.Navbar.myThis.hideObjectControlBtns(),CE.Dialog.myThis.element.dialog("isOpen")&&
CE.Dialog.myThis.element.dialog("close"),CE.InlineEditor.curElement&&CE.InlineEditor.curElement.control().close(),CE.Selectable.blurWithoutScroll(a.prev()),CE.Utils.removeSceneAction("select"))}})}(jQuery),function(c){c.hasOwnProperty("stellar")&&c.stellar("refresh");c.hasOwnProperty("fn")&&c.fn.hasOwnProperty("button")&&c.fn.button.hasOwnProperty("noConflict")&&(c.fn.btn=c.fn.button.noConflict());new CE.Utils;CE.WPMore.getInstance();new CE.StyleEditor;new CE.LeftBar;new CE.ImageLibrary;new CE.WPGallery;
new CE.WPMedia;new CE.WPAudio;new CE.WPVideo;new CE.Dialog;new CE.Selectable;new CE.Link;parent.MP.Editor.myThis.load()}(jQuery)}catch(L){parent.MP.Error.log(L,!0)}});
